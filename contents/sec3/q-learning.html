

<!DOCTYPE html>


<html lang="ja" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. Q学習の基礎 &#8212; 機械学習発展 (実践)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/sec3/q-learning';</script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="3. オセロAIの作成" href="othello-agent.html" />
    <link rel="prev" title="1. 強化学習の基礎" href="reinforcement-learning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">機械学習発展 (実践)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">第0部 各種基本ライブラリの使用法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/setup-python.html">1. Python環境の設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/numpy.html">2. NumPyの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/matplotlib.html">3. Matplotlibの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/pandas.html">4. Pandasの基本</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第1部 画像読み取り式数独ソルバの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/opencv.html">1. OpenCVの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/figure-detection.html">2. 図形の検出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/scikit-learn.html">3. scikit-learnによる機械分類の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/exercise-sudoku.html">4. 演習1 - 画像入力式数独ソルバーを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第2部 ひらがなOCRソフトと百人一首エージェントの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec2/data-visualization.html">1. データ可視化と次元圧縮</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/feature-extraction.html">2. 特徴量抽出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/deep-learning.html">3. 深層学習による物体認識</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/exercise-ogura.html">4. 演習2 - 百人一首エージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第3部 強化学習の基礎とリバーシエージェントの実装</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reinforcement-learning.html">1. 強化学習の基礎</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Q学習の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="othello-agent.html">3. オセロAIの作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">4. 深層強化学習</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-othello.html">5. 演習3 - オセロエージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/notation.html">資料中の表記について</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/tatsy/1284-sds-ml-advanced/blob/master/./contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced/issues/new?title=Issue%20on%20page%20%2Fcontents/sec3/q-learning.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Q学習の基礎</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="q">
<span id="sec-q-learning"></span><h1><span class="section-number">2. </span>Q学習の基礎<a class="headerlink" href="#q" title="Permalink to this heading">#</a></h1>
<p>ここまでで扱った多腕バンディット問題は、取れる行動の種類が少なく、また、問題の状態が変化しない、すなわち、いつスロットを回しても、各アームの当たり確率は変化しない、という特徴があった。しかし、実際の問題は取れるべき行動の種類が多く(場合によっては連続変数)、また、ある時刻で取った行動により、行動を行う対象の状態が変化するのが一般的である。</p>
<p>このような状況において用いられる強化学習の手法に<strong>Q学習</strong>がある。Q学習のQとは<strong>行動価値関数</strong>を表すQ値のQであり、とある<strong>状態</strong><span class="math notranslate nohighlight">\(s\)</span> (stateのs)において取った<strong>行動</strong><span class="math notranslate nohighlight">\(a\)</span> (actionのa)の価値を関数として、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>のように表す。</p>
<p>このようなQ値を学習する方法はQ学習以外にも<strong>SARSA</strong>(state-action-reward-state-action)と呼ばれる方法もあるが、本節ではQ学習に絞って説明する。</p>
<hr class="docutils" />
<p><strong>Google Colab用の準備</strong></p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code in Google Colab.&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code on the local computer.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="c1"># Gymnasiumのインストール</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>myst-nb
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;gymnasium[classic-control]&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>下準備のコード</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">ArtistAnimation</span>

<span class="c1"># 乱数のシードを固定</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>


<span class="c1"># グラフの設定</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id1">
<h2><span class="section-number">2.1. </span>背景<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Q学習で扱う対象は<strong>Markov決定過程</strong>と呼ばれる状態遷移のモデルである。</p>
<p>Markov決定過程をかみ砕いて言えば、その時々で取った行動により次の状態が変化するが、それより過去に取った行動がその状態の変化に影響を与えることはない、という性質 (この性質を<strong>Markov性</strong>と呼ぶ)を満たす状態遷移のモデルである。</p>
<p>Markov性を満たす状態遷移であれば、とある状態<span class="math notranslate nohighlight">\(s\)</span>において、行動を<span class="math notranslate nohighlight">\(a\)</span>取ったときに、別の状態<span class="math notranslate nohighlight">\(s'\)</span>に移る確率は<span class="math notranslate nohighlight">\(s, a\)</span>だけに関する事後確率として<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>のように書ける。</p>
<p>Q学習では、この事後分布<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>を用いて、行動評価関数<span class="math notranslate nohighlight">\(Q(s, a)\)</span>が以下のBellmanの最適性公式を満たすと仮定する。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-eq-bellman-equation" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \sum_{a' \in \mathcal{A}} P(s' | s, a) Q(s', a')
\]</div>
<p>この式において<span class="math notranslate nohighlight">\(\gamma\)</span>は<strong>割引因子</strong> (discount factor)と呼ばれる値で、<span class="math notranslate nohighlight">\(0 &lt; \gamma &lt; 1\)</span>であり、<span class="math notranslate nohighlight">\(R(s, a)\)</span>は状態<span class="math notranslate nohighlight">\(s\)</span>において行動<span class="math notranslate nohighlight">\(a\)</span>を取ったときに即座に得られる報酬を表す。</p>
<p><a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、<strong>最適な行動価値関数が、その時、即座に得られる報酬<span class="math notranslate nohighlight">\(R(s, a)\)</span>と未来の行動から得られる報酬に一定の減衰を加えたものの和として表せる</strong>ことを示している。</p>
<p>一方、多くの状態遷移のモデルでは、状態遷移は確率的なものではなく、行動<span class="math notranslate nohighlight">\(a\)</span>の結果として<strong>一意に次の状態が決まる</strong>ことが多い。そこで<span class="math notranslate nohighlight">\(P(s' | s, a) = 1\)</span>と仮定する。さらに、仮に理想的なQ関数が求まっているのであれば、<span class="math notranslate nohighlight">\(s'\)</span>において行動価値が最大になる行動<span class="math notranslate nohighlight">\(a'\)</span>をQ関数から決定できるので、<span class="math notranslate nohighlight">\(a'\)</span>は行動価値が最大になるものであると仮定する。</p>
<p>これら2つの仮定により、<a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、以下の形で書き直せる。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation-2">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-eq-bellman-equation-2" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \max_{a' \in \mathcal{A}} Q(s', a')
\]</div>
<p>Q学習は、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たすような<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を強化学習の枠組みによって求めるものである。</p>
</section>
<section id="id2">
<h2><span class="section-number">2.2. </span>アルゴリズム<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>Q学習は、実際の環境において、適当な行動を取ったときに得られる報酬と状態遷移から、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の両辺の差が小さくなるように<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値を更新する。</p>
<p>典型的なQ学習の実装では、<span class="math notranslate nohighlight">\(s\)</span>と<span class="math notranslate nohighlight">\(a\)</span>を離散化して、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を二次元配列として扱う。このような離散化されたQ関数を<strong>Qテーブル</strong>と呼ぶ。</p>
<p>Qテーブルの更新は現在の<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値 (学習途中は必ずしも<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たしていないことに注意)を<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の右辺に近づくように更新する。</p>
<p>具体的には、学習率<span class="math notranslate nohighlight">\(0 &lt; \alpha &lt; 1\)</span>を用いて、以下の式で<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を更新する。</p>
<div class="math notranslate nohighlight">
\[
Q_{\rm new}(s, a) = (1 - \alpha) Q(s, a) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') \right]
\]</div>
<p>また、この式は以下の形で書き直すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-q-update">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-eq-q-update" title="この数式へのパーマリンク">#</a></span>\[
Q_{\rm new}(s, a) = Q(s,a ) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a) \right]
\]</div>
<p><a class="reference internal" href="#equation-eq-q-update">(2.11)</a>の右辺の</p>
<div class="math notranslate nohighlight">
\[
R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a)
\]</div>
<p>は、<strong>TD誤差</strong> (temporal difference error)と呼ばれ、Q学習はこのTD誤差を最小化する問題であると言い換えることができる。</p>
</section>
<section id="id3">
<h2><span class="section-number">2.3. </span>倒立振子のバランシング<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>Q学習を実際に試すために、比較的単純な倒立振子のバランスを取るゲームについて考える。倒立振子のシミュレータは<a class="reference external" href="https://gymnasium.farama.org/">Gymnasium</a>というライブラリ(旧名: OpenAI Gym)から簡単に使用することができる。</p>
<p>モジュール<code class="docutils literal notranslate"><span class="pre">gymnasium</span></code>をインポート後 (<code class="docutils literal notranslate"><span class="pre">gym</span></code>とエイリアスをつける)、<code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数を用いてゲーム環境<code class="docutils literal notranslate"><span class="pre">env</span></code>を作成してみる。</p>
<p><code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数に倒立振子のゲーム環境である<code class="docutils literal notranslate"><span class="pre">CartPole-v1</span></code>を指定し、<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>パラメータに<code class="docutils literal notranslate"><span class="pre">rbg_array</span></code>を指定する。</p>
<p>このように<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>を指定しておくと、<code class="docutils literal notranslate"><span class="pre">env.render</span></code>関数によって画面の情報をNumPyの配列として得ることができるので、Matplotlibを用いて、初期状態を描画してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>

<span class="c1"># ゲーム環境の作成</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span><span class="p">)</span>

<span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">31415</span><span class="p">)</span>

<span class="c1"># 現在の状態をRGB画像として取得する</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" src="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" />
</div>
</div>
<p>このように、CartPoleは台車 (cart)の上に倒立振子 (pole)が取り付けられたものを制御して、できる限り長い時間、振子が倒れないようにバランスを取るゲームである。</p>
<p>倒立振子は、その状態を表すいくつかのパラメータを持っており、それが<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の戻り値として取得される<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>の中に格納されている。</p>
<p><code class="docutils literal notranslate"><span class="pre">obsrv</span></code>は<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数になっていて、CartPole環境の場合には<strong>第1要素に状態を表す変数が入っている</strong>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 現在の状態変数を確認</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obsrv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.1067048e-05 -3.8479745e-02  3.6217723e-02  3.3740070e-02]
</pre></div>
</div>
</div>
</div>
<p>CartPole環境の場合は、4つの浮動小数が格納されており、先頭から、</p>
<ul class="simple">
<li><p>台車の水平位置</p></li>
<li><p>台車の速度</p></li>
<li><p>振子の角度</p></li>
<li><p>振子の角速度
をそれぞれ表している。</p></li>
</ul>
<p>また、それぞれの値が取る範囲は以下のようになっている <a class="reference external" href="https://gymnasium.farama.org/environments/classic_control/cart_pole/">[参考URL]</a>。</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Num</p></th>
<th class="head"><p>Observation</p></th>
<th class="head"><p>Min</p></th>
<th class="head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>台車の位置</p></td>
<td><p>-4.8</p></td>
<td><p>+4.8</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>台車の速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>振子の角度</p></td>
<td><p>-24°</p></td>
<td><p>+24°</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>振子の角速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
</tbody>
</table>
<p>この値は、<code class="docutils literal notranslate"><span class="pre">env</span></code>の<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>フィールドで確認することができる。</p>
<p>CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>は<code class="docutils literal notranslate"><span class="pre">Box</span></code>という型で表されていて、<code class="docutils literal notranslate"><span class="pre">low</span></code>、<code class="docutils literal notranslate"><span class="pre">high</span></code>というフィールドにパラメータの最小値、最大値が格納されている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lower bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Upper bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lower bound: [-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38]
Upper bound: [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38]
</pre></div>
</div>
</div>
</div>
<p>Gyminasiumのゲーム環境には、この他にも多数の関数が用意されており、それを強化学習に用いることができる。</p>
<p>まずは、その挙動を理解するために、ランダムに行動を選んだ場合にどのような動きになるのかを確認してみよう。</p>
<p>ランダムな行動選択には、<code class="docutils literal notranslate"><span class="pre">env.action_space.sample()</span></code>を使うことができる。CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">env.action_space.n</span></code>に格納されているとおり、取り得る行動は <strong>0: 左に移動</strong>, <strong>1: 右に移動</strong> の2つだけなので、<code class="docutils literal notranslate"><span class="pre">sample</span></code>関数はこのうちの一方をランダムに返してくる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに5回行動選択をしてみる</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
0
1
0
1
1
0
0
0
1
</pre></div>
</div>
</div>
</div>
<p>選んだ行動をとって状態を更新するには<code class="docutils literal notranslate"><span class="pre">env.step</span></code>関数を用いる。<code class="docutils literal notranslate"><span class="pre">step</span></code>関数の引数に行動を表す整数を与えることで状態が更新される。</p>
<p><code class="docutils literal notranslate"><span class="pre">step</span></code>関数もまた<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数と同様に<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数を返してくる。ここには<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の時よりも多くの情報が含まれていて、</p>
<ul class="simple">
<li><p><strong>第1要素:</strong> 現在の状態を表すパラメータ (上記の<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>と同様)</p></li>
<li><p><strong>第2要素:</strong> 行動により直接得られた報酬</p></li>
<li><p><strong>第3要素:</strong> エピソードが終了したかどうか (ゲームオーバーになったかどうか)</p></li>
<li><p><strong>第4要素:</strong> 行動を表すパラメータが範囲外に外れたかどうか (今回は使用しない)</p></li>
<li><p><strong>第5要素:</strong> その他の追加情報 (今回は使用しない)</p></li>
</ul>
<p>のような構成となっている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observation:&quot;</span><span class="p">,</span> <span class="n">obsrv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reward:&quot;</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished?:&quot;</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observation: [-0.00080066 -0.23410185  0.03689252  0.3376265 ]
Reward: 1.0
Finished?: False
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3><span class="section-number">2.3.1. </span>ランダムな行動選択<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>これらを用いてランダムに行動選択をし、その時々の状態を画像として格納する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># ゲームループ</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># 現在の画面を画像として保存</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># ランダムに行動選択</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

    <span class="c1"># 状態を更新する</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># もしゲームが終了していたらループを抜ける</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAAFydtZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAE
42WIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+IBqbDMURRxTh117TfJEEZSI2XHtOkmPYFo92VdmqOjm90FN/XJMkR2Z4P5ZRakMwEg+
frA5a2TY9d80ld4hmBKdiKPxw/CnMCYxhhSN5CGrAMSHOCc7+BjnzVADOZIquaMC9I5EJ9DFTepU
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
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<p>このようにランダムに行動した場合には、途中で棒の傾きが一定以上になってしまい、エピソードが終了していることが分かる。以下では、Q学習によって行動評価関数を最適化し、より長い時間、倒立状態を保てるようにしてみよう。</p>
</section>
<section id="id5">
<h3><span class="section-number">2.3.2. </span>Q学習による行動選択<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>まずはQテーブルを作成するために、4種類のパラメータを離散化しておこう。以下の例では、<strong>速度と各速度の範囲を適当に狭めておき、その上で各パラメータの取り得る範囲を8分割する</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_INPUTS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">N_ACTIONS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
<span class="n">N_DIGITS</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">lower</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span>  <span class="c1"># 速度の範囲を修正</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># 角速度の範囲を修正</span>
</pre></div>
</div>
</div>
</div>
<p>今回の倒立振子の例ではパラメータ4つを8分割しているので、取り得る離散状態の組み合わせは<span class="math notranslate nohighlight">\(8^4 = 4096\)</span>通りである。取り得る行動は左に行くか、右に行くかの2種類であるので、結局、Qテーブルのサイズは<span class="math notranslate nohighlight">\(4096 \times 2\)</span>となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q値テーブルの初期化 (乱数による初期化)</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>8分割されたパラメータの範囲を求めるには<code class="docutils literal notranslate"><span class="pre">np.linspace</span></code>関数が使える。この関数はこれまで第1, 第2引数にスカラー値を入力して使ってきたが、サイズが同じであれば配列を指定することもできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">N_DIGITS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-4.8        -3.4285717  -2.057143   -0.68571424  0.68571424  2.0571427
   3.4285717   4.8       ]
 [-5.         -3.5714285  -2.142857   -0.71428585  0.71428585  2.1428576
   3.5714283   5.        ]
 [-0.41887903 -0.2991993  -0.17951958 -0.05983984  0.05983987  0.1795196
   0.29919934  0.41887903]
 [-1.5707964  -1.1219974  -0.67319846 -0.22439945  0.22439945  0.67319834
   1.1219975   1.5707964 ]]
</pre></div>
</div>
</div>
</div>
<p>今、とある状態変数が与えられた時に、それが4096個の離散状態のどれに対応するのかを定めておく必要がある。</p>
<p>これには、4つあるパラメータのそれぞれが8個の範囲のどれに入るのかを求めて、その値を元に状態を表わす整数を計算する必要がある。</p>
<p>各パラメータが8つの範囲のどれに属するかを求めるには<code class="docutils literal notranslate"><span class="pre">np.digitize</span></code>関数が使える。4つのパラメータのそれぞれについて、リスト内包表記によって所属する範囲のインデックスを求めるとすれば、以下のようなコードになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 4, 4, 4]
</pre></div>
</div>
</div>
</div>
<p>現在は各パラメータの範囲を8つに分割しているので、<code class="docutils literal notranslate"><span class="pre">digits</span></code>には0-7の整数が与えられる。従って、この数字を8進数であると考えて、10進数表記に直せば、各離散状態に対して重複のない整数のインデックスを付与することができる。</p>
<p>このような計算は、単純には以下のようなfor文を用いたコードで実現できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">n</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>もう少しPythonらしい書き方にするのであれば、<code class="docutils literal notranslate"><span class="pre">functools.reduce</span></code>関数を用いて以下のように書くこともできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>これを踏まえて、状態を表わすインデックスを計算するコードを関数化しておく。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="varepsilon-greedyq">
<h3><span class="section-number">2.3.3. </span><span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新<a class="headerlink" href="#varepsilon-greedyq" title="Permalink to this heading">#</a></h3>
<p>ここまでで下準備が整ったので、前回<a class="reference internal" href="reinforcement-learning.html#sec-reinforcement-learning"><span class="std std-ref">強化学習の基礎</span></a>の節で紹介した<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いてQ学習を実行してみる。</p>
<p>Q学習においては、とある状態<span class="math notranslate nohighlight">\(s\)</span>において<strong>何らかの方策</strong>によって行動<span class="math notranslate nohighlight">\(a\)</span>を決定し、行動後の状態<span class="math notranslate nohighlight">\(s'\)</span>を得る。その後、<span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(s'\)</span>の組に基づき、<a class="reference internal" href="#equation-eq-q-update">(2.11)</a>に従ってQテーブルを更新する。</p>
<p>この際、行動<span class="math notranslate nohighlight">\(a\)</span>を決定する際に用いる方策に、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の他、前節で紹介した手法が使える。</p>
<p>Q学習で<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いる場合、多腕バンディット問題の時と同様、適当な<span class="math notranslate nohighlight">\(0 &lt; \varepsilon &lt; 1\)</span>を決めておき、<span class="math notranslate nohighlight">\(\varepsilon\)</span>の確率でランダムな行動を、<span class="math notranslate nohighlight">\(1-\varepsilon\)</span>の確率でQテーブルに基づいた最適な行動を取れば良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに行動する</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 一番価値が高く見積もられている行動をとる</span>
<span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>今回は、以下のハイパーパラメータを用いてQ学習を行う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q学習のハイパーパラメータ</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="n">n_episodes</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
</div>
</div>
<p>また、多腕バンディット問題の時と同様に<span class="math notranslate nohighlight">\(\varepsilon\)</span>の値はエピソードが進むごとに徐々に小さい値になるようにスケジューリングしておく。</p>
<p>以下が、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQ学習のコードの一例である。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">e1</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">e_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_episodes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">e0</span>

<span class="c1"># Q値テーブルの初期化</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>

<span class="k">for</span> <span class="n">epi</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_episodes</span><span class="p">)):</span>
    <span class="c1"># ゲーム環境のリセット</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># エピソード開始</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># 現在の状態に対応する行番号を計算</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># ε-greedy法による行動選択</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

        <span class="c1"># 状態の更新</span>
        <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="c1"># 新たな状態に対する行番号を計算</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># Qテーブルの更新</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>
        <span class="n">best_q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">q0</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">reward</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">best_q1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># epsilonの更新</span>
    <span class="n">epsilon</span> <span class="o">*=</span> <span class="n">e_scale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "b93ff184036943818bf403a616fa9357"}</script></div>
</div>
<p>学習が終了したら、実行フェーズにおいては、常にQテーブルに基づいて最適な行動を取ることとする。</p>
<p>状態の画像を保存しつつ、学習結果に基づいて行動をするコードは以下の通りである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># 最もQ値の高い行動を選択</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAATqFtZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAF
T2WIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+ID9XvlWyqSgZCWiIjzIIyfgWgRUAUQKEL++XDpwzYLO23ANSIuSS40yX94eU3b3HoCQ
fKZIxfzFCTWtRVNIzCYKdiE3gsQUICbD6KyaM2Xg0DR5gW0pZhFlrrD/rU7UfftTuwG4lbdXEV03
JudLNEHtbrlK0TuAvK9Wt4oM7F6ikolQXQ/gDmhKPJ9ro/ItXXD3umaPK7KV6yke9JchRAFe5vMG
XVIHDmZSjmIlsFyX+k8cfjNbwm7FU6aBXX96eA88iYtBKurbuWAMc2ZMxcRXVh9KlU17YfocYKNx
ohZ8gSRET4t/99BlVT7H9MsgHuTuxBEByS9Segdx+yyiRrGgWisyuYm5/a9EIg2s1BzTpic2y+bv
kaKnzuVGl1VDZYGzVjNEGVpBRzbv+nEVlTQ8k8p3/CaZCDLlMNnmHMEH3+DUT4RxjSkcIA2W4U/C
ueEKmA0D4V8HX6YAAU2yrO47QjkmuAtJKd/GSY5mCE9wecXOOSTl7GsFaCTbxA79b+yufzuJ944J
N+6vuway4UW3IlQTO4ItdiJNWzd6SSDz8qdHChka4LUihG8X7Cg7Ry2UbDaWP6kw7w71P5NNEeNG
i54/eDC5/YQqE6IioJ0cTjwbKvLwe/n1WjrdyQBJB5dYXsUZzWoocMfyOme0qMiK6EZfvn5RgLmn
NZEPskp+1IhWW5/eOlSxRfEytkPqrW9o/3eFQwVJcsb/7sdklmyouZiOnUonWV80tyBM5tw1LQFE
To3yYJLLc9etptkPz72brn1BDwyLWVLkITta44uvqiSz01zDpmptvHkbZ8se6X5uJzU0a4ZkBJ6I
asuOWOB1pYhKA8CAwSpF0lV20yYCs/iBklRQ3wpVqjNhTdhmSNn/+wZj5vlr1ZGE/cFFfB3oshqf
+fFgAADWASMTwYwdQnRaXLiXBuYqUpXp2/z+bn/i2jF3Qj2XNQ+BMNU9ut48NLxRRKX/EmXzW8w/
SOO/Ji2io7gG6ZBjll1n1NsmAUAAPpOrBtIVJlsSnvRmIPPj6dtw2/bvz6Fm/DLsZ/LOd77wh7OH
U2AASToszzT0puyq7s8zOw0ywcK3DJ5Yl3dcPG+//qbJKTjiphf2BDmgnICQxsnvwakmEzsSFjOI
Z4jHvxCNaCg0NpX1WuEubQCIkcF4ya8yxjH/nxuItWtXgwTzqA377tSU26iuuVIATxW6jnN1C5TE
DQxVL9RTlSMt3KBifi7SwQCv/h2QuDVlk/nh2Aid38jw8gpLVJ6DsNbvgavRskSUyQoxlfJc2Xc6
QtZSyU8UwV+va+mfQckEoUAUE8VhEegH35Ey71sVUcipcDm2YeWIbakg9wup+7zoxWvyuE15+xzd
dign2swLKl1L/U5qiqg87o0BU8Mz0lFZuFCeQP8KUvJAKaNjUAhNDTDnf60SCAVp46R6YLgcgelt
301lFC/95ngGGBzsZEzcd3AJcI+iq2nJR99gGITChRa9BcVZAvBBrmBzp0jw8jrhCoaeVlJXMh3G
OSwm47TrweBRrz7/Mcd4LVW6LOjXSx2vWGXaBq402sXLn5exYl75THCWF0KcRxpA5n9fUtrFHro+
o4AAAAMAAAdlY2kuAlp3+rHGaDFrsLd2YWjPk/NAQ5dusjgIaNW6Cnzhdo0K3lRe7s3Nepje6Con
FIskRprR9Oy2FWT9Q6NN9laniZ11cawRL18bbCvPuPHTaretM2PyAAADAAADAAANmQAAAYNBmiRs
QR/+tSqAAJD17Ax6gAwj5Qvz1wDZCivTBnwdi0W0H2GS436KZsnoSus7cUQtMXuoKRqU8jxOfqgS
K5KpEODTPWIIhBmds2p2OtMNpF6JBMjo5OYjjUvKbqqVaocZhLFtJtuWYsDkhmtGM9MbI1V6zLKS
f2QQY4aRiya/DtPiMrgaE3DtTK8SjWvcsJ0qGtJ6LcC1PwJsUHA/bnEvEpUa6BsmKm/OsQMbnQei
XdrgEjVSyBEftCwkYpwjNW9FtrA8PPOWYdeltTxnsKwu0XskV83BKm9iUc2EAyRIbfrXnHFMLfy3
Ga8DsMAJfqwqUepIwz1oJSqXscqb+oKdqAGvzMd3FhsB/KYUKOz0K+1zEX3v0zSwW43fCn3BYY4v
j27alTp9EQFleM+chzH0x4aezZ61blhhOGs+YdOXQGgkOYzN5cq6lyYAKrdmgy+Dk1t/EfNiY05s
kA7FIdu56gVX4DuoggSvz254y+GPYjXRNmIE3fx8nFL8VReg7HELfAQAAAB9QZ5CeId/AAIvMEXT
K6IAWuX2EE/8W7WwZ8ePFzEXZPsNmbvWxDIIXTML+wpjwxKiYHMJRKrPceT7p5zZRx5vpb6PxAFU
QA660U1CsLf/j7XJl1P+4wHwIv+3YjNqT89kvZKDwhlyKOqi5s6RZSb3tbg+5O22hAVk386EccEA
AABYAZ5hdEN/AAMi5bz4ACcj6fWcjdF+NZJ7860nMB2NgJmigSDuC6JzHw5/NnkwRFqRdcbhD/pu
GbNIPgYiyHBKnk1FB6IY4P9QC7jqtFBMYfRXhrxr86CqgAAAAKMBnmNqQ38AAyNG00j4ACG9kpax
mb8n0ii5m0MgkiEn2c4OnEFlAVk+xhf2/hDi6O32ZfKVRKXiuG9QJzdjhu4G1iRF/jqhJyiczKwQ
NoA0VEjSUhTXas/+fgDdLQ5Bcnd14BNVnkdRxsKUoM0Mur2peypiSPKeZ7KWjin3LXqFK5MXgqLG
qDg2R67WqYy9jMuCSprg3LzyB2soobaoygPcAH+BAAABoEGaaEmoQWiZTAgj//61KoAAkGA+hAAI
ixV6vBgJJSQ1jiy3S2f7d1ZVo0f1mRK0OxDa3OS2t6emxFXHMlplI0/096f7JuW2BIl9g/3Z5N33
X8rogYRsf2tv3oKo1SqmiPm+MamQPkmRqDco9qGcIx2z5JGTBpm1saRG4BLoe7UAt2PAvYulhhqi
ZnNzUWBl8M8DUndGJ7H+LehP2+TB97JRorfVKFdmq//giLTEEI/TtwbSoiIPlXJey1B1TPUkrrNZ
vsHXD49E44T7VVsnACIszSKUInGRDpY+x8Z5tBTw1q/XVQzdF2yxy9qkcVxSFqD/pu0dQKWWOVaJ
2K4VnfZpRQUVChpft2Fnc4CK4R+MufVUTpyJD8tkeJAE+4HgJrA1E/RY24Gad6xOa5e5RwHtqyVn
A21AzFQ5TPIskPgWtPhe70B6HnyYb64aybN/+n+pqdnaARWY1fkq0DrqYS9/ahsVpEsKKGt2JhWa
bDQp2yciutuI+4LAKFtcR9wAgp2yzyqEyQKKH44oaVwFTW+Av8oj3VfZ9+jfmXtZfXXFAAAAmUGe
hkURLDv/AAIwbMczLQAQ4jKLpdYwiX5O9xkCrepbDzqS6v2h/Co0jd8NsuvIpx68SH7k0LGvrcF3
bFnMnxOI0U7fxKHkKJzGYSo1CJ5wwK2L2BnogmzvV1ylw1rcggyEDNG0A843BrX/IYawaHGQSsCl
XrIEWdQlk/4Fs5LB5q/LxJqSYMUWYmdAdcHjL0PImuU6OdIxYQAAAIwBnqV0Q38AAxs4oT8AGyaz
xUi/cPDJKO74M1o1jBf5bM7o2iI4g3/DSrJg47VRy+StFBkBgdeK0Vp9DR8qvZU7hHTIrKJNx5bU
nevDmUkhInzFpqbhgjRAEPiZM+Y6mtwQE5dI/pQuuzy17l+SJ5CGiI8m8vGAt6KV8Xkeeeqevi/6
MCpUudn/VQiCtwAAAJIBnqdqQ38AAyOXXucAIPhdjQhQQuIwbQbrr6HbfeFVkcMqQeIbLeIXB7tt
NrZBsNNr/Uq4+Cy94GrkjB1i+ckUNYbJD8kPYqCiRZmdVxzagZ7Vdp+seATWW5FNLGpH2CVxhNGU
ralZpkxtMUp/pCh6/F9z0ewz6JsH3Gq01tfn4JNr6RcU2zxA9LyNSiiOLa8D/AAAAWhBmqxJqEFs
mUwII//+tSqAAJAYtsn611gCG20FnK+7M2Z23aJ+4eEV9XEqJamHiOEtBSy1yPDQ1jF0GNT4lzG5
WalkUW9uf2mT/a9N4W354Wt0VSMDDQqpohFg5eiEsapqEBLFvPA/TYVhJqlg3DFmDaYyq9i8BuPB
OfVg1jPTVhiU9oRRpuo11+8UkBqgYJfLYJHKkxpvVedl6U3O9vUM7RGy4NxpvA/CuLdiIklKz6o/
UOD1nhe9II4THxbMYASKh+/mBAY7Gu4iBWCS9tzBktx5tyo3n5RkUBhh+aqsMd5QKDNx150KF37y
LCPS1tLjjX7uYsVAmBLuymr2dCHznMErQ8443Bup0hSgtM/8p9Dc1QnxE2lONpH70puY3E6FyYka
PJ19kAODBHeWbXfxzt5VYGnFS7GsHz945w5UrwkD+mlM6c/PZqZ7gL+2ScSLtFHdQU2Hnszth5ao
b+/2TiGK0TsXX4AAAACVQZ7KRRUsO/8AAjDjoM//kcJwAC1vDJuKEOa3T1VihvFYVhXZIJ8xUwQz
X5iYEvR3sn4x8xh93l5LEOykJoh+Sut+TvMG3Ds2bRdUjHtK5N3wfU420pRDphMLk8YyHmjDq8dv
uQSBg6u9ScjIz/+zH/7hhxGgEhP/vnrM/IPXKNj+1WlK92sok+fWTgCXOO748udagP8AAABtAZ7p
dEN/AAMj1BpGgWh2JAB8O3dTpv1ZFlXh+976w9lY+z/BC3WP8bv8N0+qBhTqvLg4GPlbxesqHmGA
Rj1dXbE5PXTU9Bv/Qa5Q8ZJVx/FlJ8X4PgYE3Nek0/frKdxyJIpdlABTiCWS0SkTsAAAAGABnutq
Q38AAwnDf9IPIAS3AmbYB7LsUh0LmaEPWJiPPJP/RFGSGSecHJHBeaR3tJ42FZCMhovDXePTZYUv
B7IHKCfgDMitofnWRCRXC1IRPA8sTQLcwyc65ln7TTRQFtAAAAD2QZrwSahBbJlMCCP//rUqgACM
ZKVSWwAcI+iASJnHupkPoxmSR0oZGPPzt3xz9b1BCVUnES4NFGLVjuW1pxL/qbgmP8epAWzqXgpa
ypORc4mDnQN+8FC7yE90OusB9BqwOjaq01/UeXkLzWair8gqaY8/FU5TN7kvHFOvGttNX8X2aJfy
7eWfA3iavHFlcptmBsUy5NQN3/7GJZPlMtosiv25UvN4ywiWztZiYXqREHvMveAiW7gEf3F0yrtz
HbRv9uGIJXvY/txJsVYXQy/bRvNFwcq0OE6Xkl3t2sTbyNj2F778UqL/rVSvh3aIoL9VvXryrEaB
AAAAbEGfDkUVLDv/AAIbfn/CvprOkAJcsSVwFs2kWLnCWYzGDB0YLC7tHiId6uzF3KbNydVDrlwo
RUdWadec0fmDR52je+eNsmgbOQjz6OPAW32oLkYgBxH8EhlJoQKOj3487ZkSqoRFYPVGNZRdwQAA
AIUBny10Q38AAwh1/Xobd2AATkd/jyBqADneur0Cnbd+rZX4F6tstDLDZzRj+homOsJvx0HWoc/K
eXWzwEVmq6wP4zYjVLPVyppcf25tMXq+nFRR0QLlRtuvI3BGbZ7cNWK0TyMwykjO2EWaXHDm40qQ
7iNRB+Uo8EiI4Zjn3rZJe7jfiA/xAAAAXgGfL2pDfwADDzlYaR5ACWzzuht/u0uVHTunJXqcoJhq
SmMsHbTSudMhqA+m8ZpZ2ZifIhLY4ZTspTD9JfviKDgh12Ikds3RDIq+1QHoxss1uR9kzgXMfw1j
HtEsou4AAAFuQZs0SahBbJlMCCP//rUqgACQoSHcVgCurFrXv0cH2XR/NUlmOQr/+HpgLZrUhZCm
enULs8jqxdGwu2fmS4zNOnwnJ3fE1pQ6OOI5tCElozbOKfv5bReHGTzu1F2bVjhrAJx/O4pmbA/E
DEnBftAkDqiD6TPZTtKze6EfXgIFSKHnaxQWcTJDwXYFy/vBOuqXKbuhE2/+RxO1ol3ZafpY24pP
tAnFvrKRIqpio60FIy6gdQDB/QYcEBCJuHHnaVhASvTrTxHEQxVZHwmvKEBpNM9IxO6QUrm1/sGr
//7rvxK+Ahtt0TC9ysI8WF6CtloDcwJpn/C4I7BQK6glZS/lJ0d/Zr/Akxvh3K7olODaZOp2h459
/aMhjv0h6E768x10sMOS8p7jifyW18q5wxXESjdpNbExdG4ZLosDLIiiMom0jEj4DehmuT4vp62d
fPHSzt9Kivmqxg11XYpgPr1hIpG/PkxbDzcf+VZFSJ2AAAAAt0GfUkUVLDv/AAIxH68Q37dAB8U0
M/7zMWGujZiD/FeZKFXQNagG1bC/HRIavljNoG6lvFI/EXphFaUNH17Bke1J87Pw/UBBBX36/Fx9
oixo8JY3AMcAN7feB6fz3x2Vj9EzkYQx5Atl8jA1xapBC3caezKjhkk2bwfXCV+tfbM7xC6DZPuz
pJQ5Q/LtnH8EdlpxYE+ts0q8zIFBNlQIUuckkvNqZoc0SCkyDDCFXq62yGDvWTcB/wAAAHsBn3F0
Q38AAwxe5+yg5ACQfPoLmNsTrR24LPO2fx6BniCVamaFiPY64NsBFOgEnqAg+cnIYCbDkmhCx4O8
CoImzDQMkDb8q+ZVFjFiZwZmVUuXnj0G5QkQq/n8SVw2t/jrf1lQWhvAbDWdEn5SAsbp6ueIzwdS
p1O+g/wAAABqAZ9zakN/AAMivveo1hIATCbF7wit2nHB2GHzW0tjD8K1i6SjG46IeGzO5d+CEoCp
icFtnmZoO1WRhdUrK7LXG7GBsVmf4Piyz2iJ5FRWOCBfp2ZQhYPy72TQ4XmUkWSNlo8ygxFg2T6j
PgAAAXRBm3hJqEFsmUwII//+tSqAAIzzN9osomyqAA6FmQHsRf23syGAxc0DP0Nchdyk9v0mY3cE
vDIRdCDt9ODWwrw9GDtfr7XP/OQKW7btUzrm/bUrLCoB8/Jb8OJttSwfkrBP48TlsAFzHX+njyXJ
qQdOoU/VOSKS2zMokwP5Pel7HBi5n+nCWCOPiDU7rc51Z34Jgt30Rhyqnz8y/FUDbnn+R6XF/ldH
V3HiEQGxOU6gymDgrcjF6KzBnz5k7o4+AOyMvQQ86ig9ZSSb5iSQwjFgZmI+hg41qz6L0+idhu2t
lLZLpH4l9qt6RrYE4pK6RBGxeyYpyYkJmU/qbNMamjWNVQ56mxO2AFr5HjiCqI4JdRQpYA9zlKN6
2Q/2Aie0W0kh4cJNM4c8ncgYQKUCWPZBRo7/loCeV7w6OLgtUMNn7mX3hPqiENQ8KjW16UemBdvM
ItvQEtP8/d/kYGE+DYYtDq9A+vYr40dprcaZuNt81vPOuoEAAAB8QZ+WRRUsO/8AAiBjXaydKADu
LHb6YEZxjBHplJXPER9fVSkTTvUbbJSNVgXabSoeXyc8vDcHlPGAZVGWQQa3+MhoBPeH4sH+Gm27
lP79UEzMgdDOu7iHnYSVYYjxULFEugqVd0v3DxHeEumx90+8OdBuz5uC3riaXh8U0AAAAHEBn7V0
Q38AAwWN27MseufAAJP3eJuYG0ByMFy4LDdJp4hZgzOY0sTEIliKBsihcAr8ezhOAZNY7Y8PEfuJ
aAbLdxiXdDf/BRKyEPEoAnu96qYRJuO9NCk6LdTI3BXzddrL4myMM3uKu5IiQ5akQlUg/wAAAH8B
n7dqQ38AAwh1/Xobd2AATkd/jyBqADneur0Cnbd+rZX4F6tstDLDZzRkEmoJsULMAsJ5yj9LJyoj
SIq+DO5gdGzZf/PzhFbwmKDXe7xFaG7Az1YrJ4UZe2b19446cHvjChHnmzJF2/IZruqH4aeWc0Eb
cNdbljHBlvno/gl5AAABPkGbvEmoQWyZTAgj//61KoAAjMc3rL0ADoWZL0s0wC/JC9eGwrSDF6Qy
oSqb/SJfMAp7esiOTUgDnOaLx9t2mcEIbs26xCuE5Su7jxYptVClIK+CSHD8L1pSTM+HSZ8x3Ff3
fDzq8gvtLgKWDR9RZwe0ipJ/8XzEliGjWzhQG2MypHtqs2yy5JhcoFfrm2dfxXSjV729tppgtrC3
Ozzyi1lyVphRM8GyVjetpDbElbnrF61tBBqjObhd3ReScZS6/geB8iBWxEh6+PXkR8nQ0IQfWQ2+
JAEYeWZLADR73jfGrF+WH1lmUqEBNFHqzzyR+iCVTTk2beWdgH0ZkWtnqqq9M7aEEqLHjhAMyce7
41eGBej+jo4DrG3H08KPF8txuPLvHQcNGvkhRdKDWrPo4n3DzM3OO1Zat7CchRWfwAAAAIxBn9pF
FSw7/wACIG5Eo1mAEjrvM9e5t6UxmWCqdRX/+V37Xk3x8S2JY5UP25vszfAGpucBv8WAInaH4s6L
9vvWfnknOFuDXJJJCAGS06Y86O8RUcNGLbP4TzZTCI8EDqVt4aj+XX0Jro3FS9QAoT33emTjtxec
s1PXA20B7ijeFfxeXDvEg7RWztivgQAAAIIBn/l0Q38AAw+UNNd3+AD4otzRWvO64Ohzna47AGpI
XXhYqIH458pHqkYQNDxxY/Am2yqO5dO/6zpFYmkp713kPPcnsXwJLi8ysxULotoqHrrMxnKFHL/B
q4hhXudeCZ6JiszOb1nBFtFkXr3RPI9BeGAZ62m41KkHOwBs4Jp/X4tIAAAAfwGf+2pDfwADD5fs
V4ACT6pgCAtKPIG5CHCJFfWnJBMIZ+OgAAT8Gur84n3zbE4pVbbtMZzSwlWm9vB36iWf2KeDwsTp
hyuhvrESBnE1LRY6dZtr7ioVckTlz4r1ZhspBN3u4qaHvkig04C6cwh3wBgk6r57Bk71jW8KTJSC
HdEAAAGSQZvgSahBbJlMCCP//rUqgACQFh2qCsARaUacDXj2m3IGoWqyEAVvUsFk46PG0Od5b8Pe
lwsI6HgTTY85y+X88FJUISQDRhNyZgsinWSRlxj0N/kMMODETyKy2FFyzt2LTljpwf9i256BQMG6
aYtG+9C+b/xwlfch8lYIApfeb3uSRuV9HVue/Kq6M2MxLiZa4VzHZ0/wtTKSJ6XC6pELLMFVGozH
Hy+VTGbmgE2IZ/5uYj0mC+58eqI3kH7pFU+KqE5vGemS9VvLTvw7CMuUCb/2SmdAMdGhWrM4qTzw
3tcspVwgsCq+51P84CluWAkbVo8co8nnAS2c71BKm2xwIJ88F0+U8SYmz+SCPwAopVSUl8gvXsu2
oUAQMkFvFomJ6Os9fhvWKjNzDz4kic10kLw6JCnWz2mNCMECRBHezlJN0s7RFkBD8+cGA5lZsoVU
9Jnzj8KJJWhRBVweAhQC7dXTBSwm70GWAk/T0ODcwo/zcuMwHhqkZdnkc2jK5bDucS/mb8DLy9Gs
0KF57kzkxQYFAAAApUGeHkUVLDv/AAIw46DP/5HCcAAmik1xw62sOIbbvxMVgd5hB9lczgLDkcgq
yfjHwD9DSusYK0LVFdVSV1zCVD55rs2y1tLCmmFRCIkvku89rqnqE3yfS7DXeTUCPdvDt9ZhCqdF
Z/drYs/ydrqyBLQHOeLtWMT/X6qPgndxjEiHwZeokwLy54FWJukQPMfPICgDSgc7wevxeSU/S3iU
XaZPagFB3QAAAHEBnj10Q38AAyPTYS6PMSADw5UhdtvG3dFPiGhE3RBzPDTwz+7IAxy3mY/NAdYY
QHqWOkOgVnuO7Afr81t3OuVRlRCE4Im9EJyTS2bHiJRBE/6UEajx17bemAyttBRPvNycH0Jmwo2y
5AaV23P6fk/xTQAAAIABnj9qQ38AAwYAn5Ju1cAJFuMQfXq2Mq3taAXh1Oq4njTxW6cV+Tv9gQKE
AYbyrSj4tD+XOBViM/h/7eG00VXFjZI4irkiOzPCmMiq5YyzqnMH9KaXqnp+POqg3smT8/5kV+Gh
egnjZPKkTX1ZZ9WBbYzOTePapNtIA+lcXcB/gQAAASJBmiRJqEFsmUwII//+tSqAAIzzN+01j1eo
AOJWvSUc8fiYU5vXRO/3SLT/uytmbPhqllDvYt+wS6C3lFchVXIf2tCMBJxI45fwnlROoAWZtjuE
92BC/Ob2DvubKgP0TCctREG4FjhE/v+vBxkh3KYaFKDvwOmepF2JBv0PJS7QJ1aLSv1AJnXe+qM9
HjFlx4/xOuWLnwNJ9+a9vU1ZkE+jsfiv4XmZUxCEEpuYkmzPY09X8+LUzXYrGEjqormkGOMvrHaZ
a+8romJ5vyb5xSDShzWjsl20buljo6iroyPZ3Y3K4pCPTZP0UI05teaGvrXuS5AcBdhSg31+3Q73
tg3q10eP1n664a47FrqtjpotRgE9Q1569jVzTSChAg+mAyLUwAAAALxBnkJFFSw7/wACIHszoNUA
E0WJK4C2bSLFzhLMZjBz/kqCtNoQtm1LhFrw00/497WrhYAxKuHD5HdN+cMUT5ftyQNLNSyBsGqG
tjtQQtO+/44YIexg8x0QTlSOwwO1PeDCf3f7ba/08WJrzwSqfExIR9oW1/1AMflSDvCsbunh7U0J
IwjSsh/BqTmWCQly7/jBHZrWDA8qTRMWo06RCN8kjH4m9h8V+hNyOukc2AA/Nb4jLldR6xBU2MA/
wQAAAIcBnmF0Q38AAwh1/Xobd2AATkd/jyBqADneur0Cnbd+rZX4F6tstDLDZzRkD0skxCY6DgUO
flPLrZ4CKzVdYH8ZsRqlnq5U0uP7c2mL1fTioo6IFyo23XiOyYJJMwO3JS7Rh7MYrkg+//BeSvuf
Plp6581mXjNkbFTb1VBR/CUjX9QUzwy/B3QAAACLAZ5jakN/AAMQWA9yAEuPruht1ZC0MrDdyL63
bfRRohXN9sKKxpZ25JbFX4ctsBkgBO6ShxI5OZdHlqwzWS7yp5pruy8iH3gc/7JEddF131uLx5ay
HK/4OC2j1tjBpkzMsb7CvccJeQ97QBZjU49j6BP5083XXERoQkSk6Xah4UMBFzSMBChvlpMakQAA
Aa9BmmhJqEFsmUwII//+tSqAAJAW9EWPKkABadNLPlqkU7N+wzHG+L6GWKkHlGqwNIBb1XlHBHEn
fcVBsdfFbuDNgczbzzxZipLsjsSNGnuwTedAOxwovK6lwVV+5h/DowdBTChNCbEyx0l12ITv+954
/CLySGBG8Kur24smIrKAx3XMDqs02QwfX3zSMo3BHzVc6VMtNvsyhYPd2V9Nz95UBXaL0H/jB/0/
60H+QSGp1XR4xEmbWJoE7MOcDu0V2sME+rIChDjQwpceJdmS8itZ0T2OBSyPRMAfd2/5+ZY/J9yW
EbQ7I09nac2IwAU3qA7XmOby1mZHaqtt50jx0LGFaJs+kPlLHCSoWfq0IhWiYv+a/mmg6W8arwUX
/IR52QYUoQnXGaDYlTy7hfnwum6WFshd+CTANlnMoAJHSkfrLjZ4Ozn/lqjXJqWC+d+2fR7HrHLD
HCrtLNuj1NKm9lHuZGSl8uQaSQQu1J1czL0hvPwxlLXEzE+paaaZB9+GWVrfnJG2/S7o3I2wZ9bE
k08pkiS1M7JWKdvBucicjkd09P4HXx5T2+/d2m2jyUQASQAAAMJBnoZFFSw7/wACMR+vEN+3QAko
Q8dGCYAmeiFpF9srFlX35VqqnPks36rWI1/fDFIj5xLC231mEKFE28hMLPv/Q31x0iNr9AlvMh2Z
038q3mvli1FfTQ7HAus4h2fBnZWQWMAbUUyl7T7s6avVLgqwUBY5eMtD1yUA1gSIU9GZtQNt7ycP
9Zswq37SiTZ72MdJ+15TUNHG64mcaKMhkEruvrn8rvFgImx7Oy+5lMG/5DatYtMImAGhHCfW2QVj
PXqMCQAAAKYBnqV0Q38AAwYQu+kdWQAluIMrocWz3k6zPk/bHKUKPbRgZCijOhXyMWEpAWhpoWNS
wtM3dJ/thgwK9XMdw1Y78Z2hagcmUaNjJVEG8v4/g0j+kbWVkC5a5IGl/xDcRiz1D2imHDdgbKpv
x61NGneDM+Cq/4OGurGUX154ag8qBRzyma4Oqnx9pWy2ZbNMysQUlE9Ch1DvFbjPE6J1PvIQAVg9
yD5hAAAAfAGep2pDfwADJAAaEqJAB7RgHaTscyHHhlVAxd7p04tYe1bc+nbC5UZ0uT+8UClEuwwW
tQ+6Bfiq6yKSEzatHaPaTPX/HXxatlA6/uYYD4MRhuJT68y6LKtex+NT9F5F1cnA2hLD/8So/O65
fYCZfdLfv1K/KImMYnfImYAAAAEeQZqsSahBbJlMCCP//rUqgACM8zfsLKJsqgAQmBhsdjF39R/Y
vk1/7bVZ2S0nlMwqDdtMo7bElHFKHw0+SWAp61HmJc2OHVaENWkJOzRrYwvmUIJBjKy6dcJ0xmir
UvgwQA0mJdK0zwXz9AAg/nTnWnBNkkibRnwHhYwhGqcaZ8teiO4rQU6WrxpOntQR4H329sOJrASo
SNZ8hbQvgnZM4BwNnM/ReUBC1QhBQpuJtj2fF0zCRhT2T6+CO/LrVzh4ixlkU40US27JDtpVjgoI
jqG2BGIWFIp5A8bV5/U9eM2zY9G+Kc6q8uFhPp/WN6owVIXz/2sMG3Cg2SC8KfQEq55W4XN8lidR
y6XJhjkHWZxiSgpTyW5Li+1OkUI/oAAAAJZBnspFFSw7/wACIGNdrJ0oAO3YpE+UXF+VrnvobFZ6
NSh7R0I3G5t2ClSJq1Nnd7Z689dOiaddNt1VO6AN1kew7wp+v5dcVZetby9ZrreV1hNgT9eGE7LS
MgDdYHglsqr/xtauXyYpfe/KswJkUFWLJHx8eAFah2ogGIZmPOVsN94vLJUB0JbV9SgdQxyNsGsr
avXkTMEAAAB2AZ7pdEN/AAMGAHqoM9RQAEzxDjllS026TQ9GkS3m/ryHPNRlNGRRHaRkJILH7TBU
e3LdkNpcAsNaMgA8r0vQohKPLapLtpKHTd4tjUW6CEqIhPSS4bBluxGuDuQm+n+PVyNSjdybCDtT
hj+4PGKzg5JKAgBbQAAAAIIBnutqQ38AAwh1/Xobd2AATkdr3izxAw3ceQHL6/eqnIwaqv9RaqhM
G6sN+97iyVi8gzjaLio6VKiSozCnrdnyJ3/eKkkTgQrYRg6Z864xWHeVMgzTCxK+mXRRK7GlzpPO
UimSOjs69UuJztP6/Hsaoh6PdA2JLAecSKIYEW6TwB8wAAABDkGa70moQWyZTAgj//61KoAAjD8A
5QAAY6EPhabBhi/m1DlX4iy9jUVc5SgNzQTnyXwmINd3EQ6DHh/NNq9OsqDA6F1EW6rWNPWgM33n
/tsGmfXFKm9VsrF3+yQZ9bmN4f267kWuatoUBqIO1XYqoKLgvUx0q6/9K+8aXnhqoQLMD3lrKCR2
u1fzRU0EiNUo3vNXxlKdhQmqP9hU9Yz/FEChhMGoMSOZgEDnsK03vkmz0bnVt/MyCXeq76Mi7ykw
DGcWhMmJLSWGQkQ/eTk1oi7xKxy/Uh9VSy0DjHhv2h6lewihQe0EJAxqNLbQceNxbWMcwJwNoWiV
PU0USMpE1wgIwUyTp6kxUmDy5CAaPwAAAIBBnw1FFSw3/wADEFgRq4AS4ws0Nv+dZrdDe0E/e1wG
GYMn63anEgw6Jg94HuNtaGdVeCnP/ekT4Ibf00qIhVbr9EOg795juVziqM+YEEd5iauVAdOkQraz
MYiPe3nKhr7y+yTnkO+PmDFJOSuo1XmbET/oRBW/ZQGTidd9t+B8wQAAAI8Bny5qQ38AAwh1/7ax
7iAAJonD8mC3D2xzH7RF1JG9l/D/S76svh/EcWGl0lk9os65yb1ctkaqFi+2kPd5kcSM2rR2tbKk
x6z23x/2daOTBrpyLV7GAVCkhKH90EE2Dtb3knrA1mxi0VI9nS4qbRnyhMxHGJiGB0vjB4DRDmKX
9mhHTUho0GOOZ5sgwrIKmQAAAfRBmzNJqEFsmUwII//+tSqAAJAX1txYosCAGXyBSS4VXEVGPjlj
lN75rL8t/gV0CU0AF3/f+HEWpP9uzCNgv9W3O2wBBvda8x15d5HmUibIDf02PsdBMb8DtRL0OEpp
Ygo0ej23KtviRSroRX8npORJUXGzES2pWdE09g92Fvrlwsb0ZG51UekjIr/ldhFqRNQf3yE/w/Se
3ETGIfHPDU+XVGg0RE2iMd7/2o137qGKtzayBwCzvIJPjwJYxIB0isfEN9ZRz3tgGhPxA2RRwtDn
3W1EH45s+iAr3Low1jw56Nen/SQU/ZbSWW4PfkBHE2LFymIODXhP/vTpkArPKIKZGhGeQXxzC7W2
tRbnDoCb2z8KFatitQVeQAFRIfcuHnfHqp96hK/XeO2xuMsKLR0u+3z3uXkYQsg9WVl+O6kdzDR8
lUKFvaMM9C5KhX3z3JsDAIckXWUY22C8JuNBDILxcT1aOtj7KmI+mp+yN3q9NJ2BTjmD1F3qPbid
xsI23gJeh2BdDRSdugW93FmAAl5Ju9+2MU8t9dZ6M6bSHgsmvA1T7srrq5Fu4qaTD5+Gz2s/RCm1
mdlpRxukTnBZ/2fSvu7gnDgl1oNh14W9z5WhLmBGZl1aiGg1/CamiYbE2gQXYc2u6VhLgaAYqh04
y077PQy33AAAAK9Bn1FFFSw7/wACMOTWOgAmiw8ohP6Ci+1v5sxu1ZS/VWKidkKutZdFiu+zLJet
1Ahve4imX6vx0rw7xjcwkjgvEwg/CGOJyNp7sI18XiVXpJljtt99gbryBkzhiDxxo7zVr+bk5yCZ
iow5eOFZ1qCkNMXG4DAwADbVrBnXF6hf5vuTgfsCPd6JZ109rT4HOmmjj3K3cwUldNS2RI8c63I4
1xRugxFtSmLo+Z4VsMqAAAAAnQGfcHRDfwADJISDUIACYpm6cval7KYD0E7yX7RO8Hor5FXJaSTI
PvOpktwY3MGU/2eOY416tVvwqEwskJ1K2aBr3+kklPPvvtCIpqyG57Z9tRLJ9mDqvuXrAFzVEuo7
aJBv7Epjb2lSP7pfPP6T1JRWhnQ/g6cCdLuoN56BsHJv4DYpSIOpmFj8Mz/Ys8CyBN3q+TnqmOwi
EYzsFVEAAACCAZ9yakN/AAMIdf/5G7sAAmiW5tbFkLHRjp8RpLvtv88FnAWZR+jo6wVZ+CI6JzCQ
uqqg2tWSuOjvwmpQoaKyoe4JrG4Z/QBfqAGXMcbg3olyfX3laLWKhR4Q33eSHXKS/Lmuu6qON6+z
jPIvp6nkgi6KGboHUBPmLVEyK4GVEWUDpgAAAORBm3dJqEFsmUwII//+tSqAAIyyghmboAHQaHAZ
MlHEvU18yv3a2n17dgLJCmFOvBsBfLFkVxHCEbpcIJ+E62TzRhk8YLi3CmrJtykxVvKtUpOaLi6Y
qI4WN1zDF1hmLNyMeJxmpbG7hGxBTLAIIjuonj69+lR5v+hxjww8NOFmWhL3sdUWfIT4vo78Y6Ka
pqKDKjEOCojGAIMtt6RzudMsZNBdVvr4wRr4TBJGnf49Wx8bbpVYnmc2p/gnyWezcCAMpJuMigMT
qdivH+fM0Kq2LjGZESsyd2dA2X3V29xlfzFPWEsAAAC2QZ+VRRUsO/8AAhmH7w1hLBX6ACHElHCp
b87jfSm0KiiN4l5OHv2QzBjooiPpZQW+7qTl+6MqwEZSk7uEw/f2SxBbc1LbCxW4q1hT4wE/sPQ3
wM/ZCpAu5ogIqEdm6BAOQJBaWst6cS+znFpTtpR8x7cI3bVbABxmAL7k6R+ygocqliUSOAW7ey0x
4JSWLfAqgogoxMGAt1grxLVPGZdGaxlYTvurgcFwhNmfzHDDBwau3tIvE7EAAACZAZ+0dEN/AAMP
PZ1nQAJkS+pmZrZKDQ+g/ISM05HfW0OfpX/G4QN3w6PqW2EsjdDZHuouk8Y3jmlvfPwItI4Ipb9c
B3eJK80YlqAqDgOgRCXtHYlIP3z0p8X6bbgtLYe3zBDowhwBEXKz60oHzw2zN+01fO/P5OqN3XSk
8OsZGxyFMYMmnPJ7d4J1sDfmEk888V6/eQVU7DZgAAAAeAGftmpDfwADDu95KugATRQ/1hmGsjeP
DRvAG7cd8GN2/90+BbrSfXlnImjq42hEfOG8vYBJhpl9ONsO8K4AwaotsPn6M1EYQSXcOynJzjO2
y7VwOR+TzrofuUEc0jZaUJtsTfnkuEGCtq9jOWZCGWP4WBRAbmA9IQAAAXdBm7tJqEFsmUwII//+
tSqAAJCDTcIAC07WLf5e8ISY9KrbxIG/OGOGqt7VpMMHFR1YQaqCELqc5A0j2e75SNprK6faGjqC
RakxpS1j8M7QFl45u+5ydTAic0y20by3s7MX90zau96Z4nkwot3ciSRAfm83Q8iVJ/p3h+v2xQvM
HeSjVw2kVlJrUf+SmV0HiaIJ1RdwvC0Z5C17IAFxzFL6uGTL4L0OYnQdksMb/8UFCRqgAP5bDlR7
WirmoXzcxJIwErupmd5Ov85b16NEp1cfVE9MX6As4T8Zm63IAopl9ReOgz2/JKcx7rafUnWjBu+5
mVyR4mVAT6oiQD3XpdRhKHfu20uFYxLCB4XMpXi0fNf3BznCpi72Mmkbys4+t1DOLp0reY/Is/fg
7qectJbHLX2XeG6ight4Drgi2rjxQIN7KxzdrpeKoKTE0ND9th3oMzlah2uluu9QripBokye+yeR
wVo2yGANJU65hUQexc8CUcsGnVkAAACxQZ/ZRRUsO/8AAjEfe1t3T3cAHpGgRS9A/dCl58d7vjzA
0crRf8ymjSQEi/JwbqoFFepJFTZJwhW/Hyssujzky5LovbbOwBkkSjxzbf0RtYu5VMZSPupNxPSP
QDy3mDqrusgU9Y0Zn5N6NZFd0FhDovF05skuJYw+zlTD5o8zJwf+Dr81iA7eAp0JnaK2A5cUaub2
WzpAo/VkuuREXziwN7WZVeyPOFURJ2mhSeO2t1F3AAAAkgGf+HRDfwADCHX/trHuIAAmicPyYLcP
bHMftEXUkb2X8P9Lvqy+H8RxYaXSWT2izrnJvfxzd45Y0yvINnEjNq0XMeer6GxKcrYW0etC4b/5
srhoADI0X1T5rpnTIbWUG4MhSS/1olFgixwHtFH9uaGb+zhQwcvnTcrAhlEGH7+78gzLJCtSOlIh
sKeRNzHUcou5AAAAdAGf+mpDfwADJFwwji/y6gA/kK+yp76CwC9fD6SmapUNWv+XYPHn5DEQZppC
AF3KmBD36krlYJfqnHKB/cnJjU2/YjLJ6V3Om6xeEa3wdkDSunzrc81Fob2QJWKLjTIWI22EoHZQ
vtp7ZOLz+nN3nBYKgHpAAAABO0Gb/0moQWyZTAgj//61KoAAjPM3+1D644AA0JQ9A3voFksAzDKR
g9a5jrGDVbi3LsoUmk6sqJrXYVjVkVD6JvnClRytN6phBq74qlDgvF8U6udyVAUFwKtNK0Tl31va
W++IK0tvOmWb1Nu/7kgldRnMFGjBSOcDtCZGHEBPAyFcZ9K9ggAnoE/URKrH2n912sparZp5oGNS
1Uyk8e9ijlgT7R7swMYztGkoQx43KGLl4l2J643ru0iVbaPoHus5fdTDtdhZBw6vgBJ6XWy9JWqM
nJJL46SJ6bngYu6o1RiRQ5ot6dskw4pLGonwYgZPBKHxfwJlmk9nx9dg3ywsg0oJqatbn+Q0EsQ8
ZAAPXyoloxvkQG3yOshloNidquOFOBrE6RYMmfEbKXSr1deI6l8XNHRLgbrCi4n8YQAAAKZBnh1F
FSw7/wACGX0miftrsUJkYAWVuKXzTuOHMcRZVsVnO/yvs1dTi+KJLHHw2WjMiQQeK8/aK9Rv0Sqh
n1D/9z/mxs7GKxHRLVRmQNWj5rb4FtjFI5Ik5fd3V1mDC7YTZ2wROAh64c4NqTIFsOs5MwYlQFGJ
mOt8dxumSkkwLwZXljVhDkK9b9soYYXYggavFECXKF3Hc6N6SHSq402OsqXirAl5AAAAgQGePHRD
fwADDMocycF9O6ABLssDe0Ir0uA6uS9Fw4W99Y7IsrAfIzMn5xCA+N+cxGwqm0w91AuviQSeL58r
4dGot7nt6VIsKw+hR52JJs6z7nfuQdeNzzwN9KOVACX0Hhy5CLv/42PzWLJ2W47SZMTR1xNjbtgm
wo3NF4ZzNlA44AAAAHABnj5qQ38AAw82DVnQAJVZ5A1OItaMfRhzNLlJD5I7T/ZxuRGDFfenccnc
83JtZ2lelxc18OWWwZkcreFHkF2kuZKdQePPmeit8lnMqsmmQaZ0+lERZyI4C0C/exkvhsdsXZW8
jdNdmDj4IhoNkOOAAAAA9UGaI0moQWyZTAgj//61KoAAjFJ8tHbABlz84wgFuH2j+4wjLBLGbJHU
lSsVm+CkX5Kw8Jre3korxjnGhgFbMLqvAeNW3IMdZN/YWYXfilLp/rvC++7QraPDLlo2p+P/2Png
idxchqfpx+BQVv60P2G8GsMan2wli/6eNYD9trR+WUFI157fHnl4bL7GwQ2HZT/ituuAFBg+63Fu
OUD3zV2TUKaBNzIMi7WPvSGwR3Yeq3xYDubLt9sOUF7ND33XUv3KblC1BVLLzqR4YzcirZBCqDlK
LYMkwbXAaj1RQ5+Rtld3dDunvBHsQxQt9osHmAF2WNFBAAAAkUGeQUUVLDv/AAIc0qVyXFQAP9CA
fztErv6nZDtd4DykFMP7X7jG0q7QuuRrNGsqfcdtsqllMBZ3H456PAYFKBd895c588Iek+9pCZfv
kHIkUTQdK0HX2/Ks6s4kHLsW5XVdLAaQ1YRBfFOWMJkHa0ZZpR5b44tA/IEfK5n1naTVgPUKQEWV
7UB5qnc5kmIsN6AAAACGAZ5gdEN/AAMPySskAJcof6zAWir+8n4lJFE7mYGPdWnw9lgc/S37nLzY
df5eFOEHBl0quRr3VG8RTGRnUnsWBaFbt2mquDrEybH9zaKBeIelFxkkOjxY53fUrVuvsV5dt6jq
9ZgCEsTFCypowouFmLji1gxEupJFfPO7mUNLdIGkv0HEB3UAAABxAZ5iakN/AAMIdfqcxmYcAATR
OH5MF69IR9WVvd0EDyXUfxN0/D4/iOLDTM/dCKzTUxO9I126L5E4C3mRxIzatHa1sqTHrPbfH/aN
xzGgGBSIqJBpKT9rL3AAhvtPdENfcNqa+PmQ5JIMAFEPBCtEA7oAAAGwQZpnSahBbJlMCCP//rUq
gACQFl9ujXQAcJassVMLEYw+nE5OqMA/DHb8WxMEPh6WTazIHkzU8mtoYykf1AkW12m80tjBUTW2
va4ZcEk+W4Y2ExGpXgt7WLbGvw0uQ9u99ingRto+CTcTk9yua/NDARj7r/rdyS2CxsApIt1naYGO
DeMuUkm+hiMxsxpqsgwiP5zMN+1o3v81kUtVUwZnD4qOZtVuvpsuakPUaTxWBPS0uMMns+IKKfwO
yWc692vODA996ugWy0bQ9To9A3AiLd5/S6FqlGQwk1LHGpbt0Jle4CzZM0tTvzFeU9xSXFr/r8qZ
u/Q7dRT7VJI8AvJi31RrayJlrwxEa3N7mh5O051DLhMaHolBBIfnmE6mbE7Ha2j1vyRb0GBUg0w9
/btt5c1hE+yQclMLT+buG+0bZKQOeX5wEyhAD8NR95SmtLQ7KOJ7jBochHigpCXY4vjSgVg89kSd
guZ4hAWZ8zw5KZiSp5PQUAogyLPe2qWh4ttE7jkHs2YYYoHF/M6wbdnw+SEJwPx1X82duC5YcCdt
+WNMpHmWSelPaNznxYuMbYmhAAAArUGehUUVLDv/AAIw49VArlaDuAD3dtEyrVJcjVnRM4f2MvFL
+sXNJPzv7QDmZbNJfjNBmbx54q1nXdLcD+ZXRW5CpO6OlBhbRnpqawZdZ+D0OmiDiiN01WvN32l1
BKSv5Qb/9OeDBXKVqzvABxuL8YRZUFLnORanrm6+kxEF8W0qvmg51WBjwK6oIGsm91p43qs6x3V/
USKkQevg/4YeszN819uAAwwHxzVgwgIXAAAAlQGepHRDfwADJIMww9yTwACdoV9k+f+yOC98PpLU
A6LPePwnu8Jd1ClACeCpHWavO8nv1JXKoB3vqilX/cnJjU0CmC1R99YWEVYxhaZcpQN0cy/mVWi9
YhefSTxkH09kIYmL5e+NDIvSN8WDKQhXuUSs4H1zZcH7+c2MNMfhYddPefA8DJPP0+18Zn0aLEw5
S5MVAO6BAAAAlQGepmpDfwADCHX/+Ru7AAJolubWxZCx0Y6fEaS77b/PBZwFmUfo6OsFWfgiOicw
kLqqoNrVkrjo4JwVKFDRXN/lTDToFt2sxK3IsoL6Vhljn49BGG6oW8UWZ0KiQ3FXN06cCcwzd1DH
oW4qxkqfh7uChlPEqI5nq1QT2CAw0Ln7+pPyJJe+h/E5/3KE9DhSCObE1A3pAAABG0GaqkmoQWyZ
TAgj//61KoAAjNyqzN0ADoWZBfjx/Z9cniUA18az/utAqKuDZLcmljfi3Q8+HguOwWAB1AzT0P6A
iPnHhBw0rUt2prd/DRmrNCXX/QDDmyl21wVjrLCrldPsMJVw5RhZMX2f/0Jkg+A4venDl1Al2o53
X6D48tyoe2Ode34aH8vcOjPy9Ckpn54M7ZF1h1/ynCzqJ64IriO9Dxmshc+d8gFFDO3PnlKgxz28
Mteop+/s82cKIqoquZijUOf8cOGUR2wXjyXLWKQpQYHdMxklcu4xS/CryZ+8KWvoyN614if0jivu
WGEhCZWItVoDHJkEYTVT+oJnC/1T5EMatsDYoZUeqHZd7cPBvLIDPsnl+P67TkAAAAB6QZ7IRRUs
N/8AAxB4aIAC1t/m4rIY3F5SsBj+Yt49bKVczZdV3mLgmA7iz3Tne2IEo+/eL+hM8v+M5plcfki1
C0WrquLgI1UfHCFa/OP67TrYA9rM2i8bvO60uEAl7uCkNdMRUNo0LCXCGt3L2v67XuYijkKcwzOV
AS8AAADDAZ7pakN/AAMIdf16G3dgAE5Ha94s8QMN3HkBy+v3qpyMGqsE4WifGUbp6fScF12P2VN7
KFdnbgTAyA8KNhC0zCqjRh66Ypqh0GfxrtI127WZBkE6HDvmGiSbC2fH9S/aKZmznBOIOHQ0tYq3
lACIm9CFV2FqAxovnycmnShd+0spvCgVN7NYvDFnOPrya7KsydC6qBVdOjSecbrrNt05/8WrTDYJ
uBdWfPJml5cuBVlC2i0a22qX/GenwywaQ1OTtiNTAAABcUGa7kmoQWyZTAgj//61KoAAjCIxTAAK
W5GH4iW/hIhEtOP+hUNj238mS8ot7dusB07417xn/RprCYjl4WB4VmnhctAazjbzmQiL48cU4IWK
opxm4UKE8DHBN2ZQoox1/d8RV0Ohpj+VAHw8XLEugXhqL0uDATjtLf9Edrc9YHg1XqTPLK4pF9C7
CZrXxxwwvIeV90TEbNprKyMEeBjIDPZs+HtOhzqvdyo3W0eMXWgxzk0u0PUBMtDAuPmIrdYN/CQf
7h3V3joDfhpfFxNgS8fBnd38yigZQz/BZ12eUI0GsL4a5YziL/jMktKfxmwbi+ZekHLSG4rZ/q+S
xbc3yl2BoA/JVgtR2HR9tybqLNuDuDu9/FKtaPPt7df06nO889kEhymLfys6IP+biPXgde1xiTfd
FKr6TPO2cPkKE7Bp/rzkFiSoXMhAdFTP8X/VfZWhPSf4P4PXko1jg9LJU1F2RoW6Wr5DkLunrpnQ
FXk3sAAAAJdBnwxFFSw7/wACGYbGANIMBUAE0URh87dqSCTo5joEklcOt7Kd5ob0v580GUlJX/gb
CUWur/Hjm60Cg5ZUs6yv51zmrwQdSrBLdHGQj7MbXrOvEu7lZmv/N78gje4XTuhTHG4TjuPRCPRP
1XVS10NIq2J87C6Qj3LvEZnaUAlEKmShGlu7Z+ZAO51UcWEbkFW3UgdZECPgAAAAowGfK3RDfwAD
D24kX4APibG0OgsfwTohnaCfvXkDDL0GTUyC4X3pDnShOJlqCNdskPU4H0OSYbwdZ1i9q+oJIAbf
mMrz5k/0Mtnp2fSphaDM6xqQb0zBYWuqBIq/AeIcBmhYP2FRTLWM9LIheT9PretUW+nA2e/j5mLD
n1RmhDK34YSEDugqxFMaQR5IANCwAqzQnoqqTSXr00A71L8O8ziuiNkAAACRAZ8takN/AAMGAGtv
ZawVwAk0bd00USM0+3zkSo020ndupsTCqxWOdijIfDWJW0aU1tw5jxu0Htbq9kuGE5lXe6gZG2Yn
SD/8gF/5zBieK7qiw0imqJH5Dx2XwOkDs118aISUvyhoQusN8poWBZGY+yF5Mlpb6aYNCyVMDHKK
0gB9zOJzCWOQlPVLXeHY3yWK+QAAAcFBmzJJqEFsmUwII//+tSqAAJCC0XCAAk+eTPri7QWDA4oo
qWTh0NPJUbPoTQojfXQJInEf/Dax1a9dqv0eEwUnBtVlke625eqp4sednnhQVv5220Mw8OEOykQC
8D920YoHyTW74kZFgY85JB7gIKugCWHaCnOcXNLitul6L6msiaH9N//xX3PJREbuljWOhZPMd5nU
k5i0dsIqIKFsHIz6rcJyWgqajZc/PLyKXg4DDncgxCD61ULQJA/zBdUCOvy78eLgw4o/CgWO3Wse
suTmJ+sXvMvqHEh6DMftrPfXsdZ08kN32rO9HILT3lYgdPn41u+39G1dM0rXicCXVGvwKPBR1vjA
JxfVuUbMGII6UPiYgGwt8KWjCd70QSnIxheXTACQAEqjnO73A0+wqMPnlQa71VtGuugpuQNPK9RA
wfs9i98smYeSG4nGG//cax0nTbEQssSSWXOdkHvtgqjBW8vQ0RcE2IJpEzJtlXrW+7RRHDWvuA3x
0uw1/EYuvuZI/EdKQNOk6p6Nsplu1xJqxXmTBMhBK3iqhAW6PwJ02BHoCOoI18rhQwcUgxMF0bsB
63EBzDPgaSo5pDdzJpwSQQAAALlBn1BFFSw7/wACL/5RDP/yOE4ABa3hYiIFMVqEgHQVY3yZcTFp
y9mg/JIVdVvODQJNHWHmsRCK0LI+M38jji0Yru0mdezXdiVMNltrwWHWSnaPVa3xGHxSorkpvPxq
RcBNBL3PnFEvloPKCMNORFP7Xgg+xaxTZsorT4XW0ntwX3g0VgBck2zreNkDoFeda4PiFvcSqT2H
kNDQoc/B9qm9vO4LGJyutCOilhi654TslmAh0pHIYGwbMAAAAKoBn290Q38AAyPVfs0gA7m9r1Eh
NkMBWmK/M5YV+bqxub1Q/t2RUi8oE851MV9BMooahYdAYhV6ce1ZT2/8btXI3Jqwch+yoZhrnxfc
Ugpp6oJV0HwknuKFYXW+kzXOAea400fzcKEL9IYIg02RfOsFKtcGXg10gBGDNzf7gr/XKi2tqRsc
ideDgGSnbhvHeY4Yz0lOvZ/7CKzVrC2So0uo/Xlnatv332RnwAAAAJoBn3FqQ38AAwWMcjokzHDN
IAO77n6IfbT+hfST9BY//beEp8caUH5vF3/tt5RTf1UrPLOvR4BBRiH/JZ8nGeSdZ43f7xAgiWhz
yHdHZ9CkoTQkEpd4ZJrtvIEqu5NXsIbP41n7TRktuJATukltkO3TgNvGfzVOQSVG+pIX5zueeDtu
dTpezCuAQZToihbdsVaV5jUCXollJPFlAAABEkGbdkmoQWyZTAgh//6qVQABGeXP2mseudACBvZI
8WhMNFalA4pc4L09I5xWvQgOOlbr50kQ5brnafz5/5wfVZAEf8e2Wcn4dNjYN+7FZHoN+ddF0+Oz
cFFZ76UDngQShLUQlfwSWq2EmjTKbm8DlU5d+pOY4vu8T9JO29qV5pxLj5kiu9ber5g4jU9twS6B
Eqdd+p9GemMjdbHGQGYlLEQ5GPyZ+kdKSPSoJa0Cpy19TVngnDCsbECB7MOnWCHWiAbUgu9py9VK
qHqjKFgc4iNMcPdTVM52icJa68VXPMEJQ6DNu4XOynUQilthvxTHiPkQQgP+w59uprJLZ4suRD2t
y7xJV/KiRuz23jCO7DsWWzAAAACMQZ+URRUsO/8AAht+f8K+SzWAAmixJf7WbReqob4KdKZ4bn8d
iCCgePQcqCcJ6iafFgIUo8GKSdmZElXtyvEkMRODne/OePIzNt0IonCl1DAyLBV4e/F1G8qYnoSK
BvENa8BCnTnKvy8IwfAmwE8u9qbvulC3LwzWQwwfdl0T2t7zq5wYTA8/124AOOAAAACkAZ+zdEN/
AAMIdf16G3dgAE5Ha94s8QMN3HkBy+v3qpyMGqr/UWqoTBurDdg3jnPr0G/5LehlIwvmSLY97nGI
eRBKUzmMIb1kTtNwZHoUB1No/BVSly278iarAw30RXitU/L7hB+Uj6HAAH+WIzTS1UQ+Sx9iJVb/
nwYcy0RIiP/yB3HvVdUuNjkhdEfgM/2naUflbU9Fx1U9Mr+mfPeY8NSATMEAAAC1AZ+1akN/AAMP
OVhpHkAJcYWaG3/Os1u4vtAucfmBiJiqHJJUYLNCDmbcUCjorQNAusxSOp9Glpt0yOTRVfdWnHRa
Fco1svRecSmLqbDjTwft3zIbgyrjCVrFntRaPMvD9PkgZKc2j4uVTAlQPg6mW1UFU6esW/vywP69
vpQ/F8/UZZeoLwydU+fYdLoxN/N++t+7niPRTnkDY5D1GaTGc+gAcRaD4r49O34fpUccztPko4YD
jgAAAS9Bm7pJqEFsmUwId//+qZYABGJv8+AB+Y98v0sTyMImAZ/4i6AhQqj38lijnI/gdYogXzTl
Qvi2ECDgOrPFYdphRqxSDRw8Wx+tEPmbofUStvaHnjyiZdFQIEWXUhlSNz4ZswhfEV6ZZz+kHZCE
9RgxJIUOCvoR5y/8jH7G1DheESxMp6N3fLijyna3ecA1hiIbrgjmpI+h9VTBUVcUreiB0ex2lkve
S8myVNEa4+49PlVWfaJcy7qdr0SEdQsJVkCFH+MNN9SE17uKJXvU99U6nsTcKxQ9JjT0HtQ+nDvJ
jptbdd4UewGR9dRSlIYamuWkg+eOUvLI8tHODdVviCZ8pk5uRUVjdINLwGVAGag1+56WphK2Sk2p
vlCtu/XDFxo/otjNY3xSJbyPpivoZkEAAACuQZ/YRRUsO/8AAjEfrxDft0AHxV6pvDBJSSmWIkDx
qk6a61SVAnG6dtIi5oYduMMlGAmrgmDeShojfXzNzz9AtB6WLUcfkXyGKyKtIz80lXyvYSXIlrad
nXV3z4LHk7AtdbVpaXM+mOgwdpFaRND7dVXBYfBearW53sJqdpJwzzIkO8YLdoxPFy9umBlF9Jpk
687DJ+JJHaPTUn/0b+oQ1epW8SLbbpCMfwA8WEzBAAAApQGf93RDfwADBk74jhwAluIMrocQzCBU
OORShPd5BeRmux08yjCN3cVWnHrg54CjG3QRqVRDaKZuvgGs97Sq+3Q9T3+bqZO9sGrpQEZoFXXk
f2L4QUtH1LdzbvxNKGF11Mg5mSgrGC6r3hliOvFfNRQVPjyfOGMXv6se9xv08HQ0VHM9DUVDb+lY
H8dqFTR+Rrr8yQerJ8cvg+74XBqeU/rBZEGDjgAAAJYBn/lqQ38AAyQAV9aKPAAJPtCaszRn938E
fuY6WeIt6RaVAjovUYa92u+1bnMqv57SPpUG3ZBg9Pcxnl5+wovxHvd7tWyYDboC+m7G1HYmhkLv
32c56Cl9xb4WgSzXdwpKvbwIqZEFlSfh0EPtTghCEoVHNZpztykPKFJd1VbR5Nd4HZFneeaZe7of
ejAqrQyG27MoRsEAAADMQZv7SahBbJlMCG///qeEAAhnlrITHUjScAJbhuDkEytC2uUZ+m8lpx+V
ecSKT66mG8g5svv7yFUoAhgXjuu+MX8UBxO4i0Dyuhgs2JdAUlOrzi/SgepdCawFQq/DNJuT+K0a
ZWxwIpR4ER2xe1Xw7+8LWDx8gg6/qs5tnhA3FtCM9yGYlbcoKba5si6oJqouiBPD+qd8C39oY9li
CAAljdCrZlSUgpaVmxv+VqBFONQiZAko8hzRDWt1zWwefG0zfXADphHAEUKXjHlEAAAHcm1vb3YA
AABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAACPwAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAA
AAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAacdHJh
awAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAACPwAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAA
AAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAKAAAAB4AAAAAAAJGVkdHMAAAAcZWxzdAAAAAAA
AAABAAAj8AAACAAAAQAAAAAGFG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAKAAAAXAAVcQAAAAA
AC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAABb9taW5mAAAAFHZt
aGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAV/c3Ri
bAAAALdzdHNkAAAAAAAAAAEAAACnYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAKAAeAASAAA
AEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADVhdmNDAWQA
Fv/hABhnZAAWrNlAoD2hAAADAAEAAAMAFA8WLZYBAAZo6+PLIsD9+PgAAAAAHHV1aWRraEDyXyRP
xbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAABcAAAEAAAAABRzdHNzAAAAAAAAAAEAAAAB
AAAC4GN0dHMAAAAAAAAAWgAAAAEAAAgAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAA
AAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAA
AAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAA
AQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAAB
AAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEA
ABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAA
BAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABAAAAAAAgAABAAAAAABAAAU
AAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQA
AAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAA
AAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAA
AAEAAAAAAAAAAQAABAAAAAABAAAQAAAAAAIAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAA
AQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAAB
AAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAIAAAAABxz
dHNjAAAAAAAAAAEAAAABAAAAXAAAAAEAAAGEc3RzegAAAAAAAAAAAAAAXAAACAUAAAGHAAAAgQAA
AFwAAACnAAABpAAAAJ0AAACQAAAAlgAAAWwAAACZAAAAcQAAAGQAAAD6AAAAcAAAAIkAAABiAAAB
cgAAALsAAAB/AAAAbgAAAXgAAACAAAAAdQAAAIMAAAFCAAAAkAAAAIYAAACDAAABlgAAAKkAAAB1
AAAAhAAAASYAAADAAAAAiwAAAI8AAAGzAAAAxgAAAKoAAACAAAABIgAAAJoAAAB6AAAAhgAAARIA
AACEAAAAkwAAAfgAAACzAAAAoQAAAIYAAADoAAAAugAAAJ0AAAB8AAABewAAALUAAACWAAAAeAAA
AT8AAACqAAAAhQAAAHQAAAD5AAAAlQAAAIoAAAB1AAABtAAAALEAAACZAAAAmQAAAR8AAAB+AAAA
xwAAAXUAAACbAAAApwAAAJUAAAHFAAAAvQAAAK4AAACeAAABFgAAAJAAAACoAAAAuQAAATMAAACy
AAAAqQAAAJoAAADQAAAAFHN0Y28AAAAAAAAAAQAAADAAAABidWR0YQAAAFptZXRhAAAAAAAAACFo
ZGxyAAAAAAAAAABtZGlyYXBwbAAAAAAAAAAAAAAAAC1pbHN0AAAAJal0b28AAAAdZGF0YQAAAAEA
AAAATGF2ZjU4Ljc2LjEwMA==
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">glue</span><span class="p">(</span><span class="s2">&quot;n_episodes&quot;</span><span class="p">,</span> <span class="n">n_episodes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;glue&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>今回はエピソードしか学習を行なっていないが、それでもランダムの時と比較して、かなり長い時間に渡り振子を倒れないようにキープできていることが分かる。</p>
<p>エピソードの数を増やしたり、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法以外の方法を用いた場合に、どのように学習結果が変化するかについては、ぜひ自信でコードを修正して試してみてほしい。</p>
</section>
</section>
<section id="id6">
<h2><span class="section-number">2.4. </span>練習問題<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>CartPole環境において、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の部分をソフトマックス探索やUCB1値を用いた探索に置き換えて、学習の性能がどのように変化するかを調べよ。</p></li>
<li><p>CartPole環境は1フレームごとに報酬として常に1を返してくるが、この値を画面中央にCartがある場合に高い値になるように更新することで、できる限り画面の内側で振子を保つように学習方法を変更せよ。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/sec3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reinforcement-learning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">前へ</p>
        <p class="prev-next-title"><span class="section-number">1. </span>強化学習の基礎</p>
      </div>
    </a>
    <a class="right-next"
       href="othello-agent.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">次へ</p>
        <p class="prev-next-title"><span class="section-number">3. </span>オセロAIの作成</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
著者 Tatsuya Yatagawa
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright CC BY-NC-SA 4.0, 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>