

<!DOCTYPE html>


<html lang="ja" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. Q学習の基礎 &#8212; 機械学習発展 (実践)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0eecbd62fcd6461a8e6f2af8b451ee66": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "193426268ae04954bdc66d9e9a0757a4": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1d43a9e5e8174114886a3467ecbe9475": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36f16e95b2d14c4aadebfdf7a7bc3986": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4f4762d4a6be444a8fc6425b7ebf1ac4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_36f16e95b2d14c4aadebfdf7a7bc3986", "placeholder": "\u200b", "style": "IPY_MODEL_8738195747f94aaca2eac677540232f1", "tabbable": null, "tooltip": null, "value": " 10000/10000 [01:09&lt;00:00, 147.37it/s]"}}, "67c6bd9fa25f4b34b8fae462dc876309": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ef1464110f974d45bba7275db2713a20", "IPY_MODEL_d54b9ce23fb34753a31467863828da77", "IPY_MODEL_4f4762d4a6be444a8fc6425b7ebf1ac4"], "layout": "IPY_MODEL_7c265465d0ea48bc93167c12f6f616e3", "tabbable": null, "tooltip": null}}, "7c265465d0ea48bc93167c12f6f616e3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8738195747f94aaca2eac677540232f1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a973cc2e1e9148c69c6fd1bc5a9897d3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d54b9ce23fb34753a31467863828da77": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_193426268ae04954bdc66d9e9a0757a4", "max": 10000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_0eecbd62fcd6461a8e6f2af8b451ee66", "tabbable": null, "tooltip": null, "value": 10000.0}}, "ef1464110f974d45bba7275db2713a20": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1d43a9e5e8174114886a3467ecbe9475", "placeholder": "\u200b", "style": "IPY_MODEL_a973cc2e1e9148c69c6fd1bc5a9897d3", "tabbable": null, "tooltip": null, "value": "100%"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/sec3/q-learning';</script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="3. オセロAIの作成" href="othello-agent.html" />
    <link rel="prev" title="1. 強化学習の基礎" href="reinforcement-learning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">機械学習発展 (実践)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">第0部 各種基本ライブラリの使用法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/setup-python.html">1. Python環境の設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/numpy.html">2. NumPyの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/matplotlib.html">3. Matplotlibの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/pandas.html">4. Pandasの基本</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第1部 画像読み取り式数独ソルバの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/opencv.html">1. OpenCVの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/figure-detection.html">2. 図形の検出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/scikit-learn.html">3. scikit-learnによる機械分類の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/exercise-sudoku.html">4. 演習1 - 画像入力式数独ソルバーを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第2部 ひらがなOCRソフトと百人一首エージェントの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec2/data-visualization.html">1. データ可視化と次元圧縮</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/feature-extraction.html">2. 特徴量抽出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/deep-learning.html">3. 深層学習による物体認識</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/exercise-ogura.html">4. 演習2 - 百人一首エージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第3部 強化学習の基礎とリバーシエージェントの実装</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reinforcement-learning.html">1. 強化学習の基礎</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Q学習の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="othello-agent.html">3. オセロAIの作成</a></li>

<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">5. 深層強化学習</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-othello.html">6. 演習3 - オセロエージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/notation.html">資料中の表記について</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/tatsy/1284-sds-ml-advanced/blob/master/./contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced/issues/new?title=Issue%20on%20page%20%2Fcontents/sec3/q-learning.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Q学習の基礎</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="q">
<span id="sec-q-learning"></span><h1><span class="section-number">2. </span>Q学習の基礎<a class="headerlink" href="#q" title="Permalink to this heading">#</a></h1>
<p>ここまでで扱った多腕バンディット問題は、取れる行動の種類が少なく、また、問題の状態が変化しない、すなわち、いつスロットを回しても、各アームの当たり確率は変化しない、という特徴があった。しかし、実際の問題は取れるべき行動の種類が多く(場合によっては連続変数)、また、ある時刻で取った行動により、行動を行う対象の状態が変化するのが一般的である。</p>
<p>このような状況において用いられる強化学習の手法に<strong>Q学習</strong>がある。Q学習のQとは<strong>行動価値関数</strong>を表すQ値のQであり、とある<strong>状態</strong><span class="math notranslate nohighlight">\(s\)</span> (stateのs)において取った<strong>行動</strong><span class="math notranslate nohighlight">\(a\)</span> (actionのa)の価値を関数として、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>のように表す。</p>
<p>このようなQ値を学習する方法はQ学習以外にも<strong>SARSA</strong>(state-action-reward-state-action)と呼ばれる方法もあるが、本節ではQ学習に絞って説明する。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">下準備のコード</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">ArtistAnimation</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">glue</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">_</span>

<span class="c1"># 乱数のシードを固定</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>


<span class="c1"># グラフの設定</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Google Colab用の準備</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code in Google Colab.&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code in the local computer.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="c1"># Gymnasiumのインストール</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;gymnasium[classic-control]&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You are running the code in the local computer.
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2><span class="section-number">2.1. </span>背景<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Q学習で扱う対象は<strong>Markov決定過程</strong>と呼ばれる状態遷移のモデルである。</p>
<p>Markov決定過程をかみ砕いて言えば、その時々で取った行動により次の状態が変化するが、それより過去に取った行動がその状態の変化に影響を与えることはない、という性質 (この性質を<strong>Markov性</strong>と呼ぶ)を満たす状態遷移のモデルである。</p>
<p>Markov性を満たす状態遷移であれば、とある状態<span class="math notranslate nohighlight">\(s\)</span>において、行動を<span class="math notranslate nohighlight">\(a\)</span>取ったときに、別の状態<span class="math notranslate nohighlight">\(s'\)</span>に移る確率は<span class="math notranslate nohighlight">\(s, a\)</span>だけに関する事後確率として<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>のように書ける。</p>
<p>Q学習では、この事後分布<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>を用いて、行動評価関数<span class="math notranslate nohighlight">\(Q(s, a)\)</span>が以下のBellmanの最適性公式を満たすと仮定する。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-eq-bellman-equation" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \sum_{a' \in \mathcal{A}} P(s' | s, a) Q(s', a')
\]</div>
<p>この式において<span class="math notranslate nohighlight">\(\gamma\)</span>は<strong>割引因子</strong> (discount factor)と呼ばれる値で、<span class="math notranslate nohighlight">\(0 &lt; \gamma &lt; 1\)</span>であり、<span class="math notranslate nohighlight">\(R(s, a)\)</span>は状態<span class="math notranslate nohighlight">\(s\)</span>において行動<span class="math notranslate nohighlight">\(a\)</span>を取ったときに即座に得られる報酬を表す。</p>
<p><a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、<strong>最適な行動価値関数が、その時、即座に得られる報酬<span class="math notranslate nohighlight">\(R(s, a)\)</span>と未来の行動から得られる報酬に一定の減衰を加えたものの和として表せる</strong>ことを示している。</p>
<p>一方、多くの状態遷移のモデルでは、状態遷移は確率的なものではなく、行動<span class="math notranslate nohighlight">\(a\)</span>の結果として<strong>一意に次の状態が決まる</strong>ことが多い。そこで<span class="math notranslate nohighlight">\(P(s' | s, a) = 1\)</span>と仮定する。さらに、仮に理想的なQ関数が求まっているのであれば、<span class="math notranslate nohighlight">\(s'\)</span>において行動価値が最大になる行動<span class="math notranslate nohighlight">\(a'\)</span>をQ関数から決定できるので、<span class="math notranslate nohighlight">\(a'\)</span>は行動価値が最大になるものであると仮定する。</p>
<p>これら2つの仮定により、<a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、以下の形で書き直せる。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation-2">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-eq-bellman-equation-2" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \max_{a' \in \mathcal{A}} Q(s', a')
\]</div>
<p>Q学習は、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たすような<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を強化学習の枠組みによって求めるものである。</p>
</section>
<section id="id2">
<h2><span class="section-number">2.2. </span>アルゴリズム<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>Q学習は、実際の環境において、適当な行動を取ったときに得られる報酬と状態遷移から、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の両辺の差が小さくなるように<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値を更新する。</p>
<p>典型的なQ学習の実装では、<span class="math notranslate nohighlight">\(s\)</span>と<span class="math notranslate nohighlight">\(a\)</span>を離散化して、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を二次元配列として扱う。このような離散化されたQ関数を<strong>Qテーブル</strong>と呼ぶ。</p>
<p>Qテーブルの更新は現在の<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値 (学習途中は必ずしも<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たしていないことに注意)を<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の右辺に近づくように更新する。</p>
<p>具体的には、学習率<span class="math notranslate nohighlight">\(0 &lt; \alpha &lt; 1\)</span>を用いて、以下の式で<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を更新する。</p>
<div class="math notranslate nohighlight">
\[
Q_{\rm new}(s, a) = (1 - \alpha) Q(s, a) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') \right]
\]</div>
<p>また、この式は以下の形で書き直すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-q-update">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-eq-q-update" title="この数式へのパーマリンク">#</a></span>\[
Q_{\rm new}(s, a) = Q(s,a ) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a) \right]
\]</div>
<p><a class="reference internal" href="#equation-eq-q-update">(2.11)</a>の右辺の</p>
<div class="math notranslate nohighlight">
\[
R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a)
\]</div>
<p>は、<strong>TD誤差</strong> (temporal difference error)と呼ばれ、Q学習はこのTD誤差を最小化する問題であると言い換えることができる。</p>
</section>
<section id="id3">
<h2><span class="section-number">2.3. </span>倒立振子のバランシング<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>Q学習を実際に試すために、比較的単純な倒立振子のバランスを取るゲームについて考える。倒立振子のシミュレータは<a class="reference external" href="https://gymnasium.farama.org/">Gymnasium</a>というライブラリ(旧名: OpenAI Gym)から簡単に使用することができる。</p>
<p>モジュール<code class="docutils literal notranslate"><span class="pre">gymnasium</span></code>をインポート後 (<code class="docutils literal notranslate"><span class="pre">gym</span></code>とエイリアスをつける)、<code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数を用いてゲーム環境<code class="docutils literal notranslate"><span class="pre">env</span></code>を作成してみる。</p>
<p><code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数に倒立振子のゲーム環境である<code class="docutils literal notranslate"><span class="pre">CartPole-v1</span></code>を指定し、<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>パラメータに<code class="docutils literal notranslate"><span class="pre">rbg_array</span></code>を指定する。</p>
<p>このように<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>を指定しておくと、<code class="docutils literal notranslate"><span class="pre">env.render</span></code>関数によって画面の情報をNumPyの配列として得ることができるので、Matplotlibを用いて、初期状態を描画してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>

<span class="c1"># ゲーム環境の作成</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span><span class="p">)</span>

<span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">31415</span><span class="p">)</span>

<span class="c1"># 現在の状態をRGB画像として取得する</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" src="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" />
</div>
</div>
<p>このように、CartPoleは台車 (cart)の上に倒立振子 (pole)が取り付けられたものを制御して、できる限り長い時間、振子が倒れないようにバランスを取るゲームである。</p>
<p>倒立振子は、その状態を表すいくつかのパラメータを持っており、それが<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の戻り値として取得される<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>の中に格納されている。</p>
<p><code class="docutils literal notranslate"><span class="pre">obsrv</span></code>は<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数になっていて、CartPole環境の場合には<strong>第1要素に状態を表す変数が入っている</strong>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 現在の状態変数を確認</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obsrv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.1067048e-05 -3.8479745e-02  3.6217723e-02  3.3740070e-02]
</pre></div>
</div>
</div>
</div>
<p>CartPole環境の場合は、4つの浮動小数が格納されており、先頭から、</p>
<ul class="simple">
<li><p>台車の水平位置</p></li>
<li><p>台車の速度</p></li>
<li><p>振子の角度</p></li>
<li><p>振子の角速度
をそれぞれ表している。</p></li>
</ul>
<p>また、それぞれの値が取る範囲は以下のようになっている <a class="reference external" href="https://gymnasium.farama.org/environments/classic_control/cart_pole/">[参考URL]</a>。</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Num</p></th>
<th class="head"><p>Observation</p></th>
<th class="head"><p>Min</p></th>
<th class="head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>台車の位置</p></td>
<td><p>-4.8</p></td>
<td><p>+4.8</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>台車の速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>振子の角度</p></td>
<td><p>-24°</p></td>
<td><p>+24°</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>振子の角速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
</tbody>
</table>
<p>この値は、<code class="docutils literal notranslate"><span class="pre">env</span></code>の<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>フィールドで確認することができる。</p>
<p>CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>は<code class="docutils literal notranslate"><span class="pre">Box</span></code>という型で表されていて、<code class="docutils literal notranslate"><span class="pre">low</span></code>、<code class="docutils literal notranslate"><span class="pre">high</span></code>というフィールドにパラメータの最小値、最大値が格納されている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lower bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Upper bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lower bound: [-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38]
Upper bound: [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38]
</pre></div>
</div>
</div>
</div>
<p>Gyminasiumのゲーム環境には、この他にも多数の関数が用意されており、それを強化学習に用いることができる。</p>
<p>まずは、その挙動を理解するために、ランダムに行動を選んだ場合にどのような動きになるのかを確認してみよう。</p>
<p>ランダムな行動選択には、<code class="docutils literal notranslate"><span class="pre">env.action_space.sample()</span></code>を使うことができる。CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">env.action_space.n</span></code>に格納されているとおり、取り得る行動は <strong>0: 左に移動</strong>, <strong>1: 右に移動</strong> の2つだけなので、<code class="docutils literal notranslate"><span class="pre">sample</span></code>関数はこのうちの一方をランダムに返してくる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに5回行動選択をしてみる</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
1
1
1
1
</pre></div>
</div>
</div>
</div>
<p>選んだ行動をとって状態を更新するには<code class="docutils literal notranslate"><span class="pre">env.step</span></code>関数を用いる。<code class="docutils literal notranslate"><span class="pre">step</span></code>関数の引数に行動を表す整数を与えることで状態が更新される。</p>
<p><code class="docutils literal notranslate"><span class="pre">step</span></code>関数もまた<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数と同様に<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数を返してくる。ここには<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の時よりも多くの情報が含まれていて、</p>
<ul class="simple">
<li><p><strong>第1要素:</strong> 現在の状態を表すパラメータ (上記の<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>と同様)</p></li>
<li><p><strong>第3要素:</strong> 行動により直接得られた報酬</p></li>
<li><p><strong>第4要素:</strong> エピソードが終了したかどうか (ゲームオーバーになったかどうか)</p></li>
<li><p><strong>第2要素:</strong> 行動を表すパラメータが範囲外に外れたかどうか (今回は使用しない)</p></li>
<li><p><strong>第5要素:</strong> その他の追加情報 (今回は使用しない)</p></li>
</ul>
<p>のような構成となっている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observation:&quot;</span><span class="p">,</span> <span class="n">obsrv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reward:&quot;</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished?:&quot;</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observation: [-0.00080066 -0.23410185  0.03689252  0.3376265 ]
Reward: 1.0
Finished?: False
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3><span class="section-number">2.3.1. </span>ランダムな行動選択<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>これらを用いてランダムに行動選択をし、その時々の状態を画像として格納する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># ゲームループ</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># 現在の画面を画像として保存</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># ランダムに行動選択</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

    <span class="c1"># 状態を更新する</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># もしゲームが終了していたらループを抜ける</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAAJ/1tZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAE
+GWIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+ID9XvlWyqSgZCWiIjzIIyfgWgRUAUQKEL++XDpwzYLO23ANSIuSS40yX94eU3b3HoCQ
fKZIxfzFCTWtRVNIzCYKdiE3gsQUICbD6KyaM2Xg0DR5gW0pZhFlrrD/rU7UfftTuwG4lbdXEV03
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
AAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQA
AAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAA
AAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAA
AAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAA
AQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAAB
AAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABAAAAAAAgAABAAAAAAcc3RzYwAAAAAA
AAABAAAAAQAAACwAAAABAAAAxHN0c3oAAAAAAAAAAAAAACwAAAeuAAAA+QAAAFwAAABeAAAAbQAA
ARkAAADDAAAAfAAAAJQAAAFPAAAAjQAAAHkAAAB8AAABOgAAAKcAAACYAAAAjwAAAgMAAADSAAAA
qAAAAJIAAAHSAAAAoAAAAHsAAACDAAABbgAAAJgAAACGAAAAegAAAbgAAACAAAAAWwAAAJEAAADU
AAAAsAAAAJAAAACIAAABGQAAAOIAAACPAAAAgwAAAL4AAAC0AAAAngAAABRzdGNvAAAAAAAAAAEA
AAAwAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAA
AAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1OC43Ni4xMDA=
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<p>このようにランダムに行動した場合には、途中で棒の傾きが一定以上になってしまい、エピソードが終了していることが分かる。以下では、Q学習によって行動評価関数を最適化し、より長い時間、倒立状態を保てるようにしてみよう。</p>
</section>
<section id="id5">
<h3><span class="section-number">2.3.2. </span>Q学習による行動選択<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>まずはQテーブルを作成するために、4種類のパラメータを離散化しておこう。以下の例では、<strong>速度と各速度の範囲を適当に狭めておき、その上で各パラメータの取り得る範囲を8分割する</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_INPUTS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">N_ACTIONS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
<span class="n">N_DIGITS</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">lower</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span>  <span class="c1"># 速度の範囲を修正</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># 角速度の範囲を修正</span>
</pre></div>
</div>
</div>
</div>
<p>今回の倒立振子の例ではパラメータ4つを8分割しているので、取り得る離散状態の組み合わせは<span class="math notranslate nohighlight">\(8^4 = 4096\)</span>通りである。取り得る行動は左に行くか、右に行くかの2種類であるので、結局、Qテーブルのサイズは<span class="math notranslate nohighlight">\(4096 \times 2\)</span>となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q値テーブルの初期化 (乱数による初期化)</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>8分割されたパラメータの範囲を求めるには<code class="docutils literal notranslate"><span class="pre">np.linspace</span></code>関数が使える。この関数はこれまで第1, 第2引数にスカラー値を入力して使ってきたが、サイズが同じであれば配列を指定することもできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">N_DIGITS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-4.8        -3.4285717  -2.057143   -0.68571424  0.68571424  2.0571427
   3.4285717   4.8       ]
 [-5.         -3.5714285  -2.142857   -0.71428585  0.71428585  2.1428576
   3.5714283   5.        ]
 [-0.41887903 -0.2991993  -0.17951958 -0.05983984  0.05983987  0.1795196
   0.29919934  0.41887903]
 [-1.5707964  -1.1219974  -0.67319846 -0.22439945  0.22439945  0.67319834
   1.1219975   1.5707964 ]]
</pre></div>
</div>
</div>
</div>
<p>今、とある状態変数が与えられた時に、それが4096個の離散状態のどれに対応するのかを定めておく必要がある。</p>
<p>これには、4つあるパラメータのそれぞれが8個の範囲のどれに入るのかを求めて、その値を元に状態を表わす整数を計算する必要がある。</p>
<p>各パラメータが8つの範囲のどれに属するかを求めるには<code class="docutils literal notranslate"><span class="pre">np.digitize</span></code>関数が使える。4つのパラメータのそれぞれについて、リスト内包表記によって所属する範囲のインデックスを求めるとすれば、以下のようなコードになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 4, 4, 4]
</pre></div>
</div>
</div>
</div>
<p>現在は各パラメータの範囲を8つに分割しているので、<code class="docutils literal notranslate"><span class="pre">digits</span></code>には0-7の整数が与えられる。従って、この数字を8進数であると考えて、10進数表記に直せば、各離散状態に対して重複のない整数のインデックスを付与することができる。</p>
<p>このような計算は、単純には以下のようなfor文を用いたコードで実現できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">n</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>もう少しPythonらしい書き方にするのであれば、<code class="docutils literal notranslate"><span class="pre">functools.reduce</span></code>関数を用いて以下のように書くこともできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>これを踏まえて、状態を表わすインデックスを計算するコードを関数化しておく。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="varepsilon-greedyq">
<h3><span class="section-number">2.3.3. </span><span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新<a class="headerlink" href="#varepsilon-greedyq" title="Permalink to this heading">#</a></h3>
<p>ここまでで下準備が整ったので、前回<a class="reference internal" href="reinforcement-learning.html#sec-reinforcement-learning"><span class="std std-ref">強化学習の基礎</span></a>の節で紹介した<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いてQ学習を実行してみる。</p>
<p>Q学習においては、とある状態<span class="math notranslate nohighlight">\(s\)</span>において<strong>何らかの方策</strong>によって行動<span class="math notranslate nohighlight">\(a\)</span>を決定し、行動後の状態<span class="math notranslate nohighlight">\(s'\)</span>を得る。その後、<span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(s'\)</span>の組に基づき、<a class="reference internal" href="#equation-eq-q-update">(2.11)</a>に従ってQテーブルを更新する。</p>
<p>この際、行動<span class="math notranslate nohighlight">\(a\)</span>を決定する際に用いる方策に、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の他、前節で紹介した手法が使える。</p>
<p>Q学習で<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いる場合、多腕バンディット問題の時と同様、適当な<span class="math notranslate nohighlight">\(0 &lt; \varepsilon &lt; 1\)</span>を決めておき、<span class="math notranslate nohighlight">\(\varepsilon\)</span>の確率でランダムな行動を、<span class="math notranslate nohighlight">\(1-\varepsilon\)</span>の確率でQテーブルに基づいた最適な行動を取れば良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに行動する</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 一番価値が高く見積もられている行動をとる</span>
<span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>今回は、以下のハイパーパラメータを用いてQ学習を行う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q学習のハイパーパラメータ</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="n">n_episodes</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
</div>
</div>
<p>また、多腕バンディット問題の時と同様に<span class="math notranslate nohighlight">\(\varepsilon\)</span>の値はエピソードが進むごとに徐々に小さい値になるようにスケジューリングしておく。</p>
<p>以下が、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQ学習のコードの一例である。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">e1</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">e_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_episodes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">e0</span>

<span class="c1"># Q値テーブルの初期化</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>

<span class="k">for</span> <span class="n">epi</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_episodes</span><span class="p">)):</span>
    <span class="c1"># ゲーム環境のリセット</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># エピソード開始</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># 現在の状態に対応する行番号を計算</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># ε-greedy法による行動選択</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

        <span class="c1"># 状態の更新</span>
        <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="c1"># 新たな状態に対する行番号を計算</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># Qテーブルの更新</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>
        <span class="n">best_q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">q0</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">reward</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">best_q1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># epsilonの更新</span>
    <span class="n">epsilon</span> <span class="o">*=</span> <span class="n">e_scale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "67c6bd9fa25f4b34b8fae462dc876309", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p>学習が終了したら、実行フェーズにおいては、常にQテーブルに基づいて最適な行動を取ることとする。</p>
<p>状態の画像を保存しつつ、学習結果に基づいて行動をするコードは以下の通りである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># 最もQ値の高い行動を選択</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAAYxNtZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAF
TmWIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+ID9XvlWyqSgZCWiIjzIIyfgWgRUAUQKEL++XDpwzYLO23ANSIuSS40yX94eU3b3HoCQ
fKZIxfzFCTWtRVNIzCYKdiE3gsQUICbD6KyaM2Xg0DR5gW0pZhFlrrD/rU7UfftTuwG4lbdXEV03
JudLNEHtbrlK0TuAvK9Wt4oM7F6ikolQXQ/gDmhKPJ9ro/ItXXD3umaPK7KV6yke9JchRAFe5vMG
XVIHDmZSjmIlsFyX+k8cfjNbwm7FU6aBXX96eA88iYtBKurbuWAMc2ZMxcRXVh9KlU17YfocYKNx
ohZ8gSRET4t/99BlVT7H9MsgHuTuxBEByS9Segdx+yyiRrGgWisyuYm5/a9EIg2s1BzTpic2y+bv
kaKnzuVGl1VDZYGzVjNEGVpBRzbv+nEVlTQ8k8p3/CaZCDLlMNnmHMEH3+DUT4RxjSkcIA2W4U/C
ueEKmA0D4V8HX6YAAU2yrO47QjkmuAtJKd/GSY5mCE9wecXOOSTl7GsFaCTbxA79b+yufzuJ944J
N+6vuway4UW3IlQTO4ItdiJNWzd6SSDz8qdHChka4LUihG8X7Cg7Ry2UbDaWP6kw7w71P5NNEeNG
i54/eDC5/YQqE6IioJ0cTjwbKvLwe/n1WjrdyQBJB5dYXsUZzWoocMfyOme0qMiK6EZfvn5RgLmn
NZEPskp+1IhWW5/eOlSxRfEytkPqrW9o/3eFQwVJcsb/7sdklmyouZiOnUonWV80tyBM5tw1LQFE
To3yYJLLc9etptkPz72brn1BDwyLWVLkITta44uvqiSz01zDpmptvHkbZ8se6X5uJzU0a4ZkBJ6I
asuOWOB1pYhKA8CAwSpF0lV20yYCs/iBklRQ3wpVqjNhTdhmSNn/+wZj5vlr1ZGE/cFFfB3oshqf
+fFgAADWASMTwYwdQnRaXLiXBuYqUpXp2/z+bn/i2jF3Qj2XNQ+BMNU9ut48NLxXw1HHk0bTzytY
gYr4Y1iPAO4BwWfSIUPVxDleJKytAM6zGU0dwZSW5jQksca6zl8xlbVIdzpU26sWn0LN+GXYz+WZ
A/CjaPy4MlcfngHqQo2utcncMTLT3H8zYwYEyGDmNBGo8dS0EJnewpNYWoAH3/ZiR7CTAD/aXJO/
J1nF1EfCGOwEJn9JMopZYVFpT66E+pP9yGqM5gWdV+n72PqlNMci1XufA0OPlgB9kX1GuSj766ei
HmDGFMAxX6ro0hQ6Tc+F/4SYRV0SrMqnXw3ngSYPkKruzaHDQ3ab9k7Nv2LUpxqkyoPWQ1d+HvLq
SNVPhTeCBaZou3/n5Q2Klq4Oklup+mIMV4lVY2U2KmTV0Ik/cmrG40CSIWT1rW7c5kO/bwdtCvyd
nL8GeND7LsrCp4Z7133E1HvEf6gt20FMuRdtGsWRCF1zrwAWPEXNKHXpUY63pl2KtMEmsdH00Zac
fdxCb9Y6L/jkhsuDOuCZsaCNEPVzugKTLPbQF+/nDDTTaCAUdMv/hwfDgTDDMT35GrxiQxbPDLFf
zNoQAqqydJKDoQNzxVBTLfFNxPu5+HuXQdkAraLWC0SR0J+NOjF4QBHMAAADAAADACjVHStfzUg/
t5sg3FKnHjyBVvZf8rC+cxP1AU1GEdM5rKQ1/MhQpxoBIrv28dHN7oKi8O7wmVlgR16VLf2YcOUj
QPGmZMQIMAgrGYcsF78qfceOm1XAMO4LiDvCqbUAAAMAA7U9AAADAAADAAADAF3BAAABFUGaJGxB
H/61KoAAkPXsDHqADCPlC/PXANkKK9MGfB2LRbQfYZLjfopmyehK6ztxRC0xe6gpGpTyPE5+qBIr
kqkQ4NM9YgiEGZ2zanY60w2kXokEyOjk5iONS8puqpVqhxmEsW0m25ZiwOSGa0Yz0xsjVXrMspJ/
ZBBjhpGLJr8FaTObTb1hlQrnd/jW5/fUDUVKM3sL/hykPxn4wfgYbnG/5Anx312paddvz8VjWoTB
va4z7CjB1gEixfXeIggqKgtPzXw6tBaxgG6Gy2TJdNnhYyAgrY3pYjd78MCyisR8E/lcHuWLCUfv
QhiD9tzqmTFhUYMxKbt+wnPUp173MxVyKpG+Pl9p3w35HzL7bHcabKslysAAAABqQZ5CeId/AAIv
MEXTK6IAWuX2EE/8W7WwZ8ePFzEXZPsNmbvWxDIIXTML+wpjwxKiYHMJRKrPceT7p5zZRx5vpb6P
xAFUF3FLErSCrkwnq87vX0laz+pPSyHpkA36ntm8ZWl9e7nZGcAnYQAAAFYBnmF0Q38AAyLlvPgA
JyPp9ZyN0X41knvzrScwHY2AmaKBIO4LonMfDn82eTBEWpF1xuEP+m4Zs0g+BiLIcEqeTUUHohjg
/1AAkF8W/Y30amzeBFB8wAAAAHMBnmNqQ38AAyNG00j4ACG9kpaxmb8n0ii5m0MgkiEn2c4OnEFl
AVk+xhf2/hDi6O32ZfKVRKXiuG9QJzdjhu4G1iRF/jqhJyiczKwQNoA0VEjSUhTXas/+fgDdLQ5B
cnd14Abm0gG9qb8vSP2bzqTNr4GzAAAA/0GaaEmoQWiZTAgj//61KoAAkGA+hAAIixV6vBgJJSQ1
jiy3S2f7d1ZVo0f1mRK0OxDa3OS2t6emxFXHMlplI0/096f7JuW2BIl9g/3Z5N33X8rogYRsf2tv
3oKo1SqmiPm+MamQPkmRqBPszwUkkQmxYL4TwRli+DBTnz2kQzA0ClQDPA2mwnINzaiIyztoGlXg
Vh+GI3bVEeYFCGI1Ze25txxpFQyZIZrHqhQj5LKSc7Utp+nybNxgy0n6L1hM1aPZgDB2UWd3499a
ERTg0RNMlIY50+/ipxfYaYGUQGyZ+0wtiHW2rnmxWGo0Elp+jQhl07PdzVF6xrO5w8l+DQAAAIxB
noZFESw7/wACMGzHMy0AEOIyi6XWMIl+TvcZAq3qWw86kur9ofwqNI3fDbLryKcevEh+5NCxr63B
d2xZzJ8TiNFO38Sh5CicxmEqNQiecBikCW/BZ8t4t4OmGxugwAsonTPPjnGNXZ/Fe9gbX5QEH2dO
hddMd286E7kHbUPh0DVSkoTG8bQLzsx3QQAAAGkBnqV0Q38AAxs4oT8AGyazxUi/cPDJKO74M1o1
jBf5bM7o2iI4g3/DSrJg47VRy+StFBkBgdeK0Vp9DR8qvZU7hHTIrKJNx5bUnevDmUkhInzFpqbg
iNsqQXIBLFBEQuosZgqaFXT48U0AAABxAZ6nakN/AAMjl17nACD4XY0IUELiMG0G66+h233hVZHD
KkHiGy3iFwe7bTa2QbDTa/1KuPgsveBq5IwdYvnJFDWGyQ/JD2KgokWZnVcc2oGe1XafrHgBugxJ
t0s/HDbjKM9/KL1iDpfOkSiIXDadivgAAAFjQZqsSahBbJlMCCP//rUqgACQGLbJ+tdYAhttBZyv
uzNmdt2ifuHhFfVxKiWph4jhLQUstcjw0NYxdBjU+JcxuVmpZFFvbn9pk/2vTeFt+eFrdFUjAw0K
qaIRYOXohLGqahASxbzwP02FYSapYNwxZg2mMqvYvAbjwTn1YNYz01YYlPaEUabqNdfvFJAaoGCX
y2CRypMab1XnZelNzvb1DO0RsuDcabwPwri3YiJJSs+qP1Dg9Z4XvSCOEx8WzGAEiofv5gQGOxru
IgVgkvbcwYcjY+lYLbs5477psTKGl4NklFd15hr4RNY5PiUUk20jZREj+wpBHbX0blnWgrgYUpoi
IA6MN/F1tl7qaUyiQDOlQLCg1uXwJtaX1oqxK5lE433EWbEWVkDKeaurqTjT3duhUBKIVXvruvTU
7oJzR/ImXSS06KlkDLTbOvwcY8G3KMUT0l4rZc3mSRzAHObiEDEVEAAAAGVBnspFFSw7/wACMOOg
z/+RwnAALW8Mm4oQ5rdPVWKG8VhWFdkgnzFTBDNfmJgS9HeyfjHzGH3eXksQ7KQmiH5K635O8wbc
OzZtF1SMe0rk3fAswZyNCs65rpdJlZUS1BH7/cQ7oQAAAF4Bnul0Q38AAyPUGkaBaHYkAHw7d1Om
/VkWVeH73vrD2Vj7P8ELdY/xu/w3T6oGFOq8uDgY+VvF6yoeYYBGPV1dsTk9dNT0G/9BrlDxklXH
8WUnxfg+BgTcAVgrMwGFAAAAYgGe62pDfwADCcN/0g8gBLcCZtgHsuxSHQuZoQ9YmI88k/9EUZIZ
J5wckcF5pHe0njYVkIyGi8Nd49NlhS8HsgcoJ+AMyK2h+dZEJFcLUgGFetzosEcgHoeKGUkeHCwu
KMWAAAABXkGa8EmoQWyZTAgj//61KoAAjGSlUlsAHCPogEiZx7qZD6MZkkdKGRjz87d8c/W9QQlV
JxEuDRRi1Y7ltacS/6m4Jj/HqRBa6KgisD2p8uGxPI3q3R0PGCfAR2qhLmAFJ9EpzARx7FvgoRam
IV9yWEbest2YAkkmm4mHibsmZfDFXyewBbfswh776/ddM9sYY3Vc6M9TQtdp1ODmg0G5QFbMoA1R
a6+q/WEvGOeIYz6ov227a0dIn8y34BGWp+iIyO9U0JRWrobuEQ8XyqMWz78uUDqAPw/CTGwKtglC
LSaVEVy9viMIWLtinMKMTgzSEKrjb3ivgjhbFkBPp+TRqf/2ueohouulljRIGxIxyz0m54qCF64w
E4V9Tz2rR6etdqaJyaWviZPiPkV4ADZ0CBYnDZxdwMQTCo5+tfqV71vmrqoeeYTGY3RIYqiLJBBQ
LGfy6JJPQ+6SuM0u49Y1AAAAgUGfDkUVLDv/AAIbfn/CvprOkAJcsSVwFs2kWLnCWYzGDB0YLC7t
HiId6uzF3KbNydVDrlwoRUdWadec0fmDR52je+eNsmgbOQjz6OPAW32oLkYgE+VbhZNeF/15RaIr
HRfi7yUPmRC4hDSAD038xJICZFWf6VdV6vTxmYQjOqROwQAAAHUBny10Q38AAwh1/Xobd2AATkd/
jyBqADneur0Cnbd+rZX4F6tstDLDZzRj+homOsJvx0HWoc/KeXWzwEVmq6wP4zYjVLPVyppcf25t
MXq+nFRR0QLlRtuvI3DFxLN3bLJLiISKhx4nkX1U8CI94VJ9j03/FNEAAABfAZ8vakN/AAMPOVhp
HkAJbPO6G3+7S5UdO6clepygmGpKYywdtNK50yGoD6bxmlnZmKnZ84k07KUw/SX78jWtusj0GqHc
epcmnqmLD/vzhqBEBcS9xo7iOvRBk/PTAbUAAADzQZsySahBbJlMFEwR//61KoAAjKd1gF2ADoVN
waNBsXg5a/WU5+7RWM5dynycpIIKoPbelWI474y61XuhC4s6PP7ahizJjallf8YgQYWvwDkhHpkM
e+go8149AasYjwB4SVWCSx/7vgFh8awu9l+n1KaVPKsVVqofNzbhIY5E4wTiQZth1i/ImJReztJQ
7ynWISbVcYgBsyqEeDmfB4YJod3fq7DySPGRF9DGX44mvL3URP8LaqmmzyhqvYAQqTl+DGkdHKY4
CTY2C/LjpUU/wke9/FLSZ8MdyMGVqyEFSfH7OuzCR+7WCHnYOMU6nJqGmKegAAAAVwGfUWpDfwAD
CQ/++Nd3oACbBuiRt6uFEMSfjcY63C4lSII/ogUV/DNYMP36SpEr7QYeu4uQNzkL80koyKyjR0QM
7iuwt+JR3AAbQsKncPRaR2PBrxRdwQAAAY1Bm1ZJ4QpSZTAgj//+tSqAAJChIdxWAK6sWte/RwfZ
dH81SWY5Cv/4emAtmtSFkKZ6dQuzyOrF0UbZJ+ZLjM06fCcnd8TWlDo44jm0ISWjNs4HARQ5h7Bn
Cc81Llbe49k3bqHQjbGmlKQ5jKpe8+LO999BAT7Wx0cTNTlawjb8YTviQ64vYA+Wt3Wm0zvItZQi
AXiOYJogAvLmIs+l7uslA30L8BAA4knzv3rbxmRVdwoeTkIe68H+WiDM3MGTFAoFm0V0FfVj7+EJ
0nQLq1YYPs+ECQCD6FXia1GQHN3tWamO/gI/k4f19R6LqLbKMpLCSvBvoXba8zd91xoD1mX4uM6c
yAq21JVAO/OXmfxwktJ2amwZQyQ8VC7Zl+yuI2FbwBKpolmqBK2dat/OVOm4T+Im6CGdVjn9plFs
lF6WtbAZ2GBZOzzNVDGwuzW0OrcqagkXsdr3MqPs5x5wemP4VWSxE2RpQetP4iF24igM5tg+Z/Zl
EJl7lDa82HeYTfO4tyQu1UtCLhx/7YuIAAAAiUGfdEU0TDv/AAIv/lEM//I4TgAE0UmuOHW1hxDb
dwfuMTdwIPw8T0KR6eLRWLz46w8k/Q0rrGCtC1RXVUldcwlQujsaiGyQcaa8ur7vg+palRr/bFrT
QZ9GiRk7pJTDWaYalfTVYLg0whLyjqz/Wc9aBXkzrriUhW7lFlfSZ23mEK515BjlaBE7AAAAWAGf
k3RDfwADI9UuI3JACYTeEzOzPtLZJkzf+ff8Fr3DF388MQK61w81IRejBSup8ZS9ysISTAM74dka
9a8ykg416C7c19ki8ump8hAG8MIRLGNUOplyjPkAAABjAZ+VakN/AAMFjeLrmnGVwAkrY4avWJtb
A9fdo3BazlEzHVlxmmnAr6IEttx2vv41pcqqw2AMMvMf3cmxm6BQQN7CiXA/MHpXEsa0rpxRenSC
dr4iw1KWmXrHDG77adtob444AAABDkGbmkmoQWiZTAgj//61KoAAjPM37TWPV6gA4la9JRzx+JhT
m9dE7/dItP+7K2Zs+GqWUO9jAUTkILeUNsI4VD/nKk4CTiLFC/hPKiY0/tRY7jpdtVJWQw94ZAei
dpB8AUI/7vpimpUOPtNk+GgQ4UoTouiNgMbPvb5B24p+WF3nEd3UJk9izilUsLoPDidSN34xEYj/
mSywPNisyd7ofzHfTakIcdxKYf0Z/EpIjyxeTsMBdcjYHD44QiwsXHTzxOMzQ7/kvrUHX82h/xBs
LpgLJU1RgcgvzLIaVXLIm8kYFDd2pXGrRehyx2KefVukx5uqeaPqw78rDji93FHuncpjfB4FaXTk
MqxJL9bkgQAAAIFBn7hFESw7/wACMUo9uf4V9NfGgBLliSuAtm0ixc4SzGYwYOjCKNgM8RKi+SGB
S4jNvJNtbW9p1Oj5cDYlWJZKormr1gzoGEgtR4ahAqUu3aO+hc8xRSIEVab2SkVyRCPcmtxSCY4U
lu3MMbguZar688s03+G6Q2LkTY6c868IB/kAAABqAZ/XdEN/AAMIdf16G3dgAE5Hf48gagA53rq9
Ap23fq2V+BerawJyOXiWTO28gb00IUNUOkc9oo54CKzVdYF8ZlufvXE9QzM0IJrFBhdpxqUtXud8
hJjvFYKnHPc3XMvU90tg6/X594DagAAAAFwBn9lqQ38AAw85WGkeQAls87obdWQ58Oa7jJikg6Pv
2Rg7UyOeZ8ULbFJzos8Kt+g+YJv2qgiKruvD/rI1XLYiNSiSjeIo4zEdzq7wAJrrxhm2vBILxeDk
cTOidwAAAaNBm95JqEFsmUwII//+tSqAAJAYnTzroARaUacDXj2m3IGoWqyEAVvVF/BJAkqOsJ9H
JpsvoBPJpadyzWfWv5pI+uRqv3pmnley4vrQ7IUG+MCY7232ZULF4yX4WCsatO5eFiQXRjLQ4N7/
y+vpzV0k8LZM3VHjj3m8sAoZKSWcTmeBy9sKFSTPtXfbYgnsu/mNbAWV679MvOHrSey0R8iVGXtY
OPKrYuLVYBUogMrkTD30CT5EIk3MRUD1obdFt+SET/T1RUE8oOrnpFLNL2XjWY76oEqSKAZzb9W0
GovjXSbE361/G0qboncTwJ/aFudkfW93neERbdAriVVQeMFOguRbWgH6Iyv9MffCyPtxGqaarn5g
0yNRoTkquDB26r8L2kM2PoqfYmGUnk+/MKHuE7FfbJtRhcY8Vp/krqD2F6CZJydB+5uVS4LXoPQK
LWP3WALeZJ0IWxxCtabZ8zxAoTpiscf91w83rJI5kPQkiOE2YIq/U8+06HgKmhtoe5+H+VA66ils
Gr9Nf47APbH6A8/RdQlXJTdzkxwcBajZmT063gAAAKBBn/xFFSw7/wACMUpmbhKg4APimuhYNmF2
+pz+S+NEBp+Qp5RRheVsL8dKgK4Dlt+P3lbNNA/7KHpmW9fWNf0Mad7kyL67M/R5jz377FIYBLno
WReUjp8PI6PS/MR84yVY/fkC4WBLuaTYc4mIM+9t0W6ftzj6o21XhAzmeGHWV3D0qqqmhHJA7o66
vzApgC3oom7yOb8lTiC33tz/KxMxAAAAbwGeG3RDfwADBhC76R1ZACVqhldHraRnIh/U6Roapkcj
DcVq0nPKgq9Tqr+8lNTSY8pj4Rek/PNxOJqWkxU+utQwG5Cn9B6Jc5bt/U74XuBZmY4hPf5d94Rk
9kgR3IEw6QYQUxApOzm0zfi03NAH+QAAAG8Bnh1qQ38AAyQAxfrkAH5x4veEKbEtjg/UldzuqrbT
Z0lR+X0DGqrRh0Bq48SdpBYwIJiZdCyzQjQTuNLno5M3VAB3wq0QOudgr3xYZkJZ/Hz1H02myI9L
LBB2Qw1pFBxfESAwa2ZdDsDTYZQdAP8AAADaQZoCSahBbJlMCCP//rUqgACM8zfsLKJsqgAOhZkB
7EX9t7MhgMXNAz9DXIXcpPb9JmN3BLwyEXQg7fTg1sK8PSXmR/JkiXMEClu3W/R2axuLQNG98OJg
cIfM4lbh3nswu9ESz6URJWfZ/eHfXAo9wAH6Rjyce4BOPyL2QQ/p4Tt2ODF0D2j5gl1HXyQx9XJh
7cIgEAPWgSEFHTMe1YMSrkLS/rH1kU6CrSL2NrKu07rCNBPsImCdM3iWBUZ0CPVUyo/Dk4X7vpeR
6NA8oFFI6WgK02+f74wqROwAAABvQZ4gRRUsO/8AAiBllG/xSUAHaRFx61+88/lq14KpJAx/AaVq
TPyqGjBguMd4vOzwnMc6URMzpmMNUHpgwlmpr0krBuEUP+xhVIbo6rnNH8RoYokLeqwjEMptrl8R
466LPx2/o4+UGsvH26tSE4H/AAAAXgGeX3RDfwADBgB6z/pB5ACW4E91JTalbhGHQrgrIH/uQQ0s
ZmqJxEIoJXVGQJUKPZ6j1uzYqH9wywzNZFV1I7IJMZ7TLL46vZFHR5pAbUYNgAjtejIHXVB+7ujz
8ccAAACOAZ5BakN/AAMIdf16G3dgAE5Hf48gagA53rq9Ap23fq2V+BerawJyOXiWTQJwTYoWX5Vm
NhwVEHbVH375xXjwGlKhqFZVvXTPFZTd3eIrQ1wMIyOXBriTkw0Q+DnJ/MtYcdnBI4dbOo4QfZK6
jpOctFUAWMoKs9pvpQgA89B/Kwh40OD/5NmoSK4ifCKM+QAAANlBmkZJqEFsmUwII//+tSqAAIzH
N6y9AA6FUW6WaYBfaUV4LM7XC/Ef1pYXd1aNE0lnuXbslBQKqxy3DOGzykIbteubbYUsZ/SMIqVX
vWu10qQZhkr6y09AuQpT2YOkc993w8k9bGcFw1x63uDIB6XTz1MVD1d3YwOOFWqxWywpr2wWAr5Z
c+XmXMHIv5SKVMKAGv30+64HK1W9Uf6j4KjijeQPu89q2QPA9/bjUrxFfArB8T8ynDPh0Dmdkg5z
nR3WlZnd0u0dhGoTlquvw0VF4nSD5zi2MxswAAAAaUGeZEUVLDv/AAIbfn27WPYNAB8VHzMItyPM
Qa+HCaOPIDwwUpj2kdVwaPjV8nu4doN/eNrG9+KpFB3Y60BXMZA0rcLmCtXzlX86fRVF0bh8ZIir
FEbVIOCSkUfGUpiGUPGR7ZTSyh2A/wAAAHwBnoN0Q38AAxB73uQAlyh7cjld1bxP+l1yly0xyLhS
fzbWQ1LP/BK57Erdyk6MBuc+Ly8FOw4EaQBlJvtTgnmMZc5RQq5IiuA3JvyrCQojtES7tcZ2jFbx
EvfMjTGKJ1zMY0WlQYbgQMSefW2N3ISzCbu2T/fGYdKxKLuBAAAAUQGehWpDfwADDSvx5/QAEmR4
aEqAnhKizcUFihmoCSEN3TSRVmxUp+QStFsAPuqNYRjErs9TSuQOPTM+cTZVx+alJdrZqw5L0NTP
xIAAAAMBLwAAAdhBmopJqEFsmUwII//+tSqAAJAZ9+BniWgA4SjpxUmfbInK0zHG+L6GWKkHlVqc
GSKs73AwXOp99yYadJhMeaMAo/ozvtspp0jXO7j87cgz7C7QOjOSsYWqxtOUVuZK2JDwQLkvPLVF
BmjQGefiQryOdojWFPg3KtCPD9/2yAjUxu/+aRlXfA9kssexdZI7F6CFa28ZIO0ge656Kj4tipYp
yGjMG/9Y8FI6j2+uL/Lx+QOCY6YOtT48XaVY86eHbXa7Gp0P9MVRDJU/qCKnBFYdqWM/zJkZ/HGG
c9bqoBMowIQPIeP0AmBxRpp8WouWNNiFNP+gyCUjPWCivf8k8a7658TxT84oE2vZYh7OrtH9Cit+
GTiILRHiLeMek6qwSlTby0gp0xdUo322/+i7uEX4jizvDs0crAbpWnvdJgV2zA4Ae0HflHHOvpky
LI4DmadpWZIa6DwBv94Ia3iE06hktAIR/KUbjEMGjOG2Pliv30q6dJ0qZ//9/5nVU+pmV6ptdImb
YgGB+5NnBRICUVCAatRM+482DG+K9ZuvZr2PzcwCt6/AMav/rjde1R/7XZiar4za9BZRm76yNc+U
LbhKtev8ccfG/xzkk5phUMCmPgm9KrTKG3MZAAAAiUGeqEUVLDv/AAIw46DPsrCsCcAAmikysMZD
iLcuzGsb17Io/AO4uLevwzz3yMVg9OE5+lTWDZkMJPqb2TR16EonZ8ebftQHLTFniogEPeh9HV/e
qBdE9YoBDo7v+6KYRqNQhXzGGGIi5Ncml21V0DEJ1wBNqq9Wu/rg339aRwNMF+z6x8/iigH+AAAA
egGex3RDfwADI9U4dRaABLjBfwjq8ajO1erpdi4d3Zi3PXwUJx2kJQt2aAzUks95/niCwQlupE+B
8eXIGjHJjSH2LDj/Ed7PgtdgSgbksbe18gYhi7BKZcFRRxzaVFld0c2iiyqo2kqpm3Avm6DeroWA
LboPKoeE5F3AAAAAZwGeyWpDfwADD5RwlrxACQp28MbV9w2USPS9ghvrxkc70rz4gh+sj1ySdsau
qC+pquEYEtZZOm2+WlKC0/uaB8qQnSnCMrLCYMDGt+rjXcraJ+b/L46Dl9VZGw1kedP72lywKKIC
oxcAAADdQZrMSahBbJlMFEwR//61KoAAjLNIYsvQAQmBhsdjF39R/Yvk0470LP/UhFr0tEy0nZRv
IhAGxd5KetYO1Rj1//M9TZuC/KebEAm6pXyv3fDyVo68qxq/6PsiLbR6sPcWSkM9A29iSUsywd20
Ju91X7m8tpyFOf57ZbZGQvGSEdiRn5mF93PwI75DZR6UE6XM5WWnWgrgZ8W+2hFvZA/MeAOidrtG
E18f+OqvUo+rZf4Q6Tr37g9kL7+RYRGaOE4PkFHoRHXypmWV8+XJXdme+/h9IbHD9Wm3IyCRIQsA
AAB3AZ7rakN/AAMIdf16G3dgAE5Ha94s8QMN3HkBy+v3qpyMGqr/UWqoTBurDfve4slYvDvxtFxU
on92lWkes5l0xuUhsIhE7RoNNNSV3eIrQuNt4/WdXyoGdtkddbwfE8uZrEtaG3cSAzDBNI9nOaNz
Dvr6V82EBbQAAAFUQZrvSeEKUmUwII///rUqgACMPwlirABnHWLiiQLyRa5mxwb8L+TCLDCY/0L1
uoIOshT9HgoXBKUQVA8MM7245ZUr+M4MD1EkjKmCUHb7sri1MVwj37vh52Cg/JQLfpq8JMxZ2hf5
xXQ2FFwEaCSJLY/uZnc/842edwl+gIT5rRgcLIC93S9LQFj6C2pRw/EzPOryee4ibCeS1F3LP54w
EM0f+XHv9j/PVIOCJaABSY+Mp8NOdjrw5yeQpfjIYnwEbMOPoR/JK1EsL9DP8rG13EPm8kwyMN8o
qJlOvpPZ25TnSliF2QUTWrayIYaKlqbO2GmaH+v5ZIxiDGABR5rEQQLOjwlxnFgLSVfpTzyvNpKn
PCEaWl5YOr52TZSyF3X3fXVGkeG4KKQqOai6+b+YShGgZG3Wl9+aBbGuXlUD4OfHGR6VQXUpVopc
0kqjIaDwLQoxQQAAAIZBnw1FNEw3/wADCy5hpPJpIAS1qjMXH1udZ1ttfw23ogzQhRcpYp7OjKJV
us+tvIAHMHolzJK3CoyGXTMrMZrKWzm+hwvglFYsq80dMEC/JS5kDyHd9ZxZpSj/cRl9/CnIH4Ac
R0vraF3AMITf/3TqcAXCNCyn1IAiizHrpKQCcB/zne4D/QAAAHkBny5qQ38AAwh1/7ax7iAAJonD
8mC3D2xzH7RF1JG9l/D/S76svh/EcWGl0lk9os65yb4scjKTo7c+CmtgbxRq2Vuw9QVo+Oq+aJ9D
plZMLnb+7Su6qXj6Gz62S136tGDx62RlTSTtPIa5s70aBI+bMzWX/RGZAH+BAAABkEGbM0moQWiZ
TAgj//61KoAAkBf329BQ+wA4S1ZYqRz7vUj6ht+p4g8QnrgffPdLUj5ee7+ujooes8UfDNHTxPHx
+yu4DlKEULk9K5rK+IkJRvsmUi+enhMGn0uLGn7uhHKV1152HjcGWZtfosF44tqgVNGz+vso2zXk
GnGB+4MiBJ9lmXC2KqVbf+2P8luIj/mj+Au0eRnqDRBqOZdJW0AcAtM4cP0ya93QmppDT/Izo1Wr
9cRcSTYvVc9RQIzXWVSaJW6kJhJWUIKHfGK3LViuwJMHFWunVSqH0uj3U1HRvh0pLa8/1C23RSyO
85Mf47Kx1gLn448vh9UZ9WGK+Cc+iCep7klfx9g63gr+8JdwCvz2IeLoVY9GKwKDDvNX0RMbEThk
BwrlsKPNVpLvjQNoTc6/mTCzYBI2BuQtnONwPifEl/oiRu9XYNRgxnuwiXfLNc8UkbyypffF+umO
4tNM82WA0cQuR7aVQtxhw0v9jDT+bAmuW8TC2PL9j2ha7VkZNMMRCqvh86y4zeCi8XcAAACIQZ9R
RREsO/8AAjDj1T4K1JJIAPhzR0UZt203dV5gGUDtPkQME8co1/gOyrn1v7XwsgRGd6uOmBDliIIH
FM3cT5sTHHtnkxQRUQCFKqNDwvXLkj0lqgRjZAyqAiaemAH/3EIWQ30zkSxtk+GFfqODbNobIc+a
GjcebUGhkcbXOXpRO/KPFQCbgAAAAGoBn3B0Q38AAySDMMPck8AAnaFfZPn/sDtnbyzxn7lVW1/y
7B48/HSffoHySwUHza4u6kY0yVe4CeekdYBvx961RE/YqZkVQJe116KiABPyjZTtqbnXEacMW76B
Xhnd+gUD9/RyyXYTQEXBAAAAZgGfcmpDfwADDNQ5hCL6d0ACWzSHkqjGYBNY8Hwt3O53KLQhjMxl
r+cQgWmgcYr5gBYMlhBDOq4pXdd/LIQQrDnibelflzAE+JaKwRfJn26iiZk5wte0Q8e1mSrePCvk
w58bJACtgAAAAT1Bm3dJqEFsmUwII//+tSqAAIxDdVIbWADnwoN+ZK9n2Ntp5b3OC0YRMONhNJeL
wafQAWTdG2twXXX7srNR5GPZPPdvI0yDlPDKerURyz+vomWPdUP7pmQRSBmEtl0XVBl/fnjfBoLH
Vj3R07/WA7SXK1b6RPRTBY7FdL3A1Hyi6YRwHhceTOByAV+7ImsJCVna9aYE68RmEoPvnryHeWe0
yY7i6JsyiD5UgvaGiGfaW8OYAhE6IC217ZD9ztBYxQ1k0DF1eUSmDLK54DdQoZM+7jbABHwRDgVn
sYLfG4hGwAwau5oMlsyTi6He9pSLy6plACoG9iyPiDuU0+Ibj0AIP/ReE8bPKaLZQQbjSSQ1tgt6
TvrlWcF+Nro7tyBN+fUsBXFgvJBZm/MrD7IsQybP2xqDlvC2j3fI0WRimgAAAHpBn5VFFSw7/wAC
IB/XNnNEbACEEooablR3QQU0MAoiTcwxvRC/fNwXAO7FU51QPqr5TpJEKDn5bKFsC8oyOxGu6v56
YaRMWwfPXJzYd36r7smR+ar+bBuiUPVgmItEU/9qlTkBDZc+JFQdQYgqQ5LCtETshhw6IlgUkQAA
AGABn7R0Q38AAw89nWdAAmO+g2SmOStJ7ovdd0qStAb1nx2H8KmQ9yoQXPSujPnqlhZMZrryeToS
z4C9OfIzVTYqQ5UG/skRXNDZ1SlRE2LM92BwuwgKWEECE/dIF77MA/wAAACAAZ+2akN/AAMP7PNI
APilG9JGGsH9qmCxxnJByR6U5Ul5gDBPzpovTuKZS3p0D6kTrmvIQcjGI/Yi5GwxXDyZqQm3u/Xd
4jtx3qjlhSOiXjq9K0A8hzM9AF2PYeBZ2X0tu5j7MSsr9GOmNS0C44DmXbdMEe06+XNh2HvsYP81
AP8AAAGiQZu7SahBbJlMCCP//rUqgACQg03CAAtO1i3/eNwg92lXWBsIhvx20ddDo1jZuguXW+sC
nGn7f3NMQxxdLbq2enS06LGrRpzhSFCiUGhc9jKgtf2H22XbTBCiLsp7qVv3/YSN+TsWbpkGWDUy
7IYJSXIQSHpMKW9TSg5KL69Pqm9D3cZ/Kq/E8YMmopJ0BZrxSlUqwyqYKCebAVROspw0pQ0OqCM8
yjLrvp4S12mtiv80DtoqDSpUasOPTLe2gcYvhYyxmC2YubL+ychctrVgddu1W1jeDZoDuibiN8Sr
l4klN+w3unn4DVhuP5+eBeRIeJNvsXoJZvHPFn/tw/WvWBl3hypxu5d7KIYoFuGTH19oHeFbyf8A
bx3T7dTzRu2FKOvgQa8OQK+w887Nhp1vavmdtn74lLhxBIlnVHfHddJCAQUi5wHQUkcdn5c1C7rW
hPht9YgmSYfaYWKb67NYMv6BjgLyHICFVtrKb9x5ZwBsJUEyGUzp+HgCinTaQ/ZJGGzDWWfOl11Y
iT53GZ+W2KOnKdGm417eF0NOK1eRE/PcbQAAALxBn9lFFSw7/wACMR/B9A7gA9tIRjvl8lzDpzH1
deGdMsqVlkFm8V5n4mzjjM50MldjujMrGY1jwWc6si1d8YC0icW73h+DZzikI/YvAh6uSrAPRUQf
ziZ/Wl/O78/FV3UDDF2wI6z9dnxrJxpLDNcK/ZSQtfueOexlpCt/lu95pLLTGBzUq1iWKOfX1XTi
GGTx4SmPlwv6GuhLr5qs6zWhNS/F2pvM2/xX4dyV0P/fkBsXRO+9nbTQmAwf4AAAAJQBn/h0Q38A
Awh1/7ax7iAAJonD8mC3D2xzABRF1JG9nLhtG9hV18P4jiwluksatFnXOTe/jm7wWvcAt5kcSM2r
R2tbKkx6z23x/2daOTBrtvxhMURBlY+dBlbK7Kc+AM03cGJ9UIB0WjQGVqPGF3qUG+lmC17HEsx2
FCUaaZ9lSuRf7LjVQ9Yar0QIIrcdGQ9DghHHAAAAjgGf+mpDfwADJFwpytyeAASwsJeMjddysGV/
bYTJI9Ogzyy/u4w5FrNRiP8jtMwoZxs70bfCV3a/bD6seKtd+N3mamzEg+CAg+cMYYuwzKPWdDIn
1QhgOYH8jHfJSKCzptFVnomABpeMsytXiSKKln/wA5axAS8PW+ICOPWPLT/3lJCfQlbR+5d1GFuw
fMAAAAFeQZv/SahBbJlMCCP//rUqgACMF3lC76nU5SAAyoaTezfet5BhjsuV0lFSPaNRrN2ca/kT
K+d2dS9gRt//2PTOE2Hek7CCesqwiVRPhKXX67PlufIbrc4A99eITl0MNKmp57PomK85BE5YKeJ9
6P3AtvElVtHhH90LWWXpyvWtdTre4qtwgAG4oTPrAh8TXr1JgBKrtzHV3d1+bYsXlwVaj0cpQ0hJ
BluJ21AhpjgBoQrX1YoXGpLqD4Pk7RIhtB/CxfofzxBtauuQNCOhU4aPnCWorqzf4D6xGru5wUZF
M/HaItMMhSwzz1tOhD6erWKWXJGKumqnhREIx4IbtvWogctnL/ouKd09Ned9a2SgR6Sk9vv+wSQ9
/eXhKUaJ+PFrSQWConKv6e3NThc1mdkv/NlBuqIhBobCCSp0KJf1XFtnBybrkkmrmLafQVjQ0DKT
0pNjn93BKIfcXaHQXIEAAADEQZ4dRRUsO/8AAhl9Jtl2KPku0oASUH7OADVni9YvCtNuZyIKZdCA
OefWKtJxF9Mxc0OYFCZq+e/5PpVQz6h/+4lcqO528ClI6OflinTdfUvUK/hzofUiaUBy/VTXkNGj
ZBrQbXEYiBpi1zWeorHlPxjBohpOPPNSu2Iaqwvyq/hwAs4GXav0EQE4Upui9KchZHIG0dCtqgxW
uSVFjpB3z2eBMo3hCavMlewHF16aa/mQZJURLTzF9b5HZKtwdWXxcGw3oQAAAH4Bnjx0Q38AAw3o
c6reR2rgBJ9jB7QivArLOXe7m/pX41OIHEqNpcZa/nETfRd4eyLap8PdQDcw/EBcSC760jok9brq
ikiO3Xxjrru+Byh7+Tvky8GlSW+ZeCIdEVialOS5uIodCK1uhFH5l33YFrCSE1UL3npGNlbadTT7
wb0AAACJAZ4+akN/AAMPNg1b8AAlDyx7tIxdxE4kNYI0GGq+aJe8iRtWsi1NlWna81fa5t4En5QP
rzDjKHFiKkFIAVwfWOwDTL6naS8kDTGnN4LhmvsFXHpax/8pvjb7IMttaLJjxl7wd0+gemKc+tbB
u3zSdFzxLbOMdNycpcjRdx+4w6ZIik3euH/0HzAAAAEXQZojSahBbJlMCCP//rUqgACM30pqAAUb
9/TseW30nnUIN/+QvM1OnmcZAqB7UzUcE5NDXtcFEqv1bbvjLurfaVLoCfd37mvrb0sQUMHUTXAe
7GVFnguzkV+uGc6tUb7vh7/kCXkbuSG/0eI8b3xsae93XFldKTB4eTifBlw1NFd9cDYBlGNEArvY
3hQqeOmqv7oUCUl43xz6Wo2fL7KF/Ubft9M5Dov2MyowGBddrk/uH2kEVj12ewc7rEsXw3oZGNiw
93WUp+pjnp0TVM7V6x0nOOEEvnYn1qd4pU8YPZdYC7Y7zU58YKh8JjqQKZElfMLomnOUJZ/mDQo9
gVe9CLkQ5h7U4A7Ww6HiQ4mvLQnFI2YCoVo9AAAAe0GeQUUVLDv/AAIc0qVyXFQAP9CAf5XaAqfP
uQg6y1KgJuqFES3kL7Q/Z5bmc6uvevRhkApf1MpgLOyS/kgaWeJl4l5X5mfUHsYlYPQ6/gfoB5D9
Io/AxI100OLpYD0gxvJazXgYtodkc4x2OjX11X+JZjEoivMaJVlB8wAAAIABnmB0Q38AAw/JKyQA
lyh/rMBMlf3k/EpPmXFxwY34A0IFKa/e6sACdDaT6IMoUNVgjbIBCqgbdOYURUDLDoyAuyRHbeOV
YIa5eeCAu9yyKK0o95N6jXWAF5kl4X7gqkhGlKmLocmy+fbYXshQnrfhzix28et+FsNP5jVFyOwD
5wAAAIcBnmJqQ38AAwh1/7ax7iAAJonD8mC3D2xzABRF1JG9nLjYfYVZfD+I4sNLpLJ7RZ1zk3v4
5u8Fr3ALeZHEjNq0XMeer6GxKcrYW0etC4cAwZA0wFCZJWrbksU3JX2lX4CeRqjlxLlvwlpjaqcV
vBbJqpXyJ8CGc9oySlh32VRF8bBezj6kTMAAAAFkQZpnSahBbJlMCCP//rUqgACQgordQAFp2sXF
TCw0HwSXX0Ng/XEHvfPL4H0tf2CHowrXs0GHIm+LQyfRAPbHEZe72uAvH7bcU16Hd2rJ8N8RXdHF
kPUbs4werWYhOREAPnR7+7msc3eJnDzNgNbT2Xr9CSuziiS3UoB+UMYa7GBdXON3Xub//NIESDsr
SLcRRTdqlyuG8RdF4Ng8bvZWhPfS+nD8BRk1niy4xZF9RM+dejzq5Ia9xXRUyMfCNyVEPCGQd1q7
pr/9+K6v4fwJd6LvwB3x0jMaA8KzUcIBWnY51/apTAihFYj6/tJcPFhFIu6P1Cqcy7RBoXOd1yUV
2ag1zFxPApgH0eKRICCNx3nTQ0p2Z3xYqQ/GDRKYwyDQMypkknnXooRF+tXPW6unvsf/dGSFfDuF
i3QwH1W/fJvtNyW8P72M2nHM3vibbINYDz8W6wj/3US6A56u+VOBY2gmx3UAAACKQZ6FRRUsO/8A
Ai/+ZKOgAl2e7iHPs2SLDvfEaG0iK7TvUB1pR9k1XcuDyv+ICzbHbqYt955uxynINkUdVK1MmUfj
4pXit2fY2tMlYfc/1Bm+ZneNY4pW3RU2BvPkVZaAdafYDNrjHeWC5BDeWZn6kzB+25gAIg1xbqFY
VTruNaHZ8Jl34V8R2KqBAAAApgGepHRDfwADJIMww+pS6gA9/hrk+f+wO2hrglI2tNcKgYK5tG1+
0fSIAOqoQAu5UwKa8BVcrBL7K1dRn6+IoWtNAHhf1DB+5sOkV++bFkHhC3sHVlbnwskkSbDIM/N5
zQNnxHzqRxtJAwJ4yiFJ+MvrYkvOY5+rKrW+TuaYeLVjMmMLL9GFuytu5BWYdLpe9umpKoiiLJtZ
VdWHJPkUZ6B/HHPKRM0AAACFAZ6makN/AAMN1DnVbyO1cAJPsYPJVGLCkw/BukOkCW1iG4N/bS4y
1/OIm+i91RqlK7KlMvm3g0WE8VPqpA6QKOtIaSO170gXaNwK2l2r1AW8ygpXBzXv2u5VYvhNjIjb
JoGlZajTbTFzrJoomb+JomUwZh7H4UA7VjHIOcK2lcBUDmAfMQAAAPRBmqtJqEFsmUwII//+tSqA
AIxDo6L/MAAwzjQJt9fva8RB7blhpLENWNS85UVtgnDwF5xfGyMOAT0uEemJG2EfEASfLyVOPP9B
+5eUGhgJXV7If3f79v+A0uRUJWJnOWZEkFPT3/EUZwH3CUlojoH76448BO3xwcVJrr+9KL6+tsDp
DRtkR23/tvJix9rIiSPcoWM5Zc8/liUBu/DucORTVqHGFHoIIoTGFHNygMxjRXjt5n/8XP1J/oeI
/dVFTkxP11r/yNsjh9sV+4lbiAoKcLSQE0SVTTCwbNFQWM+OE0z3Dz4rdxvbOLzm20ZjV3hWHYDX
AAAAkUGeyUUVLDv/AAIxSimE4zi+jlEegAhv6FVvdddyHjAZ+jwQ+noIJkhOuvkkXUfCqv2kPeaK
81RPAnpqdtWvdbA2XFEhtXJ91/DWVz/NuGUFIeCSxxOuCtu7atd1PJ22WOget9QEXJfe7MvrK9Ga
a9igADgl88rJ3goNfqu9/tb5M5oJaDvUdR4xksI82AVxAfMAAACXAZ7odEN/AAMQUfuAEr34iEGl
Ss0MPpTAJqgoD22Ww/8qx2KsQt7nl8X2CVwmk/WqxRNNqVJp1cgoDwvo7HrB8gERBV1nTdQ7fHYK
xSymRBSyGUW63LtscSOPZbFdIbU26DfQhegmxXR4IfdNOn0BA64mrqywWWNsDOlF8De8i9HER+tQ
rUeQRCZ2V2k9lav2G1EQFUA+YQAAAJYBnupqQ38AAw/s80gA+KWa/DMrxHGp3s7FGvsWcGNc4hTO
7Nk5NRnxZGzU+TUwZAK3Kvyj4TeXB/niR0Dg4TxlfXeUEKw9HxjXJu+xP92reEPXOk8/64na4xve
cWXOftSb86P6abUb5bZzZ/RbyPTfo+zfAez1VqYFn8+UsoDjGdtby+ykBORcfMpzIePu84aprl+A
PSAAAAFmQZrvSahBbJlMCCP//rUqgACQgtFwgAN5PJn10X+qYHpD56UVc+hp5LK2MwPwc3TRLMtE
4x2ZuONYcKNgjI3jL8BdGp1KhPm1YCrW1Cnf21HDaZlpVRbvk1EllFlDSISN3325U1WDsDCE+Fvy
FrPe2mU197EWpNa1c5SKTZxpARfy5zyDlLomW/D63RDJOUqaLhllD+R7KbC+wkHsKX38Z2yZtD47
esvvlm6c/UsS/foiperWSBk8hv5A99m21ebDGchYDeF8iDrgZFyEfARxrzcxJPfoB0n6Qmlx8NRD
KUHs8p6t5hPb700gx7KVo6yvoX56KOTPUERUuDiFZZs1rI8rPnsNGv4CkO4srdcQYDBGB5W+0Cpl
hd5p2NbFJWdeRtmIaFc5uBpApGnXFm6SjI9yA26gLYct5ulw5SnsakIq300P7t9/PdUmsPjjHg+d
AAvBrie0G7mF2kNlbhAHaz0uBlbb3QAAAN1Bnw1FFSw7/wACMUpPykrnfIAMz6h/ArTDzyoNhCZu
ZuNUhCSqkToBnPzTibeyypxAXICav1ye6E466w5SNzBX4YM2qda08i58CFIeUk0OV6pTa+lSTAdL
EX+H7a4jpP3tQ/q6YYjBBrAoyR3u4el7e9QAbhX+IUKIUhhO86rGV8p7nIBl+oQFUlkda7J5FP/l
1MAR4kF3QMCjbAPvaSIxN0RmpRGFmcfDqInIuE/mjtYA/y3RlvnBjFmEu1GUX6PPnAsd1UiTcBUR
uk/+YbY1uG7sCU95JXTAjSD0gQAAAJwBnyx0Q38AAwh1+pzGZhwABNE4fkwXr0hH1ZW93QQPJdR/
E3T8Pj+I4sNMz90IrNNTE70hlTozKayiTlXRQ8n1+5QlpzFuax9xPnKQNf6+x04x3gpkB2bXTHw9
9TmIeCrofYZC0oaXkMYD88z2ftiNMi4vwoMAQP4jD41jrsMwLRPd2kh4jn6PTvXaSs5aEfKUsJ2x
7u1qEPAUjjkAAACMAZ8uakN/AAMkXDCOL/LqAD+Qr7J8i7oXsWgX68+aVxlwATFy/pyGB++vJ4X9
KNxyRC8pHBcbYSpQmUOFOzJ+9pqP8tkP1I8tftFREKa0UAD96aaqltwHGIfTB2SC65YbLDjESLEW
j5rNsK9Y4vOTvAcMYucYaDMG2kmbVDuwSAkChKMd3GUPOSUBRZUAAAEVQZszSahBbJlMCCP//rUq
gACM8zf7UPrjgADQlD0De+gWSwDMMpGD1rmOsYNVuLcuyhSaTqyomtdhWNWRUPom+cKVHK03rSCY
FDFUocF1w2Dq53Johs9kek0fshQ64voZu+H6tY3CYsa5pN6MEx03/jG41orglxXeqy2cyxelglro
6ycAQPico+4sZ/V1k1/fqTWYwPpgV9JJWEsWbV6M014GZ/zni0hJSk6JU0NdjbUULcK4+T/ntLYD
Ppl7H0O8xndpSNo8G1dPTjZu5AW32Vexk6xNyR8Siq3c4cE5f3/9dIW1eDh80pVHLgDiqN57px5T
NhLEuZtKSHQY/u4jLBXrTYMkDtZZjz2vwgp2aS2JLH6EgAAAAO5Bn1FFFSw7/wACGXeo/ItLXYoT
IwAsrcUy/oK/km+6cRXrTp2Eq2VwaXXxRO2njG0XP58U/5dMsLHk4RKqGfUP/3CFPHY+TmSOPNEE
P4H7ywrWg6Zbzgd/GevpWZrBy+AzgaxoNriMbMtZ5ljnVWUU4tj7m4g2/d+cb8kkGWfFNQYP/ceq
YCXjc4AwM6ds8hpUmZ19L/3JiR+E0wEzrOFFAfzhj50uQW5DB+l3b7OrRq2f8CAUaWwcSAkzeIs7
+y2hcZqy8jkX8wOxHKc9ZVw2oFcrdVPL5FgRD0YM0frVGmRlQIKVocjOL60wuA9IAAAAfAGfcHRD
fwADCHX/+Ru7AAJolubWxZCx0Y6fEaS77b/PBZwFmUfo6OsFWfgiOicwkLqqoNrVkrjo78JqUKGi
sqHuOQNf6CpyHhFFQTT7OMpl9o2zqCzd1rgjLcOjs7DjArRyMQ3KyVSYJNy3Q7EQisNZQyBRAVFV
4uK0AekAAAB+AZ9yakN/AAMPNg1Z0ACZBktr5ijDgCN0lMFYmyrpjo/GOc5IEBIgCHcd5pAroZla
W5GT/RwIQ0IMw6y6KCpa/+taVB2SJLeJVwVeraBABTvz8TsIxquOBxrLK4+V2XqCluW5yvhK7QgQ
ZkJiqyXeIEWH1cTXTGktI92bdhxwAAABMkGbd0moQWyZTAgj//61KoAAjFJ8tHbABlz85CwnehRM
0r8KlV9eR/NN+nfTTsEcboC8YLKhSHaxQbPlXjSttKzG7c+UhooiOEV/b8E5t2/mxOdim7VCFUFf
lFh8P0XF9JfXwMU+Avr3V1nZWPNmkN/i4fOMyjeOwCTKhdwv45kc1bH6rW0h5Pz/YqEw3+A6NXSq
LEjvX7jwSAr9rK72C4j4BlpHJ2MOir28d+1HsjbRLW9ntymqs+ODzlfGewRMxdeDRXKLMMl/XK4X
Lgkfvhf0dESNUeT7aGkGagJpNDKGRBotONRoqGmwb7K57RipCeENjraZp4o4atdBPfQCp1qluQ/z
azurCWgBfNpPxRufLCkAgNbyppMIqZYIX4ar4+spU2nkgBsEiuRnRft03BSBvQAAAJFBn5VFFSw7
/wACHNKlclxUAD/QgH87TJjGXnkGvz4dhHqun5TRTGKVidbfdpWWB83GPKpZTAdIxBCjAd7xLbb0
W4v59y+Zz2Y7t40DfnDv1al8IJFJCd98t228x+l2qZ4IXCY5oew040o7PSmiB8nlKB/xKPwXXDV0
pVktfvSyFDWDCsv4PUy9C2d3S3QRSCmhAAAAmQGftHRDfwADD8krJACXKH+sMwyM3jvUjGzOgATx
7nIrq3BzSyP0/75alZj1Jqkn3pR5g2h6QZWXb+j98Lri7jOZIG6SDzNkMPzs5iZNBoYb4als/GrT
y/C1GMI4kkB6tc0xH7pvTLABOK+rMMRXyOLkWHlkbfXtrs89DhQ18xkjYqPSq1rQ/7Pu3PM9sL9j
RBFmqW+vSTyLKAAAAJIBn7ZqQ38AAwh1/7ax7iAAJonD8mC3D2xzH7RF1JG9l/fQ/YVZfD+HXRxG
d7oRWaDBrPsqeQzREmoJ5V0PWj37lMSSJXMseEU0Wboy6VC++tZO7EpSx/h1uxQOutnsoXn3YoFt
D4AIj8BBCroP8eWnY/r3YjHE5Zf7NxuCqk7gGSRBwSxtekD2vhL2hvUt9LEB6QAAAXlBm7tJqEFs
mUwII//+tSqAAJCAZZgALY9JEWfk3FtjrVkuyPC52Vq5+tJ3FiQngz6gQ/HaQ1LPKF6A7k6JiaJA
lzeVurpctEz7dv2g+tkqiwXBg+r/xC+qtE6+lBVCnnlZB7Wa4FrCjFfdt+2a45SxG/ogOjcZkzLc
IgaKnhyZ+U6kNYbqvppqDeoqXyXF3uVqdw0R4SSTGnFovX952E5dBIvwE1J6qk0k3zgq4LXGhj1y
cnCSrhIOMUMuRX9/0KbKnPXAWmKYUkEPH3YbYgnChW2yS1a6wHhan+MXjCMEpV+Gh4Wi95cLJegJ
/9+n/vqPMOr/5Ly7eql9xnx3ocGS80rAPFW2KPMjnrXPpVR4p0TsU1sD6SWqQVnueDEOmGuKNr7X
B2iBWcaSE+A8Kk4vjK8IrpmiMr7ynhseXKcpUyvoXk3HnIdzmFNcb2G25XN0n3VmrZX3wrx0k1AV
EB3XyquBR6wDlSFGV+1ZHEvIIB2xJAYQgkHA0wAAAJVBn9lFFSw7/wACMOTWOgAmiw8oG125Efom
ZLxrhSgDhxVERcbVgOOb9frQl61QmGlosE8faWnjwlc/Purnt8ADYoqIv9YtIOH2w9N5cz/Xa68m
w2JwJSyOHz3QcYGoVGxQTmfFrmlxpo8mgYoGMfHBKllc4D+P7BccONzOWc0u1m0m77SCncs2Grtw
YIBNVD2iARsNSAAAAHwBn/h0Q38AAySDMMPwLvQAJrDklTDClimdF3Hsu1SVA9o8EViHFmBmxCtw
y4GmToZBdv+zqMf7tZrFR3tDAjOvpeCjt5aiMPksdkX+Fu/hH5H+NQxjzPJD7doHIh1HzEejbLyX
mITbg8z8iyjCqGAR4J1c9mTtMAXE7bEjAAAAgAGf+mpDfwADCHX/+Ru7AAJolubWxZCx0Y6fEaS7
7b/PBZwFmUfo6OsFWfgiOicwkLqqoNrVkrjo78JqUKGisqHuOQN0B9diaGV12d5a1ImussjOO7eq
xmFLNB7opHZAdgvVjmhruSasDG5GIwM7vn5KmSIksAm1N3DAp6aleRIwAAAA/UGb/kmoQWyZTAgj
//61KoAAjBlRyjyU7kgAF080qElFhjy5w2qcDk6HxcZfm9TZa+g/N6jfWqjMJAAUQb9ri2GYy9CY
jJKaJNXB0VUTBZUI63Y6BDDQjSd/MquLxpuvXZYg6Em1PREwnCfnx/r6KGQiZMBYKQDv5t3DEb09
FAeLfy/83lIgk4sWD9iufGZmsZFikx9iXCrkPkFynW/BNyWt2M3iIgs352+XAZjKN7UtaWWxPZT/
q7gWZ8Pt/i9Kvu2mXIysoxcE8QAx0/nh2P/1/dztEaRwXsTemJfWaIaOV/UClc0NO5r4z/aL5ZqY
iiClTWxyHCcLyjkVs8kAAACKQZ4cRRUsN/8AAw82DVnQAJkTBAzCYhZCdD8JoJmayppPPsvi0HoE
jm0s65v/5h9GZcGxRHUORunvW3SXf2pAOi+H9dHkyVHtZdJhVI5AwMVuIporpsJ7MoTaWJ99WFxB
h5rnGEMx07LdsqEFl/9erZV+5qTYCVuTvTG3vE/91Z0kCo5mrDoX3RIxAAAAkwGePWpDfwADCHX9
eht3YABOR2veLPEDDdx5Acvr96qcjBqq/1FqqEwbqw373v4i/Wju4YFQkmGahBPDPczvtvhSF2Dp
jKuSJbLbQAJTPD1ZVH4vPp2/hVSEVf84FA8Fi2NdeAHYgL8pH1f7VZYLDSMiAu6jWrGaULsmbiQ7
P9xe1kIDK1D3caGQqLhGhKxWDC+JmAAAAVJBmiJJqEFsmUwII//+tSqAAIwiMUwAD4wjEBm83YJU
F4FVsID7eTYCLzqmesIJBRU2jUF5TIfbjYTXX/QhBID8M6FbaCYxSx61Md51OHmmP64ngPQekx/T
6uW1Z920/ZChCa+MHZdUpcu0L/d8Q04ilLBcReAa8qoUIn+Ot7ubYJpYerGvOrN92S8/3CjpZNsm
wuwIjvJihGsMaEBfJgSkfFmEVK/G3Nnj+coVc47Df6ElCIlBZLtLOxcNq2VUVOqCn8O+RF86ffRs
WdT9jfhajTFy5/VUGAxq/sAv1U/QTwVwyiKkC+dpqBZRg6IwBl3HgAfq9VGXFixIWJG9oXZ9C8f6
frL7Wywsgcbx9b5KsAsuir+z9pmyhomVFJDLnKSy92nMmbRc8wGYZPLtcftoKrgGOGKrhop4J0aQ
zikhQ9I1K0TNgMR2M56uoeLnVWAtYAAAAJtBnkBFFSw7/wACITVUQwANUz/aB1hMUvrKlJOoXQ/X
9W5d8Re6trbb4+xuPfMUV94IGL60p5+v6ai63t9GeXvXrXE+yKZay7WkjC77ImtT8eUDutF6z/qa
kMeheWhnh54nxbaXzQHaHEdC3VRkU6sXieouXXrd8L7BtLJpB5gElfydP8XCTVZoQNxoNLGA7VUD
l+Vl6gCj24RqQQAAAGwBnn90Q38AAxB73uQAlsEzQ2/52ErSN5+nULJxrWmR9i1BllYJWDd+yJy6
quJq5VeHBOWvIaFUnojZHiILoN9fIiKMQ/heSBxSdLksd0lquOOq9yM47Jc5Y3ajTkflbaKAYkjR
p9FMujhQd0AAAACJAZ5hakN/AAMLvrqcnHACaaj5kB8DODk02S1httSEOF2qUHfqH2ecvQqK8B+f
J53YySrGR3R4XWfdONNAvobEg2TtMKIoMNMq/SMvy2krqTJFOI0Ybq1oP7a4u+BMg2w1BHoIOykz
IAou4oMf3k9l8jeT5pJ2W1y4RzDCp11IUI6/YHr2GAiA7oEAAAHtQZpmSahBbJlMCCP//rUqgACQ
8zfsgYGaoAN+zJnIqmw6V2KMgZ9N8VoVeF+uj8cQMXOLXxVnjxremcOQeDvYd5w31/Ho/h84Y4U9
09yM1vdKPFTe9hltoRuvNuUzp+HjfiaQ1YPSzoRec4QZmdtmwGr2qpH+faBUvk1HogZERLSwTPvg
t1X8+sFaJBWwWza2hEYLYTS10/+sBVnJpU3ecJjzCdYeOPeunLgQc9CsAOBVorC+qoCOKB0s/zFP
cP5Wep7RVWpTX3EnS9KK/DcVJ1mxetq2MQidQWxSqXWukjiJwernfNot68rcgAYNJJI5Qu3EwQf+
VdEH5xnAcRMKhVPuF8kuy2Uz/+vjRMlJeZ2JXo35XQblOI4iWGkAjtOsSgYymqrs+CG6wMem85h6
7eHFGOrZJ1EYARlQEP0R4g/j1eHFpbk2OOpW6To+CtZhoLyXyLXUxYqb4n1+hIYSd9YkkpO+FsPN
Kwl1ciXB4qeGesW5RLQqqxG+AIJZ9epq93eXxfhJrBeFH7tap6EojhTaRnmC+QPW+cnL/r6l/acP
QT7hWM/rJQ2gTWLIc1JrB2UtpGG5mWp2+lRORdMNMFLO1GmSv7fYE1gy4tPLHJ9duU+M0RUerTsi
HwLo6CQ9DbiVb9R0snYeNPOggAAAAJ5BnoRFFSw7/wACMORv8o6AEkETAGJefIyZf4l5fvCRH9qD
ma+pFsalWAbg3pHCAf3R/2FRKVvvQg1/bnW9cRYuzxp775KsoVXnGciu5KtuNVadvTnyhthed5MU
dqXk3xi5QqNC/fm5Vf9rmMSkYcCuRrIMLgCVtMrEufWkFeJMVCiEQ2xVH9KcW/gaIuivtzFUF3/A
myMrjwuRW+7EbQAAAJkBnqN0Q38AAyPVVTXACEEPoqDN2qwGUXKJle8Y9FQC7Mjrr9d0fe6m5mua
fsmkMve+d/MoDmksXY3P2FX2Hp3HPr2qxsgMCfj+Uf1rSoNrTQyHbFfm+MWk2kBZmmHEiAWznSY8
mOcPe3JeGQC+YiQ80jK5XpSAgCXOfZDXO/JiKGScIq5tDw5V5p2kyaGMbtsJUpD25k8g6YEAAACE
AZ6lakN/AAMQX5yAEzII9zuknlJqN3judZKHJu4bo8MqMxumJ45cliYBDdrfqKZOCqp6Yp8jiAoO
qQ0BtQJDYFCum53aOfff9qeX9owCxTaEFlZSv3dC60VRIYu1lYIOjFHAML9Aq3I1n/OvMjux3DqZ
IpH1HcVh75QzNQoXhvCKoMWVAAABQ0GaqkmoQWyZTAgj//61KoAAjDeDcAGhLR0f00vUOb2AChCm
D4vHv2pSSnk8LIN2Kib9ik51h5bt+9EMHCwYeA6QlHS+JO2LIEi3q26oX/icI/8xmuhe/2pIVQLT
iu/AeGHnqAKR9YjQcOGno1Q+YXBBywxGR3lBX3Xoo/ZDXnG690E/wSo5Pw2OunXHJxEuYyG5vORu
DEBE7qmHVMgTkHn3PSCjVedAL20+CifKpjmVNaD4beimAwDuar/FAr50Tj/XuG1C6eQOTNiiqp+a
dDPuH8rAvrdkCskO43wKfqVaYsgDjSOwZKLLj2PbbO6XWFGCXExf8UvVvMC3Vy/W1tn4O6X2bRug
1Gvvrc8MxZSbA37BicLffdg1lC0ppTYEjzxZj2U4Q16vDGPMR14DrL8sWck2tI+iLgmfU2ewTTCO
B5WBAAAAo0GeyEUVLDv/AAIiKqACcktPL6osKbr/nUlR81GyHvNq65oyH0lTmrmkmJvk5Jbq084C
Q6boJzBSqjHBezaoDy2aK1dTpii71IComCKcfpp5Z4xkBl16tLPrxY8HB2wHRXUFMPVLmqHO45WN
PvQseyCwUZ2Wx8bVZOmoVS5M0YSosHmgWrnWLnrB1MKsrSVoO3IKzr//pg5d4Iwkk+8BRp6kRsAA
AACUAZ7ndEN/AAMQKy3ACZkTUiWp9w9OOW3KdctCUxm/7uftxD0S2btzUqDaN6QK3AqS0IA2PlbQ
OBDFvQsyx7BihipS0iAI/p8ihBysJXJg1pbnWH+L3shxLVlvFGRykyoewCw+viNHPpw9eiazxfYm
OWdwZbAw1fc/PORoJ4kJdlaTEF/AWy3PdFqi0dt7Sbv/3PxKwAAAAJYBnulqQ38AAxH3IANk87PC
bJ0pT0HJm8nSbvXEp1OywdiN+rcIQvRABOFf4n3aTXU4wRKXNFZxjVBLH34WipYt6cGC+9awOrM9
SVwFgFrGwA+j5ZBPaVq4WgEhA/2idWVwSCSlUHOVok/zvVMqDw3OnSsL1mOpVzASWsOfsxCY2rB8
B6+dZv1gyVZfY5pnl3JLY9x+JWEAAAGrQZruSahBbJlMCCP//rUqgACM8zfuYfxqgAWuqLvsbSxv
YhARPTJZ0WTIjSeVTWrHwFIzW+1ZBAEAPTOBtH/Az6kCSYg9CNFL8W01c8HyEJ6XkZkY1aq/0acg
eAntGcQ4jvW/SRHEh7HcN0jDqh8zVRyZo2JULzSKEK9So4JWhMpktKgh7tCQeziz+GzpQY14a/Cm
6X/c/xiuLGJtbJJgiTkJ2kTFx2k0LnPuP2tieCbmQ8z4tL4elc9+8pxOXO60xAIGvrNeLdXh5OZ5
nyHjzqB4N/T3yOTKOe6LMSp7V2qDkEAsItwL4dQsKtB/ZnXmcHqqwJ1j18/dcdAGh1YVpyewGXBl
EKC8SNfyizrQ7ZEShXAFK+7hT+8rFbsKS+NbmlxisKa8cxxMQQwTUV0cvZiOHkorwKidBiXqeup6
ho0T1QHzGf7eRCd/LNFYSfAoz5ubrAsRHrpEQGPlYQ6/MEZP03m/8/v5xbTpmBUifbbYa2Mu1tlP
++Bg5vdUAivyHLB5xQlhnLRO5khpIgyW24GsKx9ZJE9+fgj2Mfh3HCzWJEA+bzca+0+nLAAAAMFB
nwxFFSw7/wACIFo66gAe0wzadDqax4j9JzuaqRmpLU0JDvHDL4DAaT/A3XSewc11j5Cwg/yabrRc
mQNm8qflzKOqFIGRULNnqT/oRLWAyqbzeyQxaryEPrsFiERQWU2RtyXQl34T0UjTm7kRe0JUXsUq
uXXS6fOkN/DQAfB4JswhtM7j1JWG/zP0V6VF8PdIM6YUbOic+fLLwpnakeiO3jZNbgLsc8sg5tVr
LmnRfoY6dHVbcYjIQ7tevREg8LuAAAAAngGfK3RDfwADD9iSABD9DgZPMzwe+CX3Iy0eTx6NenGw
X+H3cmTnaImT5w9ykko/rnriPfHuW7rBGqUeUZOOWspfZXIhQf6UDNXF1L7IAo31VcY21VXLFiEO
owkwyTrapqVL2ytYH2d3fHZbzLpOqtVc+i5eOAnyIWvUZe8AtUzzeKP/c5sD8tQim64KSy4CPtnn
PKCADVQ68WgJkYJ3AAAAjAGfLWpDfwADDvcckIAPzkZktkurIGP+RasVPh1+rxf4sY3VdQj4kdZd
pZDEBz89KNc1SYDokG3+aqQHbXoVnNWGwV0MqcfFruYfecN9X4aBw7rta1bPdnU2ZdrqOo3ARRNp
b+PL4ZNcrsw4G8gxLlWPcj5oTsevRbCQz3ymSsMxGy3Jx6pmAfkE0HHBAAABS0GbMkmoQWyZTAgh
//6qVQABGHW8YALkuMaeVPkYKoVAOLAGOPOZdrGII7IGZc5RCD6pxNXTm79RbP8C0HDaoVYRJuFA
STi416qTrAAcwuxhghQLoWHR7iDJjMLZyM+2z+D/BmM1gap4SWQTXgd9GNzuhoNBwibmXlXFTCgW
KG3XCi4Y0LpkhOcf2+ViK+K6d0jxx4UmDxj2OmxLXaVTEF0skJvYdJM+vFtOFtoCZVJesQGdYWvd
4USrJlO9IEUJKMxzWdSyIXI+YGxJJop+ScQM5mcmup1jot5f5vlVSxacT7cvBklaANHrjUkTCpPl
yRKxwUNOqkpErVzo5RXp4J8uG+QHXwmw1ZFZoAeAv+PgZUbGim1JnhBuL0rgupft3wmeJCYmUYD3
Wx7rn4SvEVMSuIHqz/eUi3ftQmzKUNLbTG3XU/s7R92NfJEAAACuQZ9QRRUsO/8AAiIqoAJxR+u1
gkrBG0dCa1x6P8KYD6UwzWCZKArDbAnJsQZLKMraHYj4hNR21woaKFRPqvWsFC2ionCYevC3w4L7
Fk+Tw/hW5L4n//jUIkxSgCEDmSvw+ZbFwqo+KFEcnIm6VuTqfil9cEkyJL+vJMANWD8J5+8aIBJ9
/NKQxrJYKFkkMkhN4pOTI3ygmGxByv3RGuR8MjPkVPJijtu3jt/5+JGAAAAAqgGfb3RDfwADEIi3
ACZiFdzuomxD1lnlJzGywJqqt9XWQQhFu82RJ1nrSVbyv6H1sA75x9RxUySIYNW8xgGNqfZfIwa6
hJOJiIYqJxaY0DN7oVr5m0Cjx4GPPfsh7/rShFqBpkjbDJNTsCKTlREs0eFJBxBv9RwQV1KdzsSY
aln+UjMIpte55FASgdSF/pubbDvv52A6d2ftm3EkVo4wXMG6c430p+UFJETAAAAArgGfcWpDfwAD
EfcgA/ORmAKEbak00jD0Av2bwTyhuZIfoLq960gfKNw2D97XmKHbE0kAgdTXzDsjQiiBTzlt2Rnn
6oxsGDqITderOPO5CbuGlJfn3xI6XTixskKecOSJWlN6vJQjOV/mZdRhWq3o4T+Uy4F/C8BvhmlF
J3NPKWg7zkq1iUF6dA3CaSbwIMiwgYeM/LbPksxGkRDaWsnPbMHU72njlAqyH4YYRIKKSQAAAR9B
m3ZJqEFsmUwIIf/+qlUAARllGAACHFeBeizrBH1oP04OELmCsbVHlUo/TtkCtIkDo62Y2ywOUYHG
M8rNIFI3q1XEnv7IRab2LG9EaGO9IFvTe+BQXikdfdredN5c/f5OYrBO4hpTwxvp9ELmfK1/de1G
Ui/PPC2en6ZoUrE/RXbqSqevXXTWbe7rSDvYJrvevDEecC2ekPfWqrq+vqMqE6vt/Rhi+TMnZHHZ
HZph9YHl0q7JWkrB50iOfkvu1pBjOMwzLi6CdubCnBeYI3hS1R+xA1pmT5sXeqHaV1WVU/2mZFDW
LUqOlylOFvLAzFbb26KGZbuo8HoR2fcL+yp+xAUqaBHE/LUfrcOxWR2ZWIr+DT4ntvqcaPhO7CdY
2AAAAKpBn5RFFSw7/wACGYvdGLGoAIb+hYvFiu/hl1G42TT3gHdyFZkVyyKr1AmvGvEDjYggv2J1
lo4shoNHUB6NkVQBhdvq+GMPH5q1bp8YBfiK7n2B5FshWTqaxzvB6QIM3Q046F13fMtWY5rW5u16
gEe7dUyt48JxGc8cstBxQaYpqLChjnJL71yIhDGU++sMiITg2wmb2QyCvoTgfgGU4NCZp2PqxrJv
jpBxwAAAAJUBn7N0Q38AAw6qcgkACcj9YXm+SPonMJ/RvcwJMCbBd7MUl5yes8bXSxRgqH5XocZG
CFcViQYnvkTKKkt8YBc7UiigAmJZYkCiLiH+RAuxXhXTt+WPvx6HkAy2gRcpobDgZOJMT0t9fODg
NzZ51hXB3HyeZIVpzdW7QBVyH4It2R0uh6FfCH/XB8VJJ3Mi+w9hOcA44QAAAJsBn7VqQ38AAwdW
VnuAEwTIXhh+egWo9tvJLToFC09rlNwSVg2SGdAJ7YSm3Xago8EiXjuk53oE2kGr+AgdgsLS2+sA
tE08iOiKig2GmBqCuNo5SjQQYm4aoJFFaA242ZUekrausSw5bfgXMFyaIjvXGJt1vkpxdKiZ9NYG
nYGp8M6+6XegRX3YjC8wRoUdnEa/CDTp8qLjKIqEvAAAASpBm7hJqEFsmUwUTD///qmWAARHlf9k
CdYyMAC1yBGXC1NeYohGQkW4pSnoC37F5VafHrXqvV5E3YyaxTQGi+D7fIDz/t71cB6kKnooH46a
lmHHnvRlghGWNaj1/UxsghB6nHroyPyIb7ztXVksDIyULpy7r3ahlS4WwAmeDexvUsE3fTR9tQbS
E+swRo9c6Qc6RHYfV31cZhXoOwXn/HfiwsQOkF1BYWneCNFnbNSSdj+6GP25Vd9/qWq/aTRb96A9
cRVuPJX+XQAeZ8980oZUhf6IVozzaqqcX4elroQduHJboD5BiNkoe7nKKWPekHRfqP3p1Y/67BCe
pCApuqL5lnOp1xyyedL+JYwzaNy6BY2kpzpmmlRUA9w6qGvVpje3/eq2C8ekVWPxAAAAtQGf12pD
fwADEAW5ACZkPonJncPSd9QkFaCRF9gZa6jScUoBQ0oQdoLHgsPy92nY1kpMywMlN68Ao+/wKwye
DMDhiPM41CqUkWhVbfZZIK1Zs9k9/riQWHSDaLZfMz2I7jIAyQxBgMPjFEtoIwHN8TgY7GHrr2mY
gJTpCuXMVJ5AD1xtx2f8KWNqU4O7rLPc8RqSp5X8yjBCSLWJGy0aToMRpoGOzt8+0Vdn7fyDcrnU
cYtqLKEAAADcQZvbSeEKUmUwIb/+p4QACGubkgA/MAnn+uHs+EMxTwgp7MaguEJe991LmBbMdXTL
xwvIAmGeo11MPXyX5luv+pAr6QT5aqVV7gyarnKi8g5M/x89eFO2K8YE0/htz1Al97uLLBqKkaZG
EYrBacaQMAMDmknvD6g4GeYgU3xzgWcOG/gWz4lz2X+P5GEEoWpipAvVrgnT/shlVNYhC/w490t7
N1oIKDKX1sl8qB4vkYmb3/dew0E0LSLYFekONXNqzEI78aiN4XtPNtLToid8KgiYOKOXTPjBk3MG
tAAAAKZBn/lFNEw3/wADDlyikALY/4b0rLo096ENvG48m/FGYFJJR4QUOPUBL2rp5eZHY1hY6kcC
lCxwMpakxNZ+HRBheVVn1fu0HHtXAICVSFyFU7jtCi49k+Jx+5CFIt/agdH5joTN5kkE6X0TIdpk
V41SvHrONtzoa98LQjgJpvB44lqm87tpjqaIebhy57fb8Y2hENLV8Kbuc2/O/U8CgXl6fTHoWWJX
AAAAlAGeGmpDfwADEF+cgBMxIOBxuKl7RGjkgoZhCt13eHUNkcPVHAwpjG2NW6s3w+t8/0EMcu5F
TYn1EC/u1wgBJlSzKbxe4wC9ZciJS8wq71OZbq4eoslNnmAzBQHhZ4kjYRJC0waYSmYhKlFOCXce
PIEauUp2S/p2ySW/g3wGbeFthMXgNWIV5Sr0Y2oI/iTIXCt5gakAAAjqbW9vdgAAAGxtdmhkAAAA
AAAAAAAAAAAAAAAD6AAAMHAAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAA
AAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAACBR0cmFrAAAAXHRraGQA
AAADAAAAAAAAAAAAAAABAAAAAAAAMHAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAB
AAAAAAAAAAAAAAAAAABAAAAAAoAAAAHgAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAADBwAAAI
AAABAAAAAAeMbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAAoAAAB8ABVxAAAAAAALWhkbHIAAAAA
AAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAAHN21pbmYAAAAUdm1oZAAAAAEAAAAA
AAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAABvdzdGJsAAAAt3N0c2QA
AAAAAAAAAQAAAKdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAoAB4ABIAAAASAAAAAAAAAAB
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAANWF2Y0MBZAAW/+EAGGdkABas
2UCgPaEAAAMAAQAAAwAUDxYtlgEABmjr48siwP34+AAAAAAcdXVpZGtoQPJfJE/FujmlG88DI/MA
AAAAAAAAGHN0dHMAAAAAAAAAAQAAAHwAAAQAAAAAFHN0c3MAAAAAAAAAAQAAAAEAAAPYY3R0cwAA
AAAAAAB5AAAAAQAACAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAA
AQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAAB
AAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAAAwAAAAAAQAABAAAAAABAAAUAAAAAAEA
AAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAA
FAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAE
AAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAA
AAAAAQAABAAAAAABAAAMAAAAAAEAAAQAAAAAAQAAEAAAAAACAAAEAAAAAAEAABQAAAAAAQAACAAA
AAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAA
AAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAA
AQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAAB
AAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEA
AAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAA
CAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAQ
AAAAAAIAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgA
AAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAA
AAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAA
AAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAADAAAAAABAAAEAAAAAAEAABAAAAAA
AgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAHwAAAABAAACBHN0c3oAAAAAAAAAAAAAAHwAAAgE
AAABGQAAAG4AAABaAAAAdwAAAQMAAACQAAAAbQAAAHUAAAFnAAAAaQAAAGIAAABmAAABYgAAAIUA
AAB5AAAAYwAAAPcAAABbAAABkQAAAI0AAABcAAAAZwAAARIAAACFAAAAbgAAAGAAAAGnAAAApAAA
AHMAAABzAAAA3gAAAHMAAABiAAAAkgAAAN0AAABtAAAAgAAAAFUAAAHcAAAAjQAAAH4AAABrAAAA
4QAAAHsAAAFYAAAAigAAAH0AAAGUAAAAjAAAAG4AAABqAAABQQAAAH4AAABkAAAAhAAAAaYAAADA
AAAAmAAAAJIAAAFiAAAAyAAAAIIAAACNAAABGwAAAH8AAACEAAAAiwAAAWgAAACOAAAAqgAAAIkA
AAD4AAAAlQAAAJsAAACaAAABagAAAOEAAACgAAAAkAAAARkAAADyAAAAgAAAAIIAAAE2AAAAlQAA
AJ0AAACWAAABfQAAAJkAAACAAAAAhAAAAQEAAACOAAAAlwAAAVYAAACfAAAAcAAAAI0AAAHxAAAA
ogAAAJ0AAACIAAABRwAAAKcAAACYAAAAmgAAAa8AAADFAAAAogAAAJAAAAFPAAAAsgAAAK4AAACy
AAABIwAAAK4AAACZAAAAnwAAAS4AAAC5AAAA4AAAAKoAAACYAAAAFHN0Y28AAAAAAAAAAQAAADAA
AABidWR0YQAAAFptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABtZGlyYXBwbAAAAAAAAAAAAAAAAC1p
bHN0AAAAJal0b28AAAAdZGF0YQAAAAEAAAAATGF2ZjU4Ljc2LjEwMA==
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>今回は<span class="output text_plain">10000</span>エピソードしか学習を行なっていないが、それでもランダムの時と比較して、かなり長い時間に渡り振子を倒れないようにキープできていることが分かる。</p>
<p>エピソードの数を増やしたり、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法以外の方法を用いた場合に、どのように学習結果が変化するかについては、ぜひ自信でコードを修正して試してみてほしい。</p>
</section>
</section>
<section id="id6">
<h2><span class="section-number">2.4. </span>練習問題<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>CartPole環境において、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の部分をソフトマックス探索やUCB1値を用いた探索に置き換えて、学習の性能がどのように変化するかを調べよ。</p></li>
<li><p>CartPole環境は1フレームごとに報酬として常に1を返してくるが、この値を画面中央にCartがある場合に高い値になるように更新することで、できる限り画面の内側で振子を保つように学習方法を変更せよ。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/sec3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reinforcement-learning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">前へ</p>
        <p class="prev-next-title"><span class="section-number">1. </span>強化学習の基礎</p>
      </div>
    </a>
    <a class="right-next"
       href="othello-agent.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">次へ</p>
        <p class="prev-next-title"><span class="section-number">3. </span>オセロAIの作成</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
著者 Tatsuya Yatagawa
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright CC BY-NC-SA 4.0, 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>