

<!DOCTYPE html>


<html lang="ja" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2. Q学習の基礎 &#8212; 機械学習発展 (実践)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/sec3/q-learning';</script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="3. オセロAIの作成" href="othello-agent.html" />
    <link rel="prev" title="1. 強化学習の基礎" href="reinforcement-learning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ja"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">機械学習発展 (実践)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">第0部 各種基本ライブラリの使用法</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/setup-python.html">1. Python環境の設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/numpy.html">2. NumPyの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/matplotlib.html">3. Matplotlibの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/pandas.html">4. Pandasの基本</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第1部 画像読み取り式数独ソルバの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/opencv.html">1. OpenCVの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/figure-detection.html">2. 図形の検出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/scikit-learn.html">3. scikit-learnによる機械分類の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/exercise-sudoku.html">4. 演習1 - 画像入力式数独ソルバーを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第2部 ひらがなOCRソフトと百人一首エージェントの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec2/data-visualization.html">1. データ可視化と次元圧縮</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/feature-extraction.html">2. 特徴量抽出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/deep-learning.html">3. 深層学習による物体認識</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec2/exercise-ogura.html">4. 演習2 - 百人一首エージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第3部 強化学習の基礎とリバーシエージェントの実装</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="reinforcement-learning.html">1. 強化学習の基礎</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. Q学習の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="othello-agent.html">3. オセロAIの作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-reinforcement-learning.html">4. 深層強化学習</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-othello.html">5. 演習3 - オセロエージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/notation.html">資料中の表記について</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/tatsy/1284-sds-ml-advanced/blob/master/./contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="ソースリポジトリ"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tatsy/1284-sds-ml-advanced/issues/new?title=Issue%20on%20page%20%2Fcontents/sec3/q-learning.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="問題を報告"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="このページをダウンロード">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/sec3/q-learning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="ソースファイルをダウンロード"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="PDFに印刷"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全画面モード"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="検索" aria-label="検索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Q学習の基礎</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目次 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="q">
<span id="sec-q-learning"></span><h1><span class="section-number">2. </span>Q学習の基礎<a class="headerlink" href="#q" title="Permalink to this heading">#</a></h1>
<p>ここまでで扱った多腕バンディット問題は、取れる行動の種類が少なく、また、問題の状態が変化しない、すなわち、いつスロットを回しても、各アームの当たり確率は変化しない、という特徴があった。しかし、実際の問題は取れるべき行動の種類が多く(場合によっては連続変数)、また、ある時刻で取った行動により、行動を行う対象の状態が変化するのが一般的である。</p>
<p>このような状況において用いられる強化学習の手法に<strong>Q学習</strong>がある。Q学習のQとは<strong>行動価値関数</strong>を表すQ値のQであり、とある<strong>状態</strong><span class="math notranslate nohighlight">\(s\)</span> (stateのs)において取った<strong>行動</strong><span class="math notranslate nohighlight">\(a\)</span> (actionのa)の価値を関数として、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>のように表す。</p>
<p>このようなQ値を学習する方法はQ学習以外にも<strong>SARSA</strong>(state-action-reward-state-action)と呼ばれる方法もあるが、本節ではQ学習に絞って説明する。</p>
<hr class="docutils" />
<p><strong>Google Colab用の準備</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code in Google Colab.&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are running the code in the local computer.&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="c1"># Gymnasiumのインストール</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>myst-nb
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;gymnasium[classic-control]&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You are running the code in the local computer.
</pre></div>
</div>
</div>
</div>
<p><strong>下準備のコード</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">IPython.display</span> <span class="k">as</span> <span class="nn">display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">ArtistAnimation</span>

<span class="c1"># 乱数のシードを固定</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>


<span class="c1"># グラフの設定</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id1">
<h2><span class="section-number">2.1. </span>背景<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Q学習で扱う対象は<strong>Markov決定過程</strong>と呼ばれる状態遷移のモデルである。</p>
<p>Markov決定過程をかみ砕いて言えば、その時々で取った行動により次の状態が変化するが、それより過去に取った行動がその状態の変化に影響を与えることはない、という性質 (この性質を<strong>Markov性</strong>と呼ぶ)を満たす状態遷移のモデルである。</p>
<p>Markov性を満たす状態遷移であれば、とある状態<span class="math notranslate nohighlight">\(s\)</span>において、行動を<span class="math notranslate nohighlight">\(a\)</span>取ったときに、別の状態<span class="math notranslate nohighlight">\(s'\)</span>に移る確率は<span class="math notranslate nohighlight">\(s, a\)</span>だけに関する事後確率として<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>のように書ける。</p>
<p>Q学習では、この事後分布<span class="math notranslate nohighlight">\(P(s' | s, a)\)</span>を用いて、行動評価関数<span class="math notranslate nohighlight">\(Q(s, a)\)</span>が以下のBellmanの最適性公式を満たすと仮定する。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation">
<span class="eqno">(2.9)<a class="headerlink" href="#equation-eq-bellman-equation" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \sum_{a' \in \mathcal{A}} P(s' | s, a) Q(s', a')
\]</div>
<p>この式において<span class="math notranslate nohighlight">\(\gamma\)</span>は<strong>割引因子</strong> (discount factor)と呼ばれる値で、<span class="math notranslate nohighlight">\(0 &lt; \gamma &lt; 1\)</span>であり、<span class="math notranslate nohighlight">\(R(s, a)\)</span>は状態<span class="math notranslate nohighlight">\(s\)</span>において行動<span class="math notranslate nohighlight">\(a\)</span>を取ったときに即座に得られる報酬を表す。</p>
<p><a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、<strong>最適な行動価値関数が、その時、即座に得られる報酬<span class="math notranslate nohighlight">\(R(s, a)\)</span>と未来の行動から得られる報酬に一定の減衰を加えたものの和として表せる</strong>ことを示している。</p>
<p>一方、多くの状態遷移のモデルでは、状態遷移は確率的なものではなく、行動<span class="math notranslate nohighlight">\(a\)</span>の結果として<strong>一意に次の状態が決まる</strong>ことが多い。そこで<span class="math notranslate nohighlight">\(P(s' | s, a) = 1\)</span>と仮定する。さらに、仮に理想的なQ関数が求まっているのであれば、<span class="math notranslate nohighlight">\(s'\)</span>において行動価値が最大になる行動<span class="math notranslate nohighlight">\(a'\)</span>をQ関数から決定できるので、<span class="math notranslate nohighlight">\(a'\)</span>は行動価値が最大になるものであると仮定する。</p>
<p>これら2つの仮定により、<a class="reference internal" href="#equation-eq-bellman-equation">(2.9)</a>は、以下の形で書き直せる。</p>
<div class="math notranslate nohighlight" id="equation-eq-bellman-equation-2">
<span class="eqno">(2.10)<a class="headerlink" href="#equation-eq-bellman-equation-2" title="この数式へのパーマリンク">#</a></span>\[
Q(s, a) = R(s, a) + \gamma \max_{a' \in \mathcal{A}} Q(s', a')
\]</div>
<p>Q学習は、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たすような<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を強化学習の枠組みによって求めるものである。</p>
</section>
<section id="id2">
<h2><span class="section-number">2.2. </span>アルゴリズム<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>Q学習は、実際の環境において、適当な行動を取ったときに得られる報酬と状態遷移から、<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の両辺の差が小さくなるように<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値を更新する。</p>
<p>典型的なQ学習の実装では、<span class="math notranslate nohighlight">\(s\)</span>と<span class="math notranslate nohighlight">\(a\)</span>を離散化して、<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を二次元配列として扱う。このような離散化されたQ関数を<strong>Qテーブル</strong>と呼ぶ。</p>
<p>Qテーブルの更新は現在の<span class="math notranslate nohighlight">\(Q(s, a)\)</span>の値 (学習途中は必ずしも<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>を満たしていないことに注意)を<a class="reference internal" href="#equation-eq-bellman-equation-2">(2.10)</a>の右辺に近づくように更新する。</p>
<p>具体的には、学習率<span class="math notranslate nohighlight">\(0 &lt; \alpha &lt; 1\)</span>を用いて、以下の式で<span class="math notranslate nohighlight">\(Q(s, a)\)</span>を更新する。</p>
<div class="math notranslate nohighlight">
\[
Q_{\rm new}(s, a) = (1 - \alpha) Q(s, a) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') \right]
\]</div>
<p>また、この式は以下の形で書き直すことができる。</p>
<div class="math notranslate nohighlight" id="equation-eq-q-update">
<span class="eqno">(2.11)<a class="headerlink" href="#equation-eq-q-update" title="この数式へのパーマリンク">#</a></span>\[
Q_{\rm new}(s, a) = Q(s,a ) + \alpha \left[ R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a) \right]
\]</div>
<p><a class="reference internal" href="#equation-eq-q-update">(2.11)</a>の右辺の</p>
<div class="math notranslate nohighlight">
\[
R(s, a) + \gamma \max_{a'} Q(s', a') - Q(s, a)
\]</div>
<p>は、<strong>TD誤差</strong> (temporal difference error)と呼ばれ、Q学習はこのTD誤差を最小化する問題であると言い換えることができる。</p>
</section>
<section id="id3">
<h2><span class="section-number">2.3. </span>倒立振子のバランシング<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>Q学習を実際に試すために、比較的単純な倒立振子のバランスを取るゲームについて考える。倒立振子のシミュレータは<a class="reference external" href="https://gymnasium.farama.org/">Gymnasium</a>というライブラリ(旧名: OpenAI Gym)から簡単に使用することができる。</p>
<p>モジュール<code class="docutils literal notranslate"><span class="pre">gymnasium</span></code>をインポート後 (<code class="docutils literal notranslate"><span class="pre">gym</span></code>とエイリアスをつける)、<code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数を用いてゲーム環境<code class="docutils literal notranslate"><span class="pre">env</span></code>を作成してみる。</p>
<p><code class="docutils literal notranslate"><span class="pre">gym.make</span></code>関数に倒立振子のゲーム環境である<code class="docutils literal notranslate"><span class="pre">CartPole-v1</span></code>を指定し、<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>パラメータに<code class="docutils literal notranslate"><span class="pre">rbg_array</span></code>を指定する。</p>
<p>このように<code class="docutils literal notranslate"><span class="pre">render_mode</span></code>を指定しておくと、<code class="docutils literal notranslate"><span class="pre">env.render</span></code>関数によって画面の情報をNumPyの配列として得ることができるので、Matplotlibを用いて、初期状態を描画してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>

<span class="c1"># ゲーム環境の作成</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s2">&quot;CartPole-v1&quot;</span><span class="p">,</span> <span class="n">render_mode</span><span class="o">=</span><span class="s2">&quot;rgb_array&quot;</span><span class="p">)</span>

<span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">31415</span><span class="p">)</span>

<span class="c1"># 現在の状態をRGB画像として取得する</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" src="../../_images/0f006b3102162d6aff31bacdeb2c73ea2d02a7ee151caf92e2c25119f05de4d3.png" />
</div>
</div>
<p>このように、CartPoleは台車 (cart)の上に倒立振子 (pole)が取り付けられたものを制御して、できる限り長い時間、振子が倒れないようにバランスを取るゲームである。</p>
<p>倒立振子は、その状態を表すいくつかのパラメータを持っており、それが<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の戻り値として取得される<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>の中に格納されている。</p>
<p><code class="docutils literal notranslate"><span class="pre">obsrv</span></code>は<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数になっていて、CartPole環境の場合には<strong>第1要素に状態を表す変数が入っている</strong>。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 現在の状態変数を確認</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obsrv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.1067048e-05 -3.8479745e-02  3.6217723e-02  3.3740070e-02]
</pre></div>
</div>
</div>
</div>
<p>CartPole環境の場合は、4つの浮動小数が格納されており、先頭から、</p>
<ul class="simple">
<li><p>台車の水平位置</p></li>
<li><p>台車の速度</p></li>
<li><p>振子の角度</p></li>
<li><p>振子の角速度
をそれぞれ表している。</p></li>
</ul>
<p>また、それぞれの値が取る範囲は以下のようになっている <a class="reference external" href="https://gymnasium.farama.org/environments/classic_control/cart_pole/">[参考URL]</a>。</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Num</p></th>
<th class="head"><p>Observation</p></th>
<th class="head"><p>Min</p></th>
<th class="head"><p>Max</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>台車の位置</p></td>
<td><p>-4.8</p></td>
<td><p>+4.8</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>台車の速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>振子の角度</p></td>
<td><p>-24°</p></td>
<td><p>+24°</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>振子の角速度</p></td>
<td><p>-Inf</p></td>
<td><p>+Inf</p></td>
</tr>
</tbody>
</table>
<p>この値は、<code class="docutils literal notranslate"><span class="pre">env</span></code>の<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>フィールドで確認することができる。</p>
<p>CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">observation_space</span></code>は<code class="docutils literal notranslate"><span class="pre">Box</span></code>という型で表されていて、<code class="docutils literal notranslate"><span class="pre">low</span></code>、<code class="docutils literal notranslate"><span class="pre">high</span></code>というフィールドにパラメータの最小値、最大値が格納されている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Lower bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Upper bound:&quot;</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lower bound: [-4.8000002e+00 -3.4028235e+38 -4.1887903e-01 -3.4028235e+38]
Upper bound: [4.8000002e+00 3.4028235e+38 4.1887903e-01 3.4028235e+38]
</pre></div>
</div>
</div>
</div>
<p>Gyminasiumのゲーム環境には、この他にも多数の関数が用意されており、それを強化学習に用いることができる。</p>
<p>まずは、その挙動を理解するために、ランダムに行動を選んだ場合にどのような動きになるのかを確認してみよう。</p>
<p>ランダムな行動選択には、<code class="docutils literal notranslate"><span class="pre">env.action_space.sample()</span></code>を使うことができる。CartPole環境の場合には<code class="docutils literal notranslate"><span class="pre">env.action_space.n</span></code>に格納されているとおり、取り得る行動は <strong>0: 左に移動</strong>, <strong>1: 右に移動</strong> の2つだけなので、<code class="docutils literal notranslate"><span class="pre">sample</span></code>関数はこのうちの一方をランダムに返してくる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに5回行動選択をしてみる</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
0
0
1
1
0
1
1
1
0
</pre></div>
</div>
</div>
</div>
<p>選んだ行動をとって状態を更新するには<code class="docutils literal notranslate"><span class="pre">env.step</span></code>関数を用いる。<code class="docutils literal notranslate"><span class="pre">step</span></code>関数の引数に行動を表す整数を与えることで状態が更新される。</p>
<p><code class="docutils literal notranslate"><span class="pre">step</span></code>関数もまた<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数と同様に<code class="docutils literal notranslate"><span class="pre">tuple</span></code>型の変数を返してくる。ここには<code class="docutils literal notranslate"><span class="pre">reset</span></code>関数の時よりも多くの情報が含まれていて、</p>
<ul class="simple">
<li><p><strong>第1要素:</strong> 現在の状態を表すパラメータ (上記の<code class="docutils literal notranslate"><span class="pre">obsrv</span></code>と同様)</p></li>
<li><p><strong>第2要素:</strong> 行動により直接得られた報酬</p></li>
<li><p><strong>第3要素:</strong> エピソードが終了したかどうか (ゲームオーバーになったかどうか)</p></li>
<li><p><strong>第4要素:</strong> 行動を表すパラメータが範囲外に外れたかどうか (今回は使用しない)</p></li>
<li><p><strong>第5要素:</strong> その他の追加情報 (今回は使用しない)</p></li>
</ul>
<p>のような構成となっている。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observation:&quot;</span><span class="p">,</span> <span class="n">obsrv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reward:&quot;</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished?:&quot;</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observation: [-0.00080066 -0.23410185  0.03689252  0.3376265 ]
Reward: 1.0
Finished?: False
</pre></div>
</div>
</div>
</div>
<section id="id4">
<h3><span class="section-number">2.3.1. </span>ランダムな行動選択<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>これらを用いてランダムに行動選択をし、その時々の状態を画像として格納する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ゲーム環境のリセット</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># ゲームループ</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># 現在の画面を画像として保存</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># ランダムに行動選択</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

    <span class="c1"># 状態を更新する</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># もしゲームが終了していたらループを抜ける</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAAJXFtZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAE
+2WIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+ID9XvlWyqSgZCWiIjzIIyfgWgRUAUQKEL++XDpwzYLO23ANSIuSS40yX94eU3b3HoCQ
fKZIxfzFCTWtRVNIzCYKdiE3gsQUICbD6KyaM2Xg0DR5gW0pZhFlrrD/rU7UfftTuwG4lbdXEV03
JudLNEHtbrlK0TuAvK9Wt4oM7F6ikolQXQ/gDmhKPJ9ro/ItXXD3umaPK7KV6yke9JchRAFe5vMG
XVIHDmZSjmIlsFyX+k8cfjNbwm7FU6aBXX96eA88iYtBKurbuWAMc2ZMxcRXVh9KlU17YfocYKNx
ohZ8gSRET4t/99BlVT7H9MsgHuTuxBEByS9Segdx+yyiRrGgWisyuYm5/a9EIg2s1BzTpic2y+bv
kaKnzuVGl1VDZYGzVjNEGVpBRzbv+nEVlTQ8k8p3/CaZCDLlMNnmHMEH3+DUT4RxjSkcIA2W4U/C
ueEKmA0D4V8HX6YAAU2yrO47QjkmuAtJKd/GSY5mCE9wecXOOSTl7GsFaCTbxA79b+yufzuJ944J
N+6vuway4UW3IlQTO4ItdiJNWzd6SSDz8qdHChka4LUihG8X7Cg7Ry2UbDaWP6kw7w71P5NNEeNG
i54/eDC5/YQqE6IioJ0cTjwbKvLwe/n1WjrdyQBJB5dYXsUZzWoocMfyOme0qMiK6EZfvn5RgLmn
NZEPskp+1IhWW5/eOlSxRfEytkPqrW9o/3eFQwVJcsb/7sdklmyouZiOnUonWV80tyBM5tw1LQFE
To3yYJLLc9etptkPz72brn1BDwyLWVLkITta44uvqiSz01zDpmptvHkbZ8se6X5uJzU0a4ZkBJ6I
asuOWOB1pYhKA8CAwSpF0lV20yYCs/iBklRQ3wpVqjNhTdhmSNn/+wZj5vlr1ZGE/cFFfB3oshqf
+fFgAADWASMTwYwdQnRaf1O2ERtCBXPIgNmaYNrnYfWhYyvnjplFjJj8/uj2wq5JCVN2a7eHrcOP
eC59CnMOENDXa8PBofbdAQHfL/+xPDkJ3pWIDTbU7Hk53C8xKqIua2XxbxA7fVvTm/r5IcQMxS8/
PFCTtY7mGvaTSKEu5/DHBZPpurupK/eX038LN+snbrAa57Up5BlTIceOlasPjF2tm83O5VcwGUJ4
qrU3fl1aswQuYJKhXF5EJbxNGbeg/85UiQm6dqxczyUkveLASzXO8YIvTVuuUsuSZ6EA/3CuqYsU
mCUAR4JudVUZYqPPJShtRqYb/GOGsPGS156qNkgIFAGiUPkvnEV71AKlWWxFWER2xl9VeFoc+aHu
/cpIihsZS+QNY7/+y//7t01EAOfF00jkd/9sP3XD5OLumQnliqntDvcTWpPpVdr/s7BDCySDSScs
AXt44q1pcJ8PviwtQVrPlb8J78lABxMxOXnYzGtZYPaEiISvAhBIQodc+O/SuEIAoEk4Gm3h0DO7
4CNr9g/fH7R/7yuaeyIUBP42iRhyA8Z5jOeoO8H5EAAAAwAAAwGfTYhL0xrsJ4wV/kxB2YtdQJv+
OC+M40jmKmkoQ6eZOQFUL5OlopjiT/m4r6mN7oKifEsHREdJYcDQsI7gmVZBgn/1xIpXgKa9IQO+
ImUm/My/VxOE+DRGbgAAAwAAAwABswAAANpBmiRsQR/+tSqAAJD17Ax6gAwj5Qvz1wDZCivTBnwd
i0W0H2GS436KZsnoSus7cUQtMXuoKRqU8jxOfqgSK5KpEODTPWIIhBmds2p2OtMNpF6JBMjo5OYj
jUvKbqqVaocZhLFtJtuWYsDkhmtGM9MbI1V6zLKSf2QQY4aRiya/DtPBuSLiR1yTH5bFsFjMc2Nd
tD/gTb9xbzq8s3AXXYUqNDP0jVa/D7qnFuI3ydMGZf9dWZgj/6eB3k2SMwVf6NULFxWne+oPyIjS
IP8yYQy3uGwi8PVm6VQm4AAAAINBnkJ4h38AAi8wRdMrogBa5fYQT/xbtbBnx48XMRdk+w2Zu9bE
MghdMwv7CmPDEqJgcwlEqs9x5PunnNlHHm+lvo/EAVRADxflcvj7GX42hrZVr6lbC1C5z4t8gnXe
rd+2FIUL33LxiKLgjwZDK7ug/10yRu37kGiatmh++tovkiBVQQAAAFwBnmF0Q38AAyLlvPgAJyPp
9ZyN0X41knvzrScwHY2AmaKBIO4LonMfDn82eTBEWpF1xuEP+m4Zs0g+BiLIcEqeTUUHohjg/1EI
vtWwMBOQyvRUZMp5g+wiJFkGBAAAAHkBnmNqQ38AAyNG00j4ACG9kpaxmb8n0ii5m0MgkiEn2c4O
nEFlAVk+xhf2/hDi6O32ZfKVRKXiuG9QJzdjhu4G1iRF/jqhJyiczKwQNoA0VEjSUhTXas/+fgDd
LQ5Bcnd14BPg/xVIc+hD2EPz4huei5MsFutBWKqBAAAAukGaaEmoQWiZTAgj//61KoAAkGA+hAAI
ixV6vBgJJSQ1jiy3S2f7d1ZVo0f1mRK0OxDa3OS2t6emxFXHMlplI0/096f7JuW2BIl9g/3Z5N33
X8rogYRsf2tv3oKo1SqmiPm+MamQPkmRqDcpKlVA+lqEjfpYT0DHaXV3t/yqIU2dCBuUB3Jmvddn
butVuvD4A1X4eMrS3yh1jvrT85TohsC7sSIK5C7mS4m/SKgi7qzE48FEB0tko6qBMwAAAJ9BnoZF
ESw7/wACMGzHMy0AEOIyi6XWMIl+TvcZAq3qWw86kur9ofwqNI3fDbLryKcevEh+5NCxr63Bd2xZ
zJ8TiNFO38Sh5CicxmEqNQiecMCyt/OKEFVxi2wPIDnM6escXFw1aUXO4hKRJYEXM0/IUA/nQluC
fbxuinjGxQkmks27F9twRVLEAC/DDlXdHdTaXfzEdOHyIfQCsFHWoysAAABqAZ6ldEN/AAMbOKE/
ABsms8VIv3DwySju+DNaNYwX+WzO6NoiOIN/w0qyYOO1UcvkrRQZAYHXitFafQ0fKr2VO4R0yKyi
TceW1J3rw5lJISJ8xaam4Iy8rcnX6bXUqgTvc+ecVxhffOxB8wAAAHgBnqdqQ38AAyOXXucAIPhd
jQhQQuIwbQbrr6HbfeFVkcMqQeIbLeIXB7ttNrZBsNNr/Uq4+Cy94GrkjB1i+ckUNYbJD8kPYqCi
RZmdVxzagZ7Vdp+seATVYPeTLJMob7D28Xv/lp/RorEcnyAtXWV+2Cc2lFjwmYAAAAE6QZqsSahB
bJlMCCP//rUqgACQGLbJ+tdYAhttBZyvuzNmdt2ifuHhFfVxKiWph4jhLQUstcjw0NYxdBjU+Jcx
uVmpZFFvbn9pk/2vTeFt+eFrdFUjAw0KqaIRYOXohLGqahASxbzwP02FYSapYNwxZg2mMqvYvAbj
wTn1YNYz01YYlPaEUabqNdfvFJAaoGCXy2CRypMab1XnZelNzvb1DO0RsuDcabwPwri3YiJJSs+q
P1Dg9Z4XvSCOEx8WzGAEiofv5gQGOxruIgVgkvbcwZLcXfhnCGfEhibB/rtBUnKL3jTdly3s7Kro
BK5eZQ12zteV2hzSOMUbdqpgM1R18c6iQvYRyMCPLBO51D2+3/v5O62hkzGgH7+5e7Apoc9Dkk2l
DKMMynNL3Ku8zrGyrsKzMEtNEgTF3YAAAAChQZ7KRRUsO/8AAjDjoM//kcJwAC1vDJuKEOa3T1Vi
hvFYVhXZIJ8xUwQzX5iYEvR3sn4x8xh93l5LEOykJoh+Sut+TvMG3Ds2bRdUjHtK5N3xZnFe031x
Uom1EkukVNOTFS11Tn4IZLUBXymsiQJkjqf44shzwHVIJYq+/vpPFmX5ruNh+IAH6LOVdv5deOOV
5qT2xSCi4D/xGpRbZIPMZUEAAABvAZ7pdEN/AAMj1BpGgWh2JAB8O3dTpv1ZFlXh+976w9lY+z/B
C3WP8bv8N0+qBhTqvLg4GPlbxesqHmGARj1dXbE5PXTU9Bv/Qa5Q8ZJVx/FlJ8X4PgYE3mpz4zmI
8Zglei8S4Z82BE5nco4PAFVAAAAAggGe62pDfwADCcN/0g8gBLcCZtgHsuxSHQuZoQ9YmI88k/9E
UZIZJ5wckcF5pHe0njYVkIyGi8Nd49NlhS8HsgcoJ+AMyK2h+dZEJFcLVgHymkPUdNxcL44kimHT
awEleVBj82xWkA6UKUXVXEIQyd5L9lASmsq8Y3hb+OWbtt8IB8wAAAEAQZrwSahBbJlMCCP//rUq
gACMZKVSWwAcI+iASJnHupkPoxmSR0oZGPPzt3xz9b1BCVUnES4NFGLVjuW1pxL/qbgmP8epAWzq
XgpaypORc4mDnQN+8FC7yE90OusB9Eo6PdwAyeobLtio9MhW5yC4ERCrQzJMIFmWdwUcH3kRhY4S
Fi8zIzEdOwezUuYjRNY1UKqBGqaUYKu6Sg/uYFaF2vWBx2+2Tg5ExtEWDHe8O687YXIAUqBOm8t1
hY7OrhyQfZK7y3FyCuYwHXSeTcJgDVVeNXUuFeOocemjCJxAxnkEgOgUqa3Op9vklwcO3SaQhZov
71q7ojL5drORoNOCQQAAAIhBnw5FFSw7/wACG35/wr6azpACXLElcBbNpFi5wlmMxgwdGCwu7R4i
HersxdymzcnVQ65cKEVHVmnXnNH5g0edo3vnjbJoGzkI8+jjwFt9qC5GIAdAFkdU81A1fPmxiVPB
hxT10SYkADr2uXEhSAHrjbj2m5sZpCHoIJCMJ3uCpU0jgv7TAJ2BAAAAbwGfLXRDfwADCHX9eht3
YABOR3+PIGoAOd66vQKdt36tlfgXq2y0MsNnNGP6GiY6wm/HQdahz8p5dbPARWarrA/jNiNUs9XK
mlx/bm0xer6cVFHRAuVG268jcEhe7MQvmCrdLHnjr6UzXl7Ya/xgQQAAAIsBny9qQ38AAw85WGke
QAls87obf7tLlR07pyV6nKCYakpjLB200rnTIagPpvGaWdmYnyIS2OGU7KUw/SX74ig4IddiJHbN
0QyKvtUFlNmuVFJMIWMo2oxiZbSbRKaq4knfTo+isC4UYykCHs1KLBiLGjLlUeMHULBzUqBo0KRM
x9jyHjYt5X12dB3QAAABikGbNEmoQWyZTAgj//61KoAAkKEh3FYAi0uX14CUlDoO7IVoU/ZvMwRS
wVT/fzNAH+cW+7IPJAV8xjFvcT9V8KFwVkP0BJBF9fIiLWnOo6/emaeVtfE3Tu+uboAryoYhVGrW
reqjxL14hWtfLFi44B4zIHVqs0OMhacO0IpucsxeySiecDM9UiH3wydxFT2GeU65GEBOexIy7kyr
e0/t09tVWRrCtlIk6l/gSN47YMgxPkRcaB73utVDpv/XxHEQxU0k13DMhOdflniUiEAoE1VrfJ3C
Umoz0/gc4g9lr1TOCXh2QoYWtrQY/Bn61zk+qAkrvByuwUj/SsU9mI+4BLRwKWbnnVJ6Pqe51L00
JszVyNLy+1Ifzy1u17GW6eO0/FXBM9ppps2DJ5SmUOh83T6J99PjWp4yYzM7EQY4qbBJPfuJKpLB
wYSNMlQ/tTwUuP4mdkh3HPj/kjlWqv+GwAt3EYUiGhDfcY1xvWPXS+z9274bax/4EZO5BHVIDAo0
Lklc6SFO036FBnwAAAC+QZ9SRRUsO/8AAjEfrxDft0AHxTQz/vMxYa6NmIP8V5koVdA1qAbVsL8d
Ehq+WM2gbqW8Uj8RemEVpQ0fXsGR7Unzs/D9QEEFffr8XH2iLGjwljcAxwA3t94Hp/PfHZWP2koj
TdxftVID13IjgBRQ6o1xMuDlG8SY0SPob8D4TFYvnceFrVV73/PjjA/vBHVGgsJXNpCoL+g89Ct8
Uw2ySX5oSOcfRtgFKMJ/JS3FHPGzOLMcasBkt/1BWQdhnwAAAHMBn3F0Q38AAwxe5+yg5ACQfPoL
mNsTrR24LPO2fx6BniCVamaFiPY64NsBFOgEnqAg+cnIYCbDkmhCx4O8CoImzDQMkDb8q+ZVFjFi
ZwZmVUuXnj0G5QkQq/n8GcR3LQTwv2csjZ2SLO56ExOxuGFqV8M+AAAAlQGfc2pDfwADJABX07kg
BMJsXvCK3accHYYfNbS2MPwrWLpKMbje7rmvHDdIISgKmJwW2eZmg7VZGF1SsrstcbsYGxWZA0WP
3ukldZYj3+pVXr77vyMVZ5kf68cSyJGj0GxukRkq7FBbKNNigWCABByNYHCC6jSspT9GCoChfjwE
A0f5nbTStvYrsw+6HJCa4HyO3AD/AAABlEGbeEmoQWyZTAgj//61KoAAjPM37CyibKoADoWZAexF
/bezIYDFzQM/Q1yF3KT2/SZjdwS8MhF0IO304NbCvD0l5kfyZIlzBApbt1v0dmmTIKP4FzKIHBfG
kLjp+xfiDBPXYKHnd/DTcb4m3dZw2hEGhXl/a3aHwHhWU8GbyIXgomxW2YcD+6URydp8ku022c+c
I/AvmGJHvsrYgPB1BjYpCgLqa4feFJCF8eroYfJG4XyU9Jiv64m0MPDd+nWt3GXZG7fnxmZo51Ae
3ztDXMUTorH4aSOYeyMsGfBDrvrrgwjqR8UOLAUSNc2j0Tc493JQ3kqdBtvyjkssTCoC3le/61aG
cIOB+Oqy3Spubzbl/OQk3DaT6Do2aOLqdwZpdcl5iequP3O+WbyqFwvKl6j06YIiFAjZ/rR0Cqut
I16lG/vDJGDKq9/Dmwo+XXHoYyIkWoOjO/cAnv5tf8q8UeXN1m6BRwffRvoFJ/Luas1Ued6yisVY
yZ2Z5gvyWEDi2fmZO/VY1hE8TZb0ICtL4goQmdYrAAAAqkGflkUVLDv/AAIgY12snSgA7ix2+mBG
cYwR6ZSVzxEfX1UpE071G2yUjVYF2m0qHl8nPLw3B5T1FRXHe2Wbmx/jIaAT3uPMV0wzKxY30UQV
iQD8W24lkWd/J0z2kZfCsRzwsYeNha6KMc34fx0HbiY/nhCFxd9KKH3PiD6Ecu5j+C5KNkxV9Lwh
nO5QajUrERxMWbWW3dzhBGK09j0x0h3LVJ9mKhNhMUHHAAAAoQGftXRDfwADCarf6RlcAJbgTNsA
2E+EVg8X/bUxGQklChxboeLL6yQGidWgoJRkKCP1GgILZ3fz6Cb6W7P0ZFy0JU2ts/KAE82HherT
211HbtNSn8xi3ahxL6FTDuEKaqqqag9xRuM12kF9oeC/84+VokCEFVmXVr5ZZhrteWVrnuAlF+LO
R19knukA5a8YLFhzxQVhmMyWdyP6yFiNBlGLAAAAdQGft2pDfwADCHX9eht3YABOR3+PIGoAOd66
vQKdt36tlfgXq2sCcjl4lk0CcE2KFmAWE/grUfy9BSMIrBydzDHGzZf/PzhFcKsKCgu7wZw0keJC
NAF67qiIXK7ea/LLiToGvZQreSqGxbH0MfstkcT3yOROwQAAAPhBm7xJqEFsmUwII//+tSqAAIzH
N6y9AA6FUW6WaYBfkXakGrtwsn6satLuTAqgklFPegx3ArSQAzezTpbkuL1IRHUgLGGVtM9J5uDt
lU38drp5w8T7HewWo1lwhFdEZ/mTRIlif0SoNYRKdnbDpU+WrR2f2cOcLGjvRSG9MlaIjEcctGJU
KqqagUb95uCxLkXnD0x8Hh7SRCmqPutc328jP02DHig13VJ4e5VsNMGkXbAvxwP8Vrac3zbmfV7+
WrOJE2EKvZidzw4dyGQSlZ4Enq7D6eh1p4YdCFhzQGYAkms2sZ29D+0zIwWKrgU+BvhQkWee7yUH
+AAAAHZBn9pFFSw7/wACG359u1j2DQAfFR8zCLcjzEGvhwmjjyA8MFKY9pHVcGj41fJ7uHaDf3ja
xvfiST90R3m/g108Cb6Ytfb5gY2Hxy6l/bV2dlKCQVIBPoMVOy7GBzREukQn1KQ6P7ATrVybHYkq
GE1s5VQlGAP9AAAAWAGf+XRDfwADD5Q02uyQAlycNHO/Od10eRMpIW/oakVWWeRN9c5cLakiATfE
u699WTg+ji/o3BC/6wssFiXZx8Nt3gcdkNyrcSnRx/2SDOEK78YKkMAA+YAAAACQAZ/7akN/AAMP
l+xXgAJPqmAIC1NtJ9yFAqGV2dF/XZg+VvLI0DHB31is1EfcPjtTM/g1MbVEC/lUGskuwXBRolhy
BoaqEwGMIdvhpUHx+ohGBYtjFJW0d8PsPvwPJZpIyGIlVRBPREiCuNMy+ixjclCh9f443NxqnqYW
b8UbntmuE2vQO47Ldi0qnKoTQH+BAAABj0Gb4EmoQWyZTAgh//6qVQABIBe5d7wAcJR3sfCRbt0T
UmG4TeuitOqnan5p3lmqzFMWHrOkrEHFCGKJ2HY8CB5mZK8I6oqbgYEJ9UYHln8jnM0wQRgm5bg8
XqAgpUPX7rtsUpH1/zV82CzfZMVD6BCkAuUH8drD9T5KLQXXeYTMFu1QN+2+tXcM31Y/DejoJHoj
tfnzl+nXensBmfsc6EGgJLgWIJc0V7uh8u3iOIhjW9wYmY5IIyXmbgwjleh3CMGxX4Gf8tnR5x4k
BkYZj7XT+ybQuby4YkIbGWELxB5/AYLfxk2Izf/iK+p01ajk+lFB68XI2HdgLu/kuEanos5a8H/v
UNbSanQjMEHa8Y1pNGd3zHuDklRK+C9vsLK/Y3vF6Xig6SjPyVFbWC+igWdFJa5MEv9vqsmK1hnV
TvcdL5HFJJIvthpzxrNNZ4mh7i23WNzE5fxTeci9Z0hNdlFt6JphBHRvG6/z6YJWHViaMAB48gTl
563VkFX4Sjgr8IOgnfolxXlOkiKF+L9SkwAAALVBnh5FFSw7/wACMOOgz/+RwnAAJopNccOtrDiG
278TFYHeYQfZXM4Cw5HIKsn4x8A/Q0rrGCtC1RXVUldcwlQ+ea7NstbSwpouMisNyi+ne+EfLKay
3ekMUtxTRY6NOjUceDJdrVzaWG1DR3+1Gew/Hy0ij3shAvfaxdAMa0xE8zBXTDMlKf37JjUkTD/T
Jd29/KwgVogOlzE3gTz0s9KmpDY8Qr1ozBXZMo9F+yveAxLN0DugAAAAlQGePXRDfwADI9UuJBiQ
AeCDrrAdJYeODIo3Qg9EHM8r72VIZrdl6MqBHs0BgntD/ANUrm4HnRSD1zXYr9GjHiHgf6xZctNx
FmN9TY/qzAxkFeqo63Tsk9baDqkgyS0WjNTHn+xch15KIQ/M7XnMB/+nkU0liUYSShvQb9wJCXMw
ergpK/pSHFskn446prcT2akVlGLAAAAAhQGeP2pDfwADD5RwlrxACU8SwyYiq9Vl5kFCBxKP6CX/
ftPTmDqBT/8xEJqjVz6RTAjWJeIhs420sOzafcT09aC5oxPOniK4cYO1kJVKgGQ2f1xH6awnP4AF
Vi8VORu2AT4G/Q0vP5Onxp0lobPGmuE9PWqoTgZ8Dx+7r+sKbSn0PkJsHdEAAAFdQZokSahBbJlM
CCH//qpVAAEZ5c/aax650AIG8FpViYmZvrC7YKCebpFnTl1Uk7+oXunDbut0px4C+HVLDVXIf18C
u8EzDtIkOCeVE6gBZmmN4MBpMnEoVFqGQ2VAcwmnZnx04ESvxi2AQKQlYJlGyfMvQuhHdrIzwb45
1h7aPZudm5/x+pNirlzVmhUc0OFb8Rg0mmO31VZBeU+N4vHWQxIPvEdT38WbgdVV43nbPl6tgax9
kr+rV4Jo0AuiQ44xzW0DdBVv6svWu+6u79+VyF3x+yLRtrsmxgAnXwQdPI+OWIOqz4KeWfa9uGBz
as5j789cvcGaGnLQpC/AzmXhf7lNTy5BPKkaNzC1TbpNg1FTkL6vZYKCj0pzp5fE9OT5/H7OS986
8uhv78fBEajdvaQ3SdeKDcxmKB2xKKLG1rEgQzSBjT2kbW8btoajN7HJC9DZczSj83QPGqumAQAA
ALNBnkJFFSw7/wACG35/wr6azpACXLElcBbNpFi5wlmMxgwdGCwu7R8hBdtLlmvKmbk5oVO3z5vY
j46siP8k4qePZB5IDMF0Ass2ip1JAzfjJUahf0uHAWYguYYCl0z+0nnkjiqNnMgvsjYJVjMyR/CI
QhLrK5gtZ8sTSSGnHuJlC9p1WyMaTBoXan3jMnnk4NLmuTcBqi6zDxFajo7fdZimByexCVyqaA5f
1swAES+RiVYdMQAAAKYBnmF0Q38AAwh1/Xobd2AATkd/jyBqADneur0Cnbd+rZX4F6tstDLDZzRk
D0stwBMIUNUOflPLrZ4CKzVdYH8ZsRqlnq5U0uP7c2mL1fTioo6IFyo23XiK5BgTpV6iw2ssNx5k
pkCSKqs+lktdMtZpJ/tSbu/1VXp4vHQVDsj01NdtfBk9ICGvqOA8l6rDwvvbC1Ya1TMgpUMnNHg3
4IvPG8GMcRVQAAAAmAGeY2pDfwADDzlYaR5ACXH13Q26shaGVhu5F9buPieZaDRlfYZs8VcpjXlq
bAILgCb/MERvx79OF2QYQzX25ayhYC2jslCSCaMUrH7JEVsmwWM21DnmFhkW0odoQvxSMAuijSEx
bOoYSuenFPrE4mfcxUOMH8QUSN6pLE4lkIWMPvW/3kHf9J9KSoJMKcGW5bSxucneQD5hAAABgEGa
aEmoQWyZTAhv//6nhAAIrS0TcUABDexeFCW/IVpgjs8OvCwwt0u19had4rzR/WXbMtPMX6HF/UQE
bjEK2kvuUlKv/8jTubBvaR2WTC6Fhp4xpC20UZYYpdDwI/N05XLJh826tqP+MW0ol4+hCh0zFa0N
rhdu++SFRMkmU4UQ3H/WqImR9YyMFIpxv1xrB6rGNMuIM1ghDr5+/Jod6Ekdwd8Peg824d7Xkrya
PGKe5V3K6hmOCd5ZhBRQA4tCFWqTBw5QwVJQVLXfN3GO9nywNraggWLerpZ/p7qVlTbD5nz0iOpY
D08s8lYrWXF7q/QDg6ZDo5egqj6uPuBDpVf0j83LvMrs+BzE/bj9PAy5zvAyFATk+ibjJCEtAz53
SvlJNkEToDkQHRaw9DF7nRooSu4tEp+ZeQNxZE5y+WvU4BR4hi7YkUDvKv37N7L/sjcTZZ2ZXr4B
u1DKSgss41m+cxisdD+Oqu3OSIMampK09XbOXRUSZ1bybaVAoNHlzwAAAOpBnoZFFSw7/wACMR+/
NYHtoALW7/lGCYYROYIGBjFN2ODiFrk+eE6TIs4iCoJy5H7tIjHRTgA+UWPEfFBM1AodkRUwGWqS
GMDzA6eMXDQbkEMCG2Am53bPv3TNanVfrLJH2U7AjD4sk2gIN0VN06zGPyVROh6oeo5Cy+tN4pVZ
E4AigTmMyfb5ThFjQR2UF6qYeC0LVBqw8/9zdtq2wnWsvYVJuqAzuk9SVOHpKPmpiRJV6A5tVqea
WhED58oVDg13m4c6B+RQccK+TDZguknTRJ95btG7ClYH+c99uUvngTb0JDQ5OwH4r4EAAAC3AZ6l
dEN/AAMGELvpHVkAJbiDK6HFs95RD+p0vE8lt1U/nnUlP9fUPpVf3kpqaTHlMfDM0JcMvId1U4NN
Jzyou6D/tJIAAph14QC8v654tyDvvYOaFOvQeyRFdEnuBZUvYxGe5Gzz2fdkNkUh1I0Q962cFbu8
zGWgQJEnfTdTfGYYq3rXPnn7IJ7ucCF/o4PkAqpamkLk6GApvKfP/tIIsf0UwIxGPh7jbgqVKIvk
BUyagGOBOAPnAAAAlgGep2pDfwADIr73prvEgA9cRnVbU8rxjRSSZWLKGecU2y6WexApxEZYWHpa
3kuN+pJK50LVpwAwhfyDXL/kk1jDZpviirH4L0dKthF9vhiwCT5rIhSfOJgG6sLcmDWNT4ASo7GW
sKLXzk+hReWSU6JiOF+diSMCXJR7kMVx+5LPEyk+xaX5x/IWq5V+1IHakCC1R1B0wAAABR5tb292
AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAQBAABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA
AAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAESHRy
YWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAQBAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAA
AAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAACgAAAAeAAAAAAACRlZHRzAAAAHGVsc3QAAAAA
AAAAAQAAEAQAAAgAAAEAAAAAA8BtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAACgAAACkAFXEAAAA
AAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAANrbWluZgAAABR2
bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADK3N0
YmwAAAC3c3RzZAAAAAAAAAABAAAAp2F2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAACgAHgAEgA
AABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAA1YXZjQwFk
ABb/4QAYZ2QAFqzZQKA9oQAAAwABAAADABQPFi2WAQAGaOvjyyLA/fj4AAAAABx1dWlka2hA8l8k
T8W6OaUbzwMj8wAAAAAAAAAYc3R0cwAAAAAAAAABAAAAKQAABAAAAAAUc3RzcwAAAAAAAAABAAAA
AQAAAVhjdHRzAAAAAAAAACkAAAABAAAIAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQA
AAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAA
AAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAA
AAEAAAAAAAAAAQAABAAAAAABAAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAA
AQAACAAAAAABAAAAAAAAAAEAAAQAAAAAAQAAFAAAAAABAAAIAAAAAAEAAAAAAAAAAQAABAAAAAAB
AAAUAAAAAAEAAAgAAAAAAQAAAAAAAAABAAAEAAAAAAEAABQAAAAAAQAACAAAAAABAAAAAAAAAAEA
AAQAAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAApAAAAAQAAALhzdHN6AAAAAAAAAAAAAAApAAAHsQAA
AN4AAACHAAAAYAAAAH0AAAC+AAAAowAAAG4AAAB8AAABPgAAAKUAAABzAAAAhgAAAQQAAACMAAAA
cwAAAI8AAAGOAAAAwgAAAHcAAACZAAABmAAAAK4AAAClAAAAeQAAAPwAAAB6AAAAXAAAAJQAAAGT
AAAAuQAAAJkAAACJAAABYQAAALcAAACqAAAAnAAAAYQAAADuAAAAuwAAAJoAAAAUc3RjbwAAAAAA
AAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAA
AAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguNzYuMTAw
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<p>このようにランダムに行動した場合には、途中で棒の傾きが一定以上になってしまい、エピソードが終了していることが分かる。以下では、Q学習によって行動評価関数を最適化し、より長い時間、倒立状態を保てるようにしてみよう。</p>
</section>
<section id="id5">
<h3><span class="section-number">2.3.2. </span>Q学習による行動選択<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>まずはQテーブルを作成するために、4種類のパラメータを離散化しておこう。以下の例では、<strong>速度と各速度の範囲を適当に狭めておき、その上で各パラメータの取り得る範囲を8分割する</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_INPUTS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">N_ACTIONS</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span>
<span class="n">N_DIGITS</span> <span class="o">=</span> <span class="mi">8</span>

<span class="n">lower</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">low</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="o">.</span><span class="n">high</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span>  <span class="c1"># 速度の範囲を修正</span>
<span class="n">lower</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># 角速度の範囲を修正</span>
</pre></div>
</div>
</div>
</div>
<p>今回の倒立振子の例ではパラメータ4つを8分割しているので、取り得る離散状態の組み合わせは<span class="math notranslate nohighlight">\(8^4 = 4096\)</span>通りである。取り得る行動は左に行くか、右に行くかの2種類であるので、結局、Qテーブルのサイズは<span class="math notranslate nohighlight">\(4096 \times 2\)</span>となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q値テーブルの初期化 (乱数による初期化)</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>8分割されたパラメータの範囲を求めるには<code class="docutils literal notranslate"><span class="pre">np.linspace</span></code>関数が使える。この関数はこれまで第1, 第2引数にスカラー値を入力して使ってきたが、サイズが同じであれば配列を指定することもできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">N_DIGITS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-4.8        -3.4285717  -2.057143   -0.68571424  0.68571424  2.0571427
   3.4285717   4.8       ]
 [-5.         -3.5714285  -2.142857   -0.71428585  0.71428585  2.1428576
   3.5714283   5.        ]
 [-0.41887903 -0.2991993  -0.17951958 -0.05983984  0.05983987  0.1795196
   0.29919934  0.41887903]
 [-1.5707964  -1.1219974  -0.67319846 -0.22439945  0.22439945  0.67319834
   1.1219975   1.5707964 ]]
</pre></div>
</div>
</div>
</div>
<p>今、とある状態変数が与えられた時に、それが4096個の離散状態のどれに対応するのかを定めておく必要がある。</p>
<p>これには、4つあるパラメータのそれぞれが8個の範囲のどれに入るのかを求めて、その値を元に状態を表わす整数を計算する必要がある。</p>
<p>各パラメータが8つの範囲のどれに属するかを求めるには<code class="docutils literal notranslate"><span class="pre">np.digitize</span></code>関数が使える。4つのパラメータのそれぞれについて、リスト内包表記によって所属する範囲のインデックスを求めるとすれば、以下のようなコードになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 4, 4, 4]
</pre></div>
</div>
</div>
</div>
<p>現在は各パラメータの範囲を8つに分割しているので、<code class="docutils literal notranslate"><span class="pre">digits</span></code>には0-7の整数が与えられる。従って、この数字を8進数であると考えて、10進数表記に直せば、各離散状態に対して重複のない整数のインデックスを付与することができる。</p>
<p>このような計算は、単純には以下のようなfor文を用いたコードで実現できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">n</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>もう少しPythonらしい書き方にするのであれば、<code class="docutils literal notranslate"><span class="pre">functools.reduce</span></code>関数を用いて以下のように書くこともできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2340
</pre></div>
</div>
</div>
</div>
<p>これを踏まえて、状態を表わすインデックスを計算するコードを関数化しておく。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">*</span> <span class="n">N_DIGITS</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">digits</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="varepsilon-greedyq">
<h3><span class="section-number">2.3.3. </span><span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新<a class="headerlink" href="#varepsilon-greedyq" title="Permalink to this heading">#</a></h3>
<p>ここまでで下準備が整ったので、前回<a class="reference internal" href="reinforcement-learning.html#sec-reinforcement-learning"><span class="std std-ref">強化学習の基礎</span></a>の節で紹介した<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いてQ学習を実行してみる。</p>
<p>Q学習においては、とある状態<span class="math notranslate nohighlight">\(s\)</span>において<strong>何らかの方策</strong>によって行動<span class="math notranslate nohighlight">\(a\)</span>を決定し、行動後の状態<span class="math notranslate nohighlight">\(s'\)</span>を得る。その後、<span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(s'\)</span>の組に基づき、<a class="reference internal" href="#equation-eq-q-update">(2.11)</a>に従ってQテーブルを更新する。</p>
<p>この際、行動<span class="math notranslate nohighlight">\(a\)</span>を決定する際に用いる方策に、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の他、前節で紹介した手法が使える。</p>
<p>Q学習で<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法を用いる場合、多腕バンディット問題の時と同様、適当な<span class="math notranslate nohighlight">\(0 &lt; \varepsilon &lt; 1\)</span>を決めておき、<span class="math notranslate nohighlight">\(\varepsilon\)</span>の確率でランダムな行動を、<span class="math notranslate nohighlight">\(1-\varepsilon\)</span>の確率でQテーブルに基づいた最適な行動を取れば良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ランダムに行動する</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 一番価値が高く見積もられている行動をとる</span>
<span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>今回は、以下のハイパーパラメータを用いてQ学習を行う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Q学習のハイパーパラメータ</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.99</span>
<span class="n">n_episodes</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
</div>
</div>
<p>また、多腕バンディット問題の時と同様に<span class="math notranslate nohighlight">\(\varepsilon\)</span>の値はエピソードが進むごとに徐々に小さい値になるようにスケジューリングしておく。</p>
<p>以下が、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQ学習のコードの一例である。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e0</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">e1</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">e_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_episodes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">e0</span>

<span class="c1"># Q値テーブルの初期化</span>
<span class="n">q_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N_DIGITS</span><span class="o">**</span><span class="n">N_INPUTS</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>

<span class="k">for</span> <span class="n">epi</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_episodes</span><span class="p">)):</span>
    <span class="c1"># ゲーム環境のリセット</span>
    <span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="c1"># エピソード開始</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># 現在の状態に対応する行番号を計算</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># ε-greedy法による行動選択</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

        <span class="c1"># 状態の更新</span>
        <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="c1"># 新たな状態に対する行番号を計算</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>

        <span class="c1"># Qテーブルの更新</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>
        <span class="n">best_q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">q0</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">reward</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">best_q1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># epsilonの更新</span>
    <span class="n">epsilon</span> <span class="o">*=</span> <span class="n">e_scale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "11eb028e7ed040b3bd6224e78392a80f"}</script></div>
</div>
<p>学習が終了したら、実行フェーズにおいては、常にQテーブルに基づいて最適な行動を取ることとする。</p>
<p>状態の画像を保存しつつ、学習結果に基づいて行動をするコードは以下の通りである。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">obsrv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># 最もQ値の高い行動を選択</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="n">to_state_index</span><span class="p">(</span><span class="n">obsrv</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">q_table</span><span class="p">[</span><span class="n">s0</span><span class="p">,</span> <span class="p">:])</span>

    <span class="n">obsrv</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># アニメーションの描画</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>

<span class="c1"># 各フレームの描画</span>
<span class="n">draw</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
    <span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;frame #</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ims</span><span class="p">,</span> <span class="n">txt</span><span class="p">])</span>

<span class="c1"># アニメーションの作成</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">ArtistAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">draw</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">ani</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Matplotlibのウィンドウを閉じる</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><video width="640" height="480" controls autoplay loop>
  <source type="video/mp4" src="data:video/mp4;base64,AAAAIGZ0eXBNNFYgAAACAE00ViBpc29taXNvMmF2YzEAAAAIZnJlZQAALmptZGF0AAACrgYF//+q
3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE2MyByMzA2MCA1ZGI2YWE2IC0gSC4yNjQvTVBF
Ry00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAyMSAtIGh0dHA6Ly93d3cudmlkZW9sYW4u
b3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFs
eXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVk
X3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBk
ZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTYg
bG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRl
cmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJf
cHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9
MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEwIHNjZW5lY3V0PTQwIGludHJhX3Jl
ZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAu
NjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAF
TmWIhAAR//73iB8yy2n5OtdyEeetLq0fUO5GcV6kvf4gAAADAAADAABlQN8pUH95cNzgAAAE8AC6
hI0F/gtX+ID9XvlWyqSgZCWiIjzIIyfgWgRUAUQKEL++XDpwzYLO23ANSIuSS40yX94eU3b3HoCQ
fKZIxfzFCTWtRVNIzCYKdiE3gsQUICbD6KyaM2Xg0DR5gW0pZhFlrrD/rU7UfftTuwG4lbdXEV03
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
AAAAAExhdmY1OC43Ni4xMDA=
">
  Your browser does not support the video tag.
</video></div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">glue</span><span class="p">(</span><span class="s2">&quot;n_episodes&quot;</span><span class="p">,</span> <span class="n">n_episodes</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;glue&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>今回はエピソードしか学習を行なっていないが、それでもランダムの時と比較して、かなり長い時間に渡り振子を倒れないようにキープできていることが分かる。</p>
<p>エピソードの数を増やしたり、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法以外の方法を用いた場合に、どのように学習結果が変化するかについては、ぜひ自信でコードを修正して試してみてほしい。</p>
</section>
</section>
<section id="id6">
<h2><span class="section-number">2.4. </span>練習問題<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>CartPole環境において、<span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法の部分をソフトマックス探索やUCB1値を用いた探索に置き換えて、学習の性能がどのように変化するかを調べよ。</p></li>
<li><p>CartPole環境は1フレームごとに報酬として常に1を返してくるが、この値を画面中央にCartがある場合に高い値になるように更新することで、できる限り画面の内側で振子を保つように学習方法を変更せよ。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/sec3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reinforcement-learning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">前へ</p>
        <p class="prev-next-title"><span class="section-number">1. </span>強化学習の基礎</p>
      </div>
    </a>
    <a class="right-next"
       href="othello-agent.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">次へ</p>
        <p class="prev-next-title"><span class="section-number">3. </span>オセロAIの作成</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目次
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.1. 背景</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.2. アルゴリズム</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.3. 倒立振子のバランシング</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.1. ランダムな行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.3.2. Q学習による行動選択</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varepsilon-greedyq">2.3.3. <span class="math notranslate nohighlight">\(\varepsilon\)</span>-greedy法によるQテーブルの更新</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.4. 練習問題</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
著者 Tatsuya Yatagawa
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright CC BY-NC-SA 4.0, 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>