

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1. データ可視化と次元圧縮 &#8212; 機械学習発展 (実践)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0ebd66e1c3554a088f963a6b42cfb9a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "74ddc330d47b4dc7a620c432126a392d": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "70e58f5ae8c9493992d3092bab611b56": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0ebd66e1c3554a088f963a6b42cfb9a0", "max": 20.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_74ddc330d47b4dc7a620c432126a392d", "tabbable": null, "tooltip": null, "value": 20.0}}, "c82168f347d74c3ca1feb9b5819e16cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d8166056e0f452b94019fa56b937d3e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "23b9ce883b8949548162e88d00abdeb2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c82168f347d74c3ca1feb9b5819e16cc", "placeholder": "\u200b", "style": "IPY_MODEL_8d8166056e0f452b94019fa56b937d3e", "tabbable": null, "tooltip": null, "value": "100%"}}, "9a366ba3dd5b4f73b406a817c82f1499": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6a155bab447f414799f3a861a6a6ac5c": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "9be6ef4bf1ce4144b4740d069ac72584": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9a366ba3dd5b4f73b406a817c82f1499", "placeholder": "\u200b", "style": "IPY_MODEL_6a155bab447f414799f3a861a6a6ac5c", "tabbable": null, "tooltip": null, "value": " 20/20 [00:04&lt;00:00,  4.46it/s]"}}, "5b74c8db5b6e4f03a551e4b3dfef3216": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7631587477f2425fa9b6a871569d3e48": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_23b9ce883b8949548162e88d00abdeb2", "IPY_MODEL_70e58f5ae8c9493992d3092bab611b56", "IPY_MODEL_9be6ef4bf1ce4144b4740d069ac72584"], "layout": "IPY_MODEL_5b74c8db5b6e4f03a551e4b3dfef3216", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/sec2/data-visualization';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. 特徴量抽出" href="feature-extraction.html" />
    <link rel="prev" title="8. 演習1 - 画像入力式数独ソルバーを作る" href="../sec1/exercise-sudoku.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">機械学習発展 (実践)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">第1部 画像読み取り式数独ソルバの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec1/setup-python.html">1. Python環境の設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/numpy.html">2. NumPyの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/matplotlib.html">3. Matplotlibの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/pandas.html">4. Pandasの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/opencv.html">5. OpenCVの基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/scikit-learn.html">6. scikit-learnによる機械分類の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/figure-detection.html">7. 図形の検出</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec1/exercise-sudoku.html">8. 演習1 - 画像入力式数独ソルバーを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第2部 ひらがなOCRソフトと百人一首エージェントの実装</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1. データ可視化と次元圧縮</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-extraction.html">2. 特徴量抽出</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-learning.html">3. 深層学習による物体認識</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercise-ogura.html">4. 演習2 - 百人一首エージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">第3部 強化学習の基礎とリバーシエージェントの実装</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sec3/reinforcement-learning.html">1. 強化学習の基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec3/q-learning.html">2. Q学習</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec3/othello-agent.html">3. オセロAIの作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec3/deep-reinforcement-learning.html">4. 深層強化学習</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sec3/exercise-othello.html">5. 演習3 - オセロエージェントを作る</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/notation.html">1. 資料中の記号について</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/tatsy/1284-sds-ml-advanced/blob/master/contents/contents/sec2/data-visualization.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/sec2/data-visualization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>データ可視化と次元圧縮</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">1.1. 主成分分析 (PCA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.1.1. 主成分分析の画像的な意味</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mds">1.2. 多次元尺度構成法 (MDS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isomap">1.2.1. Isomapによる次元圧縮</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lle">1.2.2. LLEによる次元圧縮</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.3. 練習問題</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sec-data-visualization">
<span id="id1"></span><h1><span class="section-number">1. </span>データ可視化と次元圧縮<a class="headerlink" href="#sec-data-visualization" title="Permalink to this heading">#</a></h1>
<p>機械学習において、データを扱う際には、データそのものがどのような性質を持っているかをよ事前に調べておくことが有効である。しかし、多くのデータは多次元のデータであるため、そのままデータがどのような分布になっているかを見ることは難しい。</p>
<p>そこで、データを2次元や3次元といった、人間にとって理解のしやすい次元に落として、データの分布の様子を見ることが必要になる。ここで用いるのが<strong>次元圧縮</strong>である。</p>
<p>次元圧縮には<strong>線形</strong>の次元圧縮と<strong>非線形</strong>の次元圧縮があり、線形の手法は、元のデータに何らかの行列を作用させて、低次元のベクトルを得る。それに対し、非線形の手法は元のデータを入力とする多変数関数を定義することで低次元のベクトルを得る。</p>
<p>次元圧縮を考える際、実際のデータは<strong>高次元空間にランダムに存在している訳ではなく、ある程度の規則に従って散らばっている</strong>ことを意識しておくことが大切である。このようなデータの散らばりは、ある程度、高次元空間上の曲面付近での散らばりと見なせることが多い。この曲面の構造をある種の<strong>多様体</strong>であると見なして、低次元空間への埋め込みを行う方法を、特に<strong>多様体学習</strong>と呼ぶ。</p>
<p>今回は、以下のスイスロールのデータとMNISTのデータを題材に次元圧縮と可視化の方法について見ていこう。</p>
<p><strong>スイスロールのデータ</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1"># 実験に用いるサンプル数</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># データセットの取り出し</span>
<span class="n">X_sr</span><span class="p">,</span> <span class="n">y_sr</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_swiss_roll</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># yの値を正規化して、色情報に変換しておく</span>
<span class="n">y_sr</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_sr</span> <span class="o">-</span> <span class="n">y_sr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">y_sr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">y_sr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">y_sr</span><span class="p">)</span>

<span class="c1"># 三次元プロットの表示</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_sr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Swiss Roll&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equalyz&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f2747eaf0e490bdd49a0d064fa29594f91595d0fd9789ee427ef6dfffc6f1a14.png" src="../../_images/f2747eaf0e490bdd49a0d064fa29594f91595d0fd9789ee427ef6dfffc6f1a14.png" />
</div>
</div>
<p><strong>MNISTのデータ</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 以下のコードはデータのダウンロードを伴うため、少々時間がかかる</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_openml</span><span class="p">(</span><span class="s2">&quot;mnist_784&quot;</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="s2">&quot;./mnist&quot;</span><span class="p">,</span> <span class="n">parser</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 画像として見られるように配列の形を変更</span>
<span class="n">ims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

<span class="c1"># 最初の5枚を確認してみる</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ims</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;label is </span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6f645e901668f4c3d3402c921f1c9dec53dfbca8b046ac038741359150985495.png" src="../../_images/6f645e901668f4c3d3402c921f1c9dec53dfbca8b046ac038741359150985495.png" />
</div>
</div>
<p>例のごとく、実験にかかる時間を短縮するために、先頭数個のデータだけを実験に用いる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>

<span class="n">X</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">60000</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="pca">
<h2><span class="section-number">1.1. </span>主成分分析 (PCA)<a class="headerlink" href="#pca" title="Permalink to this heading">#</a></h2>
<p><strong>主成分分析</strong> (PCA = Principal Component Analysis)は、データの散らばりが大きい方向に沿うように軸を取って次元圧縮を行う方法である。例えば、2次元空間に射影を行う場合、最も分散が大きな方向と次に分散が大きな方向を計算して、その2つの方向を基底ベクトルとして定義される低次元空間への射影を行う。</p>
<p>このようなデータの散らばりの性質を調べるには、データから定まる分散共分散行列を用いる。分散共分散行列はその固有ベクトルが散らばりの方向を、固有値が散らばりの大きさを表わす。</p>
<p>なお、本資料においては、与えられたデータ<span class="math notranslate nohighlight">\(\mathcal{X} = \{ \mathbf{x}_1, \ldots, \mathbf{x}_N \}\)</span>が標本ではなく、全てのデータを代表していると考えて、以下のように平均<span class="math notranslate nohighlight">\(\boldsymbol\mu\)</span>や分散共分散行列<span class="math notranslate nohighlight">\(\mathbf{C}\)</span>を計算する (情報科学の分野では、厳密性を排除して、このように計算することが多い)。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\boldsymbol\mu &amp;= \frac{1}{N} \sum_{i=1}^N \mathbf{x}_i \\
\mathbf{C} &amp;= \frac{1}{N} \sum_{i=1}^N (\bar{\mathbf{x}} - \mathbf{x}_i) (\bar{\mathbf{x}} - \mathbf{x}_i)^\top 
\end{aligned}
\end{split}\]</div>
<p>NumPyを用いて、平均と分散共分散行列を計算すると、以下のようになる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 分散共分散行列の計算</span>
<span class="n">mu_sr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_sr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">C_sr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">X_sr</span> <span class="o">-</span> <span class="n">mu_sr</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X_sr</span> <span class="o">-</span> <span class="n">mu_sr</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_samples</span>
</pre></div>
</div>
</div>
</div>
<p>分散共分散行列は実対称行列であるので、固有値と固有ベクトルが必ず実数で求まる(実非対称行列の場合には、固有値や固有ベクトルが複素数になることがある)。固有値を求める場合は<code class="docutils literal notranslate"><span class="pre">np.linalg.eig</span></code>ではなく<code class="docutils literal notranslate"><span class="pre">np.linalg.eigh</span></code>を用いると、より効率が良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 固有値分解</span>
<span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">C_sr</span><span class="p">)</span>

<span class="c1"># 固有値が大きい順にソートして、先頭の2つを取り出す</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">eigval</span><span class="p">))</span>
<span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># 固有ベクトルの方向にデータを射影する</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">X_sr</span> <span class="o">@</span> <span class="n">eigvec</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Swiss Roll (PCA)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0015cbf75cabac078800dac27b4874ac8a27ddad5e26bb3530dfc8961078432f.png" src="../../_images/0015cbf75cabac078800dac27b4874ac8a27ddad5e26bb3530dfc8961078432f.png" />
</div>
</div>
<p>スイスロールのデータを二次元空間にPCAで射影してみると、予想通り、データの散らばりが大きなx軸方向とz軸方向を基底ベクトルとするxz平面上に射影されていることが分かる。</p>
<section id="id2">
<h3><span class="section-number">1.1.1. </span>主成分分析の画像的な意味<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>次にMNISTのデータについて主成分分析をかけてみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">mu</span><span class="p">))</span> <span class="o">/</span> <span class="n">n_samples</span>

<span class="c1"># 固有値分解</span>
<span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="c1"># 固有値が大きい順にソートして、先頭の5つを取り出す</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">eigval</span><span class="p">))</span>
<span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
<span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 画像として見られるように配列の形を変更</span>
<span class="n">ims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">eigvec</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>

<span class="c1"># 最初の5枚を確認してみる</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ims</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c813f8accec5536dc46ca8b238ff380d0e0a007dcb20d40d07e87f574357bb10.png" src="../../_images/c813f8accec5536dc46ca8b238ff380d0e0a007dcb20d40d07e87f574357bb10.png" />
</div>
</div>
<p>このように得られる固有ベクトルを画像としてみてみると、0から9の数字の影のようなものが見える。定性的には、これらの画像は数字の画像の共通成分のようなものを表わしており、これらの画像の線形結合を取ると、0-9に近しい画像が作れる、というわけである。</p>
<p>以下に、上記の5枚の画像をブレンドすることで、対話的に画像を変更できるシステムを用意してあるので、各自、スライダーを動かすことで画像がどのように変化するかを確認してみてほしい。</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Slider</span><span class="p">,</span> <span class="n">CustomJS</span><span class="p">,</span> <span class="n">ColumnDataSource</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">show</span><span class="p">,</span> <span class="n">figure</span><span class="p">,</span> <span class="n">output_notebook</span>

<span class="n">output_notebook</span><span class="p">()</span>

<span class="n">ws</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ims</span><span class="p">)))</span>
<span class="n">im_avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">w</span> <span class="o">*</span> <span class="n">im</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">ims</span><span class="p">)])</span>

<span class="n">plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">match_aspect</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tooltips</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;$x&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;$y&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;@image&quot;</span><span class="p">)],</span>
<span class="p">)</span>

<span class="n">w1</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;w1&quot;</span><span class="p">)</span>
<span class="n">w2</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;w2&quot;</span><span class="p">)</span>
<span class="n">w3</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ws</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;w3&quot;</span><span class="p">)</span>
<span class="n">w4</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ws</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;w4&quot;</span><span class="p">)</span>
<span class="n">w5</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">ws</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;w5&quot;</span><span class="p">)</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;im_avg&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">im_avg</span><span class="p">],</span>
        <span class="s2">&quot;im1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ims</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="s2">&quot;im2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ims</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="s2">&quot;im3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ims</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
        <span class="s2">&quot;im4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ims</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
        <span class="s2">&quot;im5&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ims</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">image</span><span class="p">(</span>
    <span class="n">image</span><span class="o">=</span><span class="s2">&quot;im_avg&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">dw</span><span class="o">=</span><span class="n">im_avg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">dh</span><span class="o">=</span><span class="n">im_avg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Greys256&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">callback</span> <span class="o">=</span> <span class="n">CustomJS</span><span class="p">(</span>
    <span class="n">args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span> <span class="s2">&quot;w1&quot;</span><span class="p">:</span> <span class="n">w1</span><span class="p">,</span> <span class="s2">&quot;w2&quot;</span><span class="p">:</span> <span class="n">w2</span><span class="p">,</span> <span class="s2">&quot;w3&quot;</span><span class="p">:</span> <span class="n">w3</span><span class="p">,</span> <span class="s2">&quot;w4&quot;</span><span class="p">:</span> <span class="n">w4</span><span class="p">,</span> <span class="s2">&quot;w5&quot;</span><span class="p">:</span> <span class="n">w5</span><span class="p">},</span>
    <span class="n">code</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   // Get image data</span>
<span class="s2">   const im_avg = source.data[&#39;im_avg&#39;][0];</span>
<span class="s2">   const im1 = source.data.im1[0];</span>
<span class="s2">   const im2 = source.data.im2[0];</span>
<span class="s2">   const im3 = source.data.im3[0];</span>
<span class="s2">   const im4 = source.data.im4[0];</span>
<span class="s2">   const im5 = source.data.im5[0];</span>

<span class="s2">   // Get weights</span>
<span class="s2">   const w1_ = w1.value;</span>
<span class="s2">   const w2_ = w2.value;</span>
<span class="s2">   const w3_ = w3.value;</span>
<span class="s2">   const w4_ = w4.value;</span>
<span class="s2">   const w5_ = w5.value;</span>

<span class="s2">   // Image blending</span>
<span class="s2">   for (let i = 0; i &lt; im_avg.length; i++) {</span>
<span class="s2">        im_avg[i] = w1_ * im1[i] + w2_ * im2[i] + w3_ * im3[i] + w4_ * im4[i] + w5_ * im5[i];</span>
<span class="s2">   }</span>
<span class="s2">   source.change.emit();</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">w1</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">w2</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">w3</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">w4</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">w5</span><span class="o">.</span><span class="n">js_on_change</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">row</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">column</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span><span class="p">,</span> <span class="n">w4</span><span class="p">,</span> <span class="n">w5</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style>
        .bk-notebook-logo {
            display: block;
            width: 20px;
            height: 20px;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
        }
    </style>
    <div>
        <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
        <span id="e3b8be42-3202-4278-ab1b-2c0ca3178f05">Loading BokehJS ...</span>
    </div>
</div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    const el = document.getElementById("e3b8be42-3202-4278-ab1b-2c0ca3178f05");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.2.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.2.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.2.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.2.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.2.2.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
          for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("e3b8be42-3202-4278-ab1b-2c0ca3178f05")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><div class="output text_html">
  <div id="a1f3861c-33a4-47a5-a898-9651be0cc723" data-root-id="p1055" style="display: contents;"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
  const docs_json = {"cb46c9a7-a45b-4113-b20d-d5e0dc9cd865":{"version":"3.2.2","title":"Bokeh Application","roots":[{"type":"object","name":"Row","id":"p1055","attributes":{"children":[{"type":"object","name":"Figure","id":"p1001","attributes":{"width":300,"height":300,"x_range":{"type":"object","name":"DataRange1d","id":"p1002"},"y_range":{"type":"object","name":"DataRange1d","id":"p1003"},"x_scale":{"type":"object","name":"LinearScale","id":"p1010"},"y_scale":{"type":"object","name":"LinearScale","id":"p1011"},"title":{"type":"object","name":"Title","id":"p1008"},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1050","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1035","attributes":{"selected":{"type":"object","name":"Selection","id":"p1036","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1037"},"data":{"type":"map","entries":[["im_avg",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]],["im1",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]],["im2",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]],["im3",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]],["im4",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]],["im5",[{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[28,28],"dtype":"float64","order":"little"}]]]}}},"view":{"type":"object","name":"CDSView","id":"p1051","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1052"}}},"glyph":{"type":"object","name":"Image","id":"p1041","attributes":{"x":{"type":"value","value":0},"y":{"type":"value","value":0},"dw":{"type":"value","value":28},"dh":{"type":"value","value":28},"image":{"type":"field","field":"im_avg"},"color_mapper":{"type":"object","name":"LinearColorMapper","id":"p1042","attributes":{"palette":["#000000","#010101","#020202","#030303","#040404","#050505","#060606","#070707","#080808","#090909","#0a0a0a","#0b0b0b","#0c0c0c","#0d0d0d","#0e0e0e","#0f0f0f","#101010","#111111","#121212","#131313","#141414","#151515","#161616","#171717","#181818","#191919","#1a1a1a","#1b1b1b","#1c1c1c","#1d1d1d","#1e1e1e","#1f1f1f","#202020","#212121","#222222","#232323","#242424","#252525","#262626","#272727","#282828","#292929","#2a2a2a","#2b2b2b","#2c2c2c","#2d2d2d","#2e2e2e","#2f2f2f","#303030","#313131","#323232","#333333","#343434","#353535","#363636","#373737","#383838","#393939","#3a3a3a","#3b3b3b","#3c3c3c","#3d3d3d","#3e3e3e","#3f3f3f","#404040","#414141","#424242","#434343","#444444","#454545","#464646","#474747","#484848","#494949","#4a4a4a","#4b4b4b","#4c4c4c","#4d4d4d","#4e4e4e","#4f4f4f","#505050","#515151","#525252","#535353","#545454","#555555","#565656","#575757","#585858","#595959","#5a5a5a","#5b5b5b","#5c5c5c","#5d5d5d","#5e5e5e","#5f5f5f","#606060","#616161","#626262","#636363","#646464","#656565","#666666","#676767","#686868","#696969","#6a6a6a","#6b6b6b","#6c6c6c","#6d6d6d","#6e6e6e","#6f6f6f","#707070","#717171","#727272","#737373","#747474","#757575","#767676","#777777","#787878","#797979","#7a7a7a","#7b7b7b","#7c7c7c","#7d7d7d","#7e7e7e","#7f7f7f","#808080","#818181","#828282","#838383","#848484","#858585","#868686","#878787","#888888","#898989","#8a8a8a","#8b8b8b","#8c8c8c","#8d8d8d","#8e8e8e","#8f8f8f","#909090","#919191","#929292","#939393","#949494","#959595","#969696","#979797","#989898","#999999","#9a9a9a","#9b9b9b","#9c9c9c","#9d9d9d","#9e9e9e","#9f9f9f","#a0a0a0","#a1a1a1","#a2a2a2","#a3a3a3","#a4a4a4","#a5a5a5","#a6a6a6","#a7a7a7","#a8a8a8","#a9a9a9","#aaaaaa","#ababab","#acacac","#adadad","#aeaeae","#afafaf","#b0b0b0","#b1b1b1","#b2b2b2","#b3b3b3","#b4b4b4","#b5b5b5","#b6b6b6","#b7b7b7","#b8b8b8","#b9b9b9","#bababa","#bbbbbb","#bcbcbc","#bdbdbd","#bebebe","#bfbfbf","#c0c0c0","#c1c1c1","#c2c2c2","#c3c3c3","#c4c4c4","#c5c5c5","#c6c6c6","#c7c7c7","#c8c8c8","#c9c9c9","#cacaca","#cbcbcb","#cccccc","#cdcdcd","#cecece","#cfcfcf","#d0d0d0","#d1d1d1","#d2d2d2","#d3d3d3","#d4d4d4","#d5d5d5","#d6d6d6","#d7d7d7","#d8d8d8","#d9d9d9","#dadada","#dbdbdb","#dcdcdc","#dddddd","#dedede","#dfdfdf","#e0e0e0","#e1e1e1","#e2e2e2","#e3e3e3","#e4e4e4","#e5e5e5","#e6e6e6","#e7e7e7","#e8e8e8","#e9e9e9","#eaeaea","#ebebeb","#ececec","#ededed","#eeeeee","#efefef","#f0f0f0","#f1f1f1","#f2f2f2","#f3f3f3","#f4f4f4","#f5f5f5","#f6f6f6","#f7f7f7","#f8f8f8","#f9f9f9","#fafafa","#fbfbfb","#fcfcfc","#fdfdfd","#fefefe","#ffffff"]}}}},"nonselection_glyph":{"type":"object","name":"Image","id":"p1044","attributes":{"x":{"type":"value","value":0},"y":{"type":"value","value":0},"dw":{"type":"value","value":28},"dh":{"type":"value","value":28},"global_alpha":{"type":"value","value":0.1},"image":{"type":"field","field":"im_avg"},"color_mapper":{"type":"object","name":"LinearColorMapper","id":"p1045","attributes":{"palette":["#000000","#010101","#020202","#030303","#040404","#050505","#060606","#070707","#080808","#090909","#0a0a0a","#0b0b0b","#0c0c0c","#0d0d0d","#0e0e0e","#0f0f0f","#101010","#111111","#121212","#131313","#141414","#151515","#161616","#171717","#181818","#191919","#1a1a1a","#1b1b1b","#1c1c1c","#1d1d1d","#1e1e1e","#1f1f1f","#202020","#212121","#222222","#232323","#242424","#252525","#262626","#272727","#282828","#292929","#2a2a2a","#2b2b2b","#2c2c2c","#2d2d2d","#2e2e2e","#2f2f2f","#303030","#313131","#323232","#333333","#343434","#353535","#363636","#373737","#383838","#393939","#3a3a3a","#3b3b3b","#3c3c3c","#3d3d3d","#3e3e3e","#3f3f3f","#404040","#414141","#424242","#434343","#444444","#454545","#464646","#474747","#484848","#494949","#4a4a4a","#4b4b4b","#4c4c4c","#4d4d4d","#4e4e4e","#4f4f4f","#505050","#515151","#525252","#535353","#545454","#555555","#565656","#575757","#585858","#595959","#5a5a5a","#5b5b5b","#5c5c5c","#5d5d5d","#5e5e5e","#5f5f5f","#606060","#616161","#626262","#636363","#646464","#656565","#666666","#676767","#686868","#696969","#6a6a6a","#6b6b6b","#6c6c6c","#6d6d6d","#6e6e6e","#6f6f6f","#707070","#717171","#727272","#737373","#747474","#757575","#767676","#777777","#787878","#797979","#7a7a7a","#7b7b7b","#7c7c7c","#7d7d7d","#7e7e7e","#7f7f7f","#808080","#818181","#828282","#838383","#848484","#858585","#868686","#878787","#888888","#898989","#8a8a8a","#8b8b8b","#8c8c8c","#8d8d8d","#8e8e8e","#8f8f8f","#909090","#919191","#929292","#939393","#949494","#959595","#969696","#979797","#989898","#999999","#9a9a9a","#9b9b9b","#9c9c9c","#9d9d9d","#9e9e9e","#9f9f9f","#a0a0a0","#a1a1a1","#a2a2a2","#a3a3a3","#a4a4a4","#a5a5a5","#a6a6a6","#a7a7a7","#a8a8a8","#a9a9a9","#aaaaaa","#ababab","#acacac","#adadad","#aeaeae","#afafaf","#b0b0b0","#b1b1b1","#b2b2b2","#b3b3b3","#b4b4b4","#b5b5b5","#b6b6b6","#b7b7b7","#b8b8b8","#b9b9b9","#bababa","#bbbbbb","#bcbcbc","#bdbdbd","#bebebe","#bfbfbf","#c0c0c0","#c1c1c1","#c2c2c2","#c3c3c3","#c4c4c4","#c5c5c5","#c6c6c6","#c7c7c7","#c8c8c8","#c9c9c9","#cacaca","#cbcbcb","#cccccc","#cdcdcd","#cecece","#cfcfcf","#d0d0d0","#d1d1d1","#d2d2d2","#d3d3d3","#d4d4d4","#d5d5d5","#d6d6d6","#d7d7d7","#d8d8d8","#d9d9d9","#dadada","#dbdbdb","#dcdcdc","#dddddd","#dedede","#dfdfdf","#e0e0e0","#e1e1e1","#e2e2e2","#e3e3e3","#e4e4e4","#e5e5e5","#e6e6e6","#e7e7e7","#e8e8e8","#e9e9e9","#eaeaea","#ebebeb","#ececec","#ededed","#eeeeee","#efefef","#f0f0f0","#f1f1f1","#f2f2f2","#f3f3f3","#f4f4f4","#f5f5f5","#f6f6f6","#f7f7f7","#f8f8f8","#f9f9f9","#fafafa","#fbfbfb","#fcfcfc","#fdfdfd","#fefefe","#ffffff"]}}}},"muted_glyph":{"type":"object","name":"Image","id":"p1047","attributes":{"x":{"type":"value","value":0},"y":{"type":"value","value":0},"dw":{"type":"value","value":28},"dh":{"type":"value","value":28},"global_alpha":{"type":"value","value":0.2},"image":{"type":"field","field":"im_avg"},"color_mapper":{"type":"object","name":"LinearColorMapper","id":"p1048","attributes":{"palette":["#000000","#010101","#020202","#030303","#040404","#050505","#060606","#070707","#080808","#090909","#0a0a0a","#0b0b0b","#0c0c0c","#0d0d0d","#0e0e0e","#0f0f0f","#101010","#111111","#121212","#131313","#141414","#151515","#161616","#171717","#181818","#191919","#1a1a1a","#1b1b1b","#1c1c1c","#1d1d1d","#1e1e1e","#1f1f1f","#202020","#212121","#222222","#232323","#242424","#252525","#262626","#272727","#282828","#292929","#2a2a2a","#2b2b2b","#2c2c2c","#2d2d2d","#2e2e2e","#2f2f2f","#303030","#313131","#323232","#333333","#343434","#353535","#363636","#373737","#383838","#393939","#3a3a3a","#3b3b3b","#3c3c3c","#3d3d3d","#3e3e3e","#3f3f3f","#404040","#414141","#424242","#434343","#444444","#454545","#464646","#474747","#484848","#494949","#4a4a4a","#4b4b4b","#4c4c4c","#4d4d4d","#4e4e4e","#4f4f4f","#505050","#515151","#525252","#535353","#545454","#555555","#565656","#575757","#585858","#595959","#5a5a5a","#5b5b5b","#5c5c5c","#5d5d5d","#5e5e5e","#5f5f5f","#606060","#616161","#626262","#636363","#646464","#656565","#666666","#676767","#686868","#696969","#6a6a6a","#6b6b6b","#6c6c6c","#6d6d6d","#6e6e6e","#6f6f6f","#707070","#717171","#727272","#737373","#747474","#757575","#767676","#777777","#787878","#797979","#7a7a7a","#7b7b7b","#7c7c7c","#7d7d7d","#7e7e7e","#7f7f7f","#808080","#818181","#828282","#838383","#848484","#858585","#868686","#878787","#888888","#898989","#8a8a8a","#8b8b8b","#8c8c8c","#8d8d8d","#8e8e8e","#8f8f8f","#909090","#919191","#929292","#939393","#949494","#959595","#969696","#979797","#989898","#999999","#9a9a9a","#9b9b9b","#9c9c9c","#9d9d9d","#9e9e9e","#9f9f9f","#a0a0a0","#a1a1a1","#a2a2a2","#a3a3a3","#a4a4a4","#a5a5a5","#a6a6a6","#a7a7a7","#a8a8a8","#a9a9a9","#aaaaaa","#ababab","#acacac","#adadad","#aeaeae","#afafaf","#b0b0b0","#b1b1b1","#b2b2b2","#b3b3b3","#b4b4b4","#b5b5b5","#b6b6b6","#b7b7b7","#b8b8b8","#b9b9b9","#bababa","#bbbbbb","#bcbcbc","#bdbdbd","#bebebe","#bfbfbf","#c0c0c0","#c1c1c1","#c2c2c2","#c3c3c3","#c4c4c4","#c5c5c5","#c6c6c6","#c7c7c7","#c8c8c8","#c9c9c9","#cacaca","#cbcbcb","#cccccc","#cdcdcd","#cecece","#cfcfcf","#d0d0d0","#d1d1d1","#d2d2d2","#d3d3d3","#d4d4d4","#d5d5d5","#d6d6d6","#d7d7d7","#d8d8d8","#d9d9d9","#dadada","#dbdbdb","#dcdcdc","#dddddd","#dedede","#dfdfdf","#e0e0e0","#e1e1e1","#e2e2e2","#e3e3e3","#e4e4e4","#e5e5e5","#e6e6e6","#e7e7e7","#e8e8e8","#e9e9e9","#eaeaea","#ebebeb","#ececec","#ededed","#eeeeee","#efefef","#f0f0f0","#f1f1f1","#f2f2f2","#f3f3f3","#f4f4f4","#f5f5f5","#f6f6f6","#f7f7f7","#f8f8f8","#f9f9f9","#fafafa","#fbfbfb","#fcfcfc","#fdfdfd","#fefefe","#ffffff"]}}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1009","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1022"},{"type":"object","name":"WheelZoomTool","id":"p1023"},{"type":"object","name":"BoxZoomTool","id":"p1024","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1025","attributes":{"syncable":false,"level":"overlay","visible":false,"left_units":"canvas","right_units":"canvas","bottom_units":"canvas","top_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1026"},{"type":"object","name":"ResetTool","id":"p1027"},{"type":"object","name":"HelpTool","id":"p1028"},{"type":"object","name":"HoverTool","id":"p1029","attributes":{"renderers":"auto","tooltips":[["x","$x"],["y","$y"],["value","@image"]]}}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1017","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1018","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1019"},"major_label_policy":{"type":"object","name":"AllLabels","id":"p1020"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1012","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1013","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1014"},"major_label_policy":{"type":"object","name":"AllLabels","id":"p1015"}}}],"center":[{"type":"object","name":"Grid","id":"p1016","attributes":{"axis":{"id":"p1012"}}},{"type":"object","name":"Grid","id":"p1021","attributes":{"dimension":1,"axis":{"id":"p1017"}}}],"match_aspect":true}},{"type":"object","name":"Column","id":"p1054","attributes":{"children":[{"type":"object","name":"Slider","id":"p1030","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1053","attributes":{"args":{"type":"map","entries":[["source",{"id":"p1035"}],["w1",{"id":"p1030"}],["w2",{"type":"object","name":"Slider","id":"p1031","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1053"}]]]},"title":"w2","start":-1.0,"end":1.0,"value":-0.4926319536120163,"step":0.05}}],["w3",{"type":"object","name":"Slider","id":"p1032","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1053"}]]]},"title":"w3","start":-1.0,"end":1.0,"value":-0.5838666608094047,"step":0.05}}],["w4",{"type":"object","name":"Slider","id":"p1033","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1053"}]]]},"title":"w4","start":-1.0,"end":1.0,"value":-0.4157152170353555,"step":0.05}}],["w5",{"type":"object","name":"Slider","id":"p1034","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1053"}]]]},"title":"w5","start":-1.0,"end":1.0,"value":0.6587074104764596,"step":0.05}}]]},"code":"\n   // Get image data\n   const im_avg = source.data['im_avg'][0];\n   const im1 = source.data.im1[0];\n   const im2 = source.data.im2[0];\n   const im3 = source.data.im3[0];\n   const im4 = source.data.im4[0];\n   const im5 = source.data.im5[0];\n\n   // Get weights\n   const w1_ = w1.value;\n   const w2_ = w2.value;\n   const w3_ = w3.value;\n   const w4_ = w4.value;\n   const w5_ = w5.value;\n\n   // Image blending\n   for (let i = 0; i < im_avg.length; i++) {\n        im_avg[i] = w1_ * im1[i] + w2_ * im2[i] + w3_ * im3[i] + w4_ * im4[i] + w5_ * im5[i];\n   }\n   source.change.emit();\n"}}]]]},"title":"w1","start":-1.0,"end":1.0,"value":-0.7761839523990972,"step":0.05}},{"id":"p1031"},{"id":"p1032"},{"id":"p1033"},{"id":"p1034"}]}}]}}]}};
  const render_items = [{"docid":"cb46c9a7-a45b-4113-b20d-d5e0dc9cd865","roots":{"p1055":"a1f3861c-33a4-47a5-a898-9651be0cc723"},"root_ids":["p1055"]}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
<p>図を見てみると、概ね同じ数字が近くに集まってクラスタを形成していることが分かる。上図は2次元までベクトルを圧縮して作成しているため、数字同士の領域に大きな重複が見られるが、もう少し高い次元であれば、各数字の占める領域が重ならないようにすることができそうだ。</p>
<p>なお、PCAをscikit-learnを用いて実行する場合には、以下のようになる。同様に2次元空間で可視化してみると、先ほどと同じ画像が得られていることが確認できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Swiss Roll (scikit-learn, PCA)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f4798ba2cdff9dedc5f8733fd1a29faf4e34b616a8f514c93f447da2315bd152.png" src="../../_images/f4798ba2cdff9dedc5f8733fd1a29faf4e34b616a8f514c93f447da2315bd152.png" />
</div>
</div>
</section>
</section>
<section id="mds">
<h2><span class="section-number">1.2. </span>多次元尺度構成法 (MDS)<a class="headerlink" href="#mds" title="Permalink to this heading">#</a></h2>
<p><strong>多次元尺度構成法</strong>(MDS = Multi-Dimensional Scaling)は距離空間学習法の一種で元の空間における点と点の距離をなるべく保つように低次元空間に点を射影する。今回はデータとデータの間の距離を通常のEuclidノルムで求めて多次元尺度構成法を実行してみる。</p>
<p>多次元尺度構成法では、点と点の間の距離を表わす以下の行列<span class="math notranslate nohighlight">\(\mathbf{D} \in \mathbb{R}^{N \times N}\)</span>を考える。</p>
<div class="math notranslate nohighlight">
\[
D_{ij} = \| \mathbf{x}_i - \mathbf{x}_j \|
\]</div>
<p>低次元空間における<span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span>のベクトル表現<span class="math notranslate nohighlight">\(\mathbf{z}_i\)</span>は、この距離をできる限り保つように計算される。すなわち、任意の<span class="math notranslate nohighlight">\(\mathbf{z}_i\)</span>と<span class="math notranslate nohighlight">\(\mathbf{z}_j\)</span>の組に対して、</p>
<div class="math notranslate nohighlight" id="equation-eq-z-vs-d">
<span class="eqno">(1.1)<a class="headerlink" href="#equation-eq-z-vs-d" title="Permalink to this equation">#</a></span>\[
\| \mathbf{z}_i - \mathbf{z}_j \| = D_{ij}
\]</div>
<p>となることが求められる。今、多次元尺度構成法では<strong>距離だけを保てば良い</strong>ので、<span class="math notranslate nohighlight">\(\mathbf{x}_1, \ldots, \mathbf{x}_N\)</span>の重心が原点となるように平行移動してある、すなわち、</p>
<div class="math notranslate nohighlight" id="equation-eq-center-is-origin">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-eq-center-is-origin" title="Permalink to this equation">#</a></span>\[
\sum_{i=1}^N \mathbf{x}_i = \mathbf{0}
\]</div>
<p>が成り立つとして、以下の議論を行う。始めに、<a class="reference internal" href="#equation-eq-z-vs-d">(1.1)</a>の両辺を二乗すると、</p>
<div class="math notranslate nohighlight" id="equation-eq-d-square">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-eq-d-square" title="Permalink to this equation">#</a></span>\[
D_{ij}^2 = \| \mathbf{z}_i \|^2 + \| \mathbf{z}_j \|^2 -2 \mathbf{z}_i^\top \mathbf{z}_j
\]</div>
<p>となる。ここでさらに、</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
D_{i*} &amp;= \sum_{j=1}^N D_{ij} \\
D_{*j} &amp;= \sum_{i=1}^N D_{ij} \\
D_{**} &amp;= \sum_{i,j} D_{ij} \\
\end{align}
\end{split}\]</div>
<p>のように置くと、これらは、<a class="reference internal" href="#equation-eq-d-square">(1.3)</a>ならび<a class="reference internal" href="#equation-eq-center-is-origin">(1.2)</a>から、以下のように計算できる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
D_{i*} &amp;= N \| \mathbf{z}_i \|^2 + \sum_{j=1} \| \mathbf{z}_j \|^2 \\
D_{*j} &amp;= \sum_{i=1}^N \| \mathbf{z}_i \|^2 + N \| \mathbf{z}_j \|^2 \\
D_{**} &amp;= 2N \sum_{i=1} \| \mathbf{z}_i \|^2
\end{align}
\end{split}\]</div>
<p>これらの関係式を用いて、<span class="math notranslate nohighlight">\(\| \mathbf{z}_i \|^2\)</span>, <span class="math notranslate nohighlight">\(\| \mathbf{z}_j \|^2\)</span>, ならびに<span class="math notranslate nohighlight">\(\mathbf{z}_i^\top \mathbf{z}_j\)</span>を<span class="math notranslate nohighlight">\(D_{i*}\)</span>, <span class="math notranslate nohighlight">\(D_{*j}\)</span>, ならびに<span class="math notranslate nohighlight">\(D_{**}\)</span>を用いて書き直す。結果だけを示すと以下のようになる。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\| \mathbf{z}_i \|^2 &amp;= \frac{1}{N} D_{*j}^2 - \frac{1}{2N^2} D_{**} \\
\| \mathbf{z}_j \|^2 &amp;= \frac{1}{N} D_{i*}^2 - \frac{1}{2N^2} D_{**} \\
\mathbf{z}_i^\top \mathbf{z}_j &amp;= \frac{1}{2} \left( \frac{1}{N} D_{i*}^2 + \frac{1}{N} D_{*j}^2 - \frac{1}{N^2} D_{**}^2 - D_{ij}^2 \right)
\end{align}
\end{split}\]</div>
<p>かなり天下り的な説明になるが、これらの式を用いると、<span class="math notranslate nohighlight">\(\mathbf{Z} = [ \mathbf{z}_1 \cdots \mathbf{z}_N ] \in \mathbb{R}^{M \times N}\)</span>に対して、</p>
<div class="math notranslate nohighlight" id="equation-eq-mds">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-eq-mds" title="Permalink to this equation">#</a></span>\[
\mathbf{Z}^\top \mathbf{Z} = -\frac{1}{2} \mathbf{H} \mathbf{D}^2 \mathbf{H}
\]</div>
<p>という式が成り立つ。なお、ここでは、<span class="math notranslate nohighlight">\(\mathbf{D}^2\)</span>は<span class="math notranslate nohighlight">\(\mathbf{D}\)</span>の各要素を二乗したものであるとし、<span class="math notranslate nohighlight">\(\mathbf{H}\)</span>は以下のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\mathbf{H} = \mathbf{I} - \frac{1}{N} \mathbf{1} \mathbf{1}^\top
\]</div>
<p>ただし、<span class="math notranslate nohighlight">\(\mathbf{I}\)</span>は単位行列、<span class="math notranslate nohighlight">\(\mathbf{1}\mathbf{1}^\top\)</span>は全ての要素が1の<span class="math notranslate nohighlight">\(N\times N\)</span>要素を持つ行列であるとする。</p>
<p>今、<a class="reference internal" href="#equation-eq-mds">(1.4)</a>の右辺を<span class="math notranslate nohighlight">\(\mathbf{K}\)</span>と置くこととすると、<span class="math notranslate nohighlight">\(\mathbf{K}\)</span>は半正定値行列であり、<span class="math notranslate nohighlight">\(\mathbf{Z}\)</span>の解として、以下が得られる。</p>
<div class="math notranslate nohighlight">
\[
\mathbf{Z} = [ \sqrt{\lambda_1} \mathbf{u}_1 \cdots \sqrt{\lambda_M} \mathbf{u}_M ]^\top
\]</div>
<p>ただし、<span class="math notranslate nohighlight">\(\{ \lambda_i \in \mathbb{R} : i = 1, \ldots, N \}\)</span>は、<span class="math notranslate nohighlight">\(\mathbf{K}\)</span>の固有値を絶対値が大きい順に並べたものであり、<span class="math notranslate nohighlight">\(\{ \mathbf{u}_i \in \mathbb{R}^{N} : i = 1, \ldots, N \}\)</span>は、それに対応する固有ベクトルである。</p>
<hr class="docutils" />
<p>では、以上の議論を元にスイスロールのデータに対して多次元尺度構成法を適用してみる。なお、今回は、固有値分解を行う対象の行列が巨大であるため、SciPyの<code class="docutils literal notranslate"><span class="pre">eigh</span></code>関数を用いて、絶対値が大きい順に先頭から2個だけ固有値と固有ベクトルを求める。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="c1"># 距離行列の計算</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
<span class="n">X_sr_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_sr</span><span class="o">**</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">D_sr</span> <span class="o">=</span> <span class="n">X_sr_2</span> <span class="o">+</span> <span class="n">X_sr_2</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">X_sr</span> <span class="o">@</span> <span class="n">X_sr</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># MDS</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">K_sr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">@</span> <span class="p">(</span><span class="n">D_sr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>

<span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">K_sr</span><span class="p">,</span> <span class="n">subset_by_index</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">eigvec</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">eigval</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Classical MDS&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/9f66900b0be84c24059844cc87cea3f2e790b20e48becda1aa1e4db08d5be315.png" src="../../_images/9f66900b0be84c24059844cc87cea3f2e790b20e48becda1aa1e4db08d5be315.png" />
</div>
</div>
<p>上記は最も古典的なMDSの実装であり、データのばらつきを見ると、PCAとそれほど遜色はない。一方、MDSにはデータの間の距離を調整するSMACOF(Scaling by MAjorizing a COmplicated Function)という手法が知られており、これを用いると、低次元空間におけるデータの配置を見やすくすることができる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># SMACOF</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0e-6</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

<span class="n">old_stress</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># SMACOF iterations</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">)):</span>
    <span class="n">dis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">z_sr</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">disparities</span> <span class="o">=</span> <span class="n">D_sr</span>

    <span class="c1"># Compute stress</span>
    <span class="n">stress</span> <span class="o">=</span> <span class="p">((</span><span class="n">dis</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">-</span> <span class="n">disparities</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1"># if normalized_stress:</span>
    <span class="c1">#     stress = np.sqrt(stress / ((disparities.ravel() ** 2).sum() / 2))</span>

    <span class="c1"># Update X using the Guttman transform</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">dis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-5</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">disparities</span> <span class="o">/</span> <span class="n">dis</span>
    <span class="n">B</span> <span class="o">=</span> <span class="o">-</span><span class="n">ratio</span>
    <span class="n">B</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">))]</span> <span class="o">+=</span> <span class="n">ratio</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">z_sr</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">z_sr</span><span class="p">)</span>

    <span class="n">dis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">z_sr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">old_stress</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">old_stress</span> <span class="o">-</span> <span class="n">stress</span> <span class="o">/</span> <span class="n">dis</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">old_stress</span> <span class="o">=</span> <span class="n">stress</span> <span class="o">/</span> <span class="n">dis</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "7631587477f2425fa9b6a871569d3e48"}</script></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MDS with SMACOF&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/fa1de81fe93b7c596fba3abe02580e7466fe915a22d5c15db8e0a635ca17a24f.png" src="../../_images/fa1de81fe93b7c596fba3abe02580e7466fe915a22d5c15db8e0a635ca17a24f.png" />
</div>
</div>
<p>上記と同様のコードがscikit-learnのMDSでも実装されており、結果を揃えるためには、以下のように引数を与えれば良い。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">MDS</span>

<span class="c1"># 距離行列が求まっている場合には「dissimilarity=&quot;precomputed&quot;」を指定する</span>
<span class="n">mds</span> <span class="o">=</span> <span class="n">MDS</span><span class="p">(</span>
    <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">dissimilarity</span><span class="o">=</span><span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>
    <span class="n">n_init</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">normalized_stress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">mds</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">D_sr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;MDS (scikit-learn)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a13b186fed636a865a3853395ff24c0e780f1ece1df4db326b780b18b307eeba.png" src="../../_images/a13b186fed636a865a3853395ff24c0e780f1ece1df4db326b780b18b307eeba.png" />
</div>
</div>
<section id="isomap">
<h3><span class="section-number">1.2.1. </span>Isomapによる次元圧縮<a class="headerlink" href="#isomap" title="Permalink to this heading">#</a></h3>
<p>実はIsomapはMDSを拡張した物で、距離行列にk-nearest neighbor graph (kNNグラフ)と呼ばれる、各点とその近傍を結んだグラフ構造上で計算された距離を用いる。このようなグラフを作成するために、下記のコードでは <a class="reference external" href="https://en.wikipedia.org/wiki/K-d_tree">KD木</a>を用いた最近某探索を用いる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>

<span class="c1"># 各データ点に対する最近傍点の探索</span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">kd_tree</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;kd_tree&quot;</span><span class="p">)</span>
<span class="n">kd_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">kd_tree</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>

<span class="c1"># 自分自身までの距離を除去</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<p>ここで<code class="docutils literal notranslate"><span class="pre">distances</span></code>と<code class="docutils literal notranslate"><span class="pre">indices</span></code>は<code class="docutils literal notranslate"><span class="pre">[1000,</span> <span class="pre">5]</span></code>の大きさのデータになっていて、各頂点に対する近傍点までの距離と、近傍点のインデックスが入っている。なお、探索元のデータ群と探索先のデータ群を同じにすると、<code class="docutils literal notranslate"><span class="pre">distances[:,</span> <span class="pre">0]</span></code>が自分自身の点までの距離で0となってしまうため、kNNグラフを作る際には、このようなデータを除去しておく。</p>
<p>次にグラフ計算のためのライブラリである<code class="docutils literal notranslate"><span class="pre">networkx</span></code>を用いて、グラフ上での点と点の距離を計算する。まずはグラフの作成。<code class="docutils literal notranslate"><span class="pre">networkx</span></code>でグラフを作成するためには<code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j,</span> <span class="pre">{&quot;weight&quot;:</span> <span class="pre">1.0})</span></code>のような辺の端点を表わす点のインデックス<code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code>と、辺に対する重みの除法を表わす<code class="docutils literal notranslate"><span class="pre">{&quot;weight&quot;:</span> <span class="pre">1.0}</span></code>を辺の数分だけ配列に格納し、その配列を用いて <code class="docutils literal notranslate"><span class="pre">from_edgelist</span></code> からグラフを作成する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># kNNグラフの作成</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="c1"># 辺のデータの収集</span>
<span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">):</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]}))</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]}))</span>

<span class="c1"># グラフの作成</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_edgelist</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>グラフが作成できたら、<a class="reference external" href="https://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm">Warshall-Floyd法</a>によって、全点対間の距離を計算する。なお、Warshall-Floyd法はグラフの頂点数 <span class="math notranslate nohighlight">\(n\)</span>に対して <span class="math notranslate nohighlight">\(O(n^3)\)</span>のアルゴリズムなので、計算量に注意すること。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Warshall-Floyd法による全点対間距離の計算</span>
<span class="c1"># 注意: networkxのグラフのノードはインデックス順になっていないので、第2引数にノード順を指定する</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">floyd_warshall_numpy</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">nodelist</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>ここまででkNNグラフ上での頂点間距離が</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">K</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">H</span> <span class="o">@</span> <span class="p">(</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
<span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">subset_by_index</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="n">eigval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
<span class="n">eigvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">eigvec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 注意: scikit-learnと結果を揃えるために-1を掛ける (固有値, 固有ベクトルの符号には曖昧さがある)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">eigvec</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eigval</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Isomap&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/1942725169479ff8b3602a979f55b81e32987662bbb98db6cd7a4fa1bb58f853.png" src="../../_images/1942725169479ff8b3602a979f55b81e32987662bbb98db6cd7a4fa1bb58f853.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">Isomap</span>

<span class="n">isomap</span> <span class="o">=</span> <span class="n">Isomap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">neighbors_algorithm</span><span class="o">=</span><span class="s2">&quot;kd_tree&quot;</span><span class="p">,</span> <span class="n">path_method</span><span class="o">=</span><span class="s2">&quot;FW&quot;</span><span class="p">)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">isomap</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Isomap (scikit-learn)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0b8c346956deb567b53c61eab72f412a4dc34c0b24e948effe730629a9f399b2.png" src="../../_images/0b8c346956deb567b53c61eab72f412a4dc34c0b24e948effe730629a9f399b2.png" />
</div>
</div>
</section>
<section id="lle">
<h3><span class="section-number">1.2.2. </span>LLEによる次元圧縮<a class="headerlink" href="#lle" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">LocallyLinearEmbedding</span>

<span class="n">lle</span> <span class="o">=</span> <span class="n">LocallyLinearEmbedding</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">z_sr</span> <span class="o">=</span> <span class="n">lle</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_sr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの可視化</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_sr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;LLE (scikit-learn)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b9ecbe1816bb26b0d1ad0334d17a76602bef015413f5eadb85559d9d1135543d.png" src="../../_images/b9ecbe1816bb26b0d1ad0334d17a76602bef015413f5eadb85559d9d1135543d.png" />
</div>
</div>
</section>
</section>
<section id="id3">
<h2><span class="section-number">1.3. </span>練習問題<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>多次元尺度構成法の項で紹介した<a class="reference internal" href="#equation-eq-mds">(1.4)</a>を自身で導出せよ。</p></li>
<li><p>単純なMDSとSMACOFを用いたMDSをMNISTのデータに適用し、違いについて考察せよ。</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./contents/sec2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../sec1/exercise-sudoku.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8. </span>演習1 - 画像入力式数独ソルバーを作る</p>
      </div>
    </a>
    <a class="right-next"
       href="feature-extraction.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>特徴量抽出</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">1.1. 主成分分析 (PCA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.1.1. 主成分分析の画像的な意味</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mds">1.2. 多次元尺度構成法 (MDS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isomap">1.2.1. Isomapによる次元圧縮</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lle">1.2.2. LLEによる次元圧縮</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">1.3. 練習問題</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tatsuya Yatagawa
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright CC BY-NC-SA 4.0, 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>